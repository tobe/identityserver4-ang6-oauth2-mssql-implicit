2019-02-24 19:54:05.373 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-24 19:54:05.427 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-24 19:54:05.432 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-24 19:54:05.432 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-24 19:54:05.433 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-24 19:54:05.434 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-24 19:54:40.650 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-24 19:54:40.700 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-24 19:54:40.705 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-24 19:54:40.705 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-24 19:54:40.706 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-24 19:54:40.706 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-24 19:56:07.844 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-24 19:56:07.897 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-24 19:56:07.902 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-24 19:56:07.902 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-24 19:56:07.903 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-24 19:56:07.904 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-24 19:56:23.485 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-24 19:56:23.546 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-24 19:56:23.551 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-24 19:56:23.552 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-24 19:56:23.552 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-24 19:56:23.553 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-24 19:57:30.082 +01:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-02-24 19:57:36.805 +01:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 19:57:38.839 +01:00 [INF] {
  "Name": "User Login Failure",
  "Category": "Authentication",
  "EventType": "Failure",
  "Id": 1001,
  "Username": "admin",
  "Endpoint": "UI",
  "Message": "invalid credentials",
  "ActivityId": "0HLKQH72V343P:00000003",
  "TimeStamp": "2019-02-24T18:57:38Z",
  "ProcessId": 380,
  "LocalIpAddress": "127.0.0.1:28983",
  "RemoteIpAddress": "::1"
}
2019-02-24 19:57:55.026 +01:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 19:57:55.071 +01:00 [INF] {
  "Name": "User Login Failure",
  "Category": "Authentication",
  "EventType": "Failure",
  "Id": 1001,
  "Username": "admin",
  "Endpoint": "UI",
  "Message": "invalid credentials",
  "ActivityId": "0HLKQH72V343M:00000004",
  "TimeStamp": "2019-02-24T18:57:55Z",
  "ProcessId": 380,
  "LocalIpAddress": "127.0.0.1:28983",
  "RemoteIpAddress": "::1"
}
2019-02-24 19:58:13.196 +01:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 19:58:13.202 +01:00 [INF] {
  "Name": "User Login Failure",
  "Category": "Authentication",
  "EventType": "Failure",
  "Id": 1001,
  "Username": "administrator@localhost.com",
  "Endpoint": "UI",
  "Message": "invalid credentials",
  "ActivityId": "0HLKQH72V343P:00000004",
  "TimeStamp": "2019-02-24T18:58:13Z",
  "ProcessId": 380,
  "LocalIpAddress": "127.0.0.1:28983",
  "RemoteIpAddress": "::1"
}
2019-02-24 19:59:18.330 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-24 19:59:18.387 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-24 19:59:18.395 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-24 19:59:18.399 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-24 19:59:18.403 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-24 19:59:18.407 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-24 19:59:52.845 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-24 19:59:52.895 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-24 19:59:52.899 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-24 19:59:52.899 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-24 19:59:52.900 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-24 19:59:52.900 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-24 20:00:09.392 +01:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-02-24 20:00:13.758 +01:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 20:00:15.944 +01:00 [DBG] Augmenting SignInContext
2019-02-24 20:00:15.947 +01:00 [DBG] Adding idp claim with value: local
2019-02-24 20:00:15.947 +01:00 [DBG] Adding amr claim with value: pwd
2019-02-24 20:00:15.947 +01:00 [DBG] Adding auth_time claim with value: 1551034815
2019-02-24 20:00:16.012 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-02-24 20:00:16.108 +01:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "admin",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "admin",
  "Endpoint": "UI",
  "ActivityId": "0HLKQH92VR6R6:00000003",
  "TimeStamp": "2019-02-24T19:00:16Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 20:00:16.144 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 20:00:16.145 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 20:11:07.854 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 20:11:07.926 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 20:11:07.926 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 20:11:07.972 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 20:11:08.004 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 20:11:08.004 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 20:11:08.027 +01:00 [DBG] Start discovery request
2019-02-24 20:11:08.225 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 20:11:08.226 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 20:11:08.226 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 20:11:08.226 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 20:11:08.227 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 20:11:08.227 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 20:11:08.232 +01:00 [DBG] Start key discovery request
2019-02-24 20:11:09.343 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 20:11:09.344 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 20:11:09.344 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 20:11:09.349 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 20:11:09.349 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 20:11:09.354 +01:00 [DBG] Start authorize request
2019-02-24 20:11:09.365 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 20:11:09.374 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 20:11:09.392 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 20:11:09.445 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 20:11:09.462 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "ZpLCEkqea7y78XVTx2F0kirkTli0ATGiZUxY25kR",
  "Nonce": "ZpLCEkqea7y78XVTx2F0kirkTli0ATGiZUxY25kR",
  "SessionId": "e7938cd79bf7742b753802ea639af27e",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "ZpLCEkqea7y78XVTx2F0kirkTli0ATGiZUxY25kR",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "ZpLCEkqea7y78XVTx2F0kirkTli0ATGiZUxY25kR"
  }
}
2019-02-24 20:11:09.556 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 20:11:09.556 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 20:11:09.557 +01:00 [INF] Showing consent: User has not yet consented
2019-02-24 20:11:09.568 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 20:11:09.569 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 20:11:09.589 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 20:11:09.590 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 20:11:09.590 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 20:11:09.592 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 20:11:21.706 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 20:11:21.706 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 20:11:21.707 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 20:11:21.746 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 20:11:21.746 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 20:11:21.746 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 20:11:21.779 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 20:11:21.779 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 20:11:21.779 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-24 20:11:21.780 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-24 20:11:21.780 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-24 20:11:21.786 +01:00 [DBG] Start authorize callback request
2019-02-24 20:11:21.825 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 20:11:21.825 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 20:11:21.825 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 20:11:21.826 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 20:11:21.826 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "ZpLCEkqea7y78XVTx2F0kirkTli0ATGiZUxY25kR",
  "Nonce": "ZpLCEkqea7y78XVTx2F0kirkTli0ATGiZUxY25kR",
  "SessionId": "e7938cd79bf7742b753802ea639af27e",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "ZpLCEkqea7y78XVTx2F0kirkTli0ATGiZUxY25kR",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "ZpLCEkqea7y78XVTx2F0kirkTli0ATGiZUxY25kR"
  }
}
2019-02-24 20:11:21.829 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 20:11:21.829 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 20:11:21.842 +01:00 [INF] User consented to scopes: ["openid","profile","api1"]
2019-02-24 20:11:21.860 +01:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 20:11:21.873 +01:00 [DBG] Creating Implicit Flow response.
2019-02-24 20:11:21.889 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-24 20:11:21.890 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 20:11:21.957 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-24 20:11:22.074 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****HB9w"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****7f34"
    }
  ],
  "ActivityId": "0HLKQH92VR6RC:00000006",
  "TimeStamp": "2019-02-24T19:11:22Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 20:11:22.081 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "ZpLCEkqea7y78XVTx2F0kirkTli0ATGiZUxY25kR",
  "Scope": "openid profile api1"
}
2019-02-24 20:11:22.109 +01:00 [DBG] Augmenting SignInContext
2019-02-24 20:11:22.109 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-02-24 20:11:23.204 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 20:11:23.204 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 20:11:23.204 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 20:11:23.204 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 20:11:23.205 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 20:11:23.205 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 20:11:23.205 +01:00 [DBG] Start discovery request
2019-02-24 20:11:23.266 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 20:11:23.266 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 20:11:23.266 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 20:11:23.266 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 20:11:23.267 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 20:11:23.267 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 20:11:23.267 +01:00 [DBG] Start key discovery request
2019-02-24 20:11:45.075 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 20:11:45.075 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 20:11:45.075 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 20:11:45.075 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 20:11:45.076 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 20:11:45.076 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 20:11:50.164 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 20:11:50.165 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 20:11:50.165 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 20:11:50.165 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 20:11:50.165 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 20:11:50.165 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 20:11:50.165 +01:00 [DBG] Start discovery request
2019-02-24 20:11:50.236 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 20:11:50.236 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 20:11:50.236 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 20:11:50.236 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 20:11:50.236 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 20:11:50.237 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 20:11:50.237 +01:00 [DBG] Start key discovery request
2019-02-24 20:11:54.764 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 20:11:54.764 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 20:11:54.800 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 20:11:56.258 +01:00 [DBG] CORS request made for path: /grants/Revoke from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 20:11:56.258 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 20:11:56.258 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 20:11:56.282 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 20:11:56.282 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 20:12:02.951 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 20:12:02.951 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 20:12:04.832 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 20:12:04.833 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 20:12:06.162 +01:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 20:12:06.162 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 20:12:06.162 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 20:12:06.206 +01:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-02-24 20:12:06.207 +01:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-02-24 20:12:06.208 +01:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-02-24 20:12:06.215 +01:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "Administrator",
  "ActivityId": "0HLKQH92VR6RC:00000011",
  "TimeStamp": "2019-02-24T19:12:06Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 20:12:06.418 +01:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-02-24 20:12:06.422 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-02-24 20:12:06.422 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-02-24 20:12:06.430 +01:00 [DBG] Processing signout callback request
2019-02-24 20:12:06.450 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 20:12:06.450 +01:00 [DBG] No client front-channel logout URLs
2019-02-24 20:12:06.450 +01:00 [DBG] No client back-channel logout URLs
2019-02-24 20:12:06.450 +01:00 [INF] Successful signout callback.
2019-02-24 20:12:06.450 +01:00 [DBG] No client front-channel iframe urls
2019-02-24 20:12:06.450 +01:00 [DBG] No client back-channel iframe urls
2019-02-24 20:12:11.312 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 20:12:11.313 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 20:12:11.313 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 20:12:11.313 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 20:12:11.313 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 20:12:11.313 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 20:12:11.313 +01:00 [DBG] Start discovery request
2019-02-24 20:12:11.380 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 20:12:11.381 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 20:12:11.381 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 20:12:11.381 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 20:12:11.381 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 20:12:11.381 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 20:12:11.382 +01:00 [DBG] Start key discovery request
2019-02-24 20:12:13.419 +01:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-02-24 20:12:13.419 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-02-24 20:12:13.420 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-02-24 20:12:13.427 +01:00 [DBG] Processing signout request for anonymous
2019-02-24 20:12:13.435 +01:00 [DBG] Start end session request validation
2019-02-24 20:12:13.442 +01:00 [DBG] Start identity token validation
2019-02-24 20:12:13.465 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 20:12:13.465 +01:00 [DBG] Client found: spa / SPA Client
2019-02-24 20:12:13.528 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-02-24 20:12:13.535 +01:00 [DBG] Token validation success
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1551035481,
    "exp": 1551035781,
    "iss": "http://localhost:49670",
    "aud": "spa",
    "nonce": "ZpLCEkqea7y78XVTx2F0kirkTli0ATGiZUxY25kR",
    "iat": 1551035481,
    "at_hash": "xLKoiV1xYJ8gSHGO1QALtw",
    "sid": "e7938cd79bf7742b753802ea639af27e",
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551034815,
    "idp": "local",
    "name": "Administrator",
    "website": "https://example.org",
    "preferred_username": "admin",
    "amr": "pwd"
  }
}
2019-02-24 20:12:13.541 +01:00 [INF] End session request validation failure: Invalid post logout URI
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "SubjectId": "unknown",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjQzZmNkNmY1ZmI2MDgwMmYzMjA2OTNjZGY1M2JmYjc3IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NTEwMzU0ODEsImV4cCI6MTU1MTAzNTc4MSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo0OTY3MCIsImF1ZCI6InNwYSIsIm5vbmNlIjoiWnBMQ0VrcWVhN3k3OFhWVHgyRjBraXJrVGxpMEFUR2laVXhZMjVrUiIsImlhdCI6MTU1MTAzNTQ4MSwiYXRfaGFzaCI6InhMS29pVjF4WUo4Z1NIR08xUUFMdHciLCJzaWQiOiJlNzkzOGNkNzliZjc3NDJiNzUzODAyZWE2MzlhZjI3ZSIsInN1YiI6IjM5ZDU2OWFmLTk3NjYtNGE0MS1hOTNhLWZlYTc2Nzc5ZjlmNCIsImF1dGhfdGltZSI6MTU1MTAzNDgxNSwiaWRwIjoibG9jYWwiLCJuYW1lIjoiQWRtaW5pc3RyYXRvciIsIndlYnNpdGUiOiJodHRwczovL2V4YW1wbGUub3JnIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiYWRtaW4iLCJhbXIiOlsicHdkIl19.SzsHUlKMCx6kF4ZHOu81uGs7ujLzl3Ypz_n-cFvkhACaPV9s2D5NvACGwq6U9Wn_PHq6c7phNi97hgYcEPZMxNyMbQ5YgPpnRYs7Ey-pv2u3Cxh0dudB9BSOQpiMoRIH2ngNu6CnBtUHqzDEjwInhH45DqjJggusBSw5qTZzYLgfsNO_f7VQungn9oMAGRB51gCF62X_g2S2oGeL0EyU-4nROBGh5QuZUwsSJaGyApzV44Dn-_Vu_1mX0oSRYlluFxUAzIooHGBHExy9TwzfGrwG-wsegat6i0qqzilZxTFJlhWoDdzIl3blakkOPIigJfHuQ4uqkYn0zl4cioHB9w",
    "post_logout_redirect_uri": "http://localhost:4200/home"
  }
}
2019-02-24 20:12:13.542 +01:00 [ERR] Error processing end session request Invalid request
2019-02-24 21:05:38.999 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:05:38.999 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:05:38.999 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:05:39.000 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:05:39.000 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:05:39.000 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:05:39.000 +01:00 [DBG] Start discovery request
2019-02-24 21:05:39.080 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:05:39.080 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:05:39.080 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:05:39.080 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:05:39.080 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:05:39.080 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:05:39.080 +01:00 [DBG] Start key discovery request
2019-02-24 21:05:40.762 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 21:05:40.762 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 21:05:40.763 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 21:05:40.766 +01:00 [DBG] Start authorize request
2019-02-24 21:05:40.766 +01:00 [DBG] No user present in authorize request
2019-02-24 21:05:40.766 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:05:40.768 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:05:40.768 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:05:40.768 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "fKPh7yH8GZarU85Ov4ShIigRBQYWqoI7vwmggKbp",
  "Nonce": "fKPh7yH8GZarU85Ov4ShIigRBQYWqoI7vwmggKbp",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "fKPh7yH8GZarU85Ov4ShIigRBQYWqoI7vwmggKbp",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "fKPh7yH8GZarU85Ov4ShIigRBQYWqoI7vwmggKbp"
  }
}
2019-02-24 21:05:40.768 +01:00 [INF] Showing login: User is not authenticated
2019-02-24 21:05:40.776 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:05:40.776 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:05:40.776 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:05:40.777 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:05:51.294 +01:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 21:05:51.327 +01:00 [DBG] Augmenting SignInContext
2019-02-24 21:05:51.327 +01:00 [DBG] Adding idp claim with value: local
2019-02-24 21:05:51.327 +01:00 [DBG] Adding amr claim with value: pwd
2019-02-24 21:05:51.327 +01:00 [DBG] Adding auth_time claim with value: 1551038751
2019-02-24 21:05:51.327 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-02-24 21:05:51.328 +01:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "admin",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "admin",
  "Endpoint": "UI",
  "ActivityId": "0HLKQH92VR6RI:00000001",
  "TimeStamp": "2019-02-24T20:05:51Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:05:51.333 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:05:51.334 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:05:51.334 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-24 21:05:51.334 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-24 21:05:51.334 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-24 21:05:51.334 +01:00 [DBG] Start authorize callback request
2019-02-24 21:05:51.335 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:05:51.335 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:05:51.335 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:05:51.335 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:05:51.336 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "fKPh7yH8GZarU85Ov4ShIigRBQYWqoI7vwmggKbp",
  "Nonce": "fKPh7yH8GZarU85Ov4ShIigRBQYWqoI7vwmggKbp",
  "SessionId": "daf6007629dd6d9258dc397a6d860e79",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "fKPh7yH8GZarU85Ov4ShIigRBQYWqoI7vwmggKbp",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "fKPh7yH8GZarU85Ov4ShIigRBQYWqoI7vwmggKbp"
  }
}
2019-02-24 21:05:51.338 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 21:05:51.338 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 21:05:51.338 +01:00 [INF] Showing consent: User has not yet consented
2019-02-24 21:05:51.343 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:05:51.343 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:05:51.344 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:05:51.344 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:05:51.344 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:05:51.344 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:05:53.802 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 21:05:53.803 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:05:53.803 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:05:53.804 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:05:53.804 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:05:53.804 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:05:53.810 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:05:53.810 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:05:53.810 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-24 21:05:53.811 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-24 21:05:53.811 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-24 21:05:53.811 +01:00 [DBG] Start authorize callback request
2019-02-24 21:05:53.811 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:05:53.811 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:05:53.811 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:05:53.812 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:05:53.812 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "fKPh7yH8GZarU85Ov4ShIigRBQYWqoI7vwmggKbp",
  "Nonce": "fKPh7yH8GZarU85Ov4ShIigRBQYWqoI7vwmggKbp",
  "SessionId": "daf6007629dd6d9258dc397a6d860e79",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "fKPh7yH8GZarU85Ov4ShIigRBQYWqoI7vwmggKbp",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "fKPh7yH8GZarU85Ov4ShIigRBQYWqoI7vwmggKbp"
  }
}
2019-02-24 21:05:53.815 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 21:05:53.815 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 21:05:53.815 +01:00 [INF] User consented to scopes: ["openid","profile","api1"]
2019-02-24 21:05:53.815 +01:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:05:53.815 +01:00 [DBG] Creating Implicit Flow response.
2019-02-24 21:05:53.815 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-24 21:05:53.815 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:05:53.831 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-24 21:05:53.842 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****_1sw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****c6f8"
    }
  ],
  "ActivityId": "0HLKQH92VR6RI:00000006",
  "TimeStamp": "2019-02-24T20:05:53Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:05:53.842 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "fKPh7yH8GZarU85Ov4ShIigRBQYWqoI7vwmggKbp",
  "Scope": "openid profile api1"
}
2019-02-24 21:05:53.843 +01:00 [DBG] Augmenting SignInContext
2019-02-24 21:05:53.843 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-02-24 21:05:54.515 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:05:54.515 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:05:54.515 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:05:54.516 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:05:54.516 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:05:54.516 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:05:54.516 +01:00 [DBG] Start discovery request
2019-02-24 21:05:54.537 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:05:54.538 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:05:54.538 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:05:54.538 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:05:54.538 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:05:54.538 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:05:54.538 +01:00 [DBG] Start key discovery request
2019-02-24 21:05:56.440 +01:00 [DBG] CORS request made for path: /api/values from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 21:06:49.230 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:06:49.230 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:06:49.230 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:06:49.230 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:06:49.230 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:06:49.230 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:06:49.230 +01:00 [DBG] Start discovery request
2019-02-24 21:06:49.330 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:06:49.330 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:06:49.330 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:06:49.330 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:06:49.331 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:06:49.331 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:06:49.331 +01:00 [DBG] Start key discovery request
2019-02-24 21:06:49.797 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:06:49.797 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:06:49.797 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:06:49.797 +01:00 [DBG] Start discovery request
2019-02-24 21:06:49.845 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:06:49.846 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:06:49.846 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:06:49.846 +01:00 [DBG] Start key discovery request
2019-02-24 21:06:49.965 +01:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-02-24 21:06:49.967 +01:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-02-24 21:06:49.967 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-02-24 21:06:49.977 +01:00 [DBG] Starting introspection request.
2019-02-24 21:06:49.990 +01:00 [DBG] Start parsing Basic Authentication secret
2019-02-24 21:06:49.994 +01:00 [DBG] Start parsing for secret in post body
2019-02-24 21:06:49.994 +01:00 [DBG] Parser found secret: PostBodySecretParser
2019-02-24 21:06:49.995 +01:00 [DBG] Secret id found: api1
2019-02-24 21:06:50.007 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-02-24 21:06:50.007 +01:00 [DBG] API resource validation success
2019-02-24 21:06:50.014 +01:00 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "api1",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLKQH92VR6RN:00000001",
  "TimeStamp": "2019-02-24T20:06:50Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:06:50.018 +01:00 [DBG] Introspection request validation started.
2019-02-24 21:06:50.045 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:06:50.048 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:06:50.050 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-02-24 21:06:50.052 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "49d009cbc2218032297886a888e6105a2b0bfafe7c2ba6f77890c3054ac9c6f8",
  "Claims": {
    "iss": "http://localhost:49670",
    "nbf": 1551038753,
    "exp": 1551042353,
    "aud": [
      "http://localhost:49670/resources",
      "api1"
    ],
    "client_id": "spa",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551038751,
    "idp": "local",
    "amr": "pwd"
  }
}
2019-02-24 21:06:50.053 +01:00 [DBG] Introspection request validation successful.
2019-02-24 21:06:50.064 +01:00 [DBG] Creating introspection response for active token.
2019-02-24 21:06:50.075 +01:00 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "api1",
  "IsActive": true,
  "Token": "****c6f8",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "ActivityId": "0HLKQH92VR6RN:00000001",
  "TimeStamp": "2019-02-24T20:06:50Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:06:50.076 +01:00 [INF] Success token introspection. Token active: true, for API name: api1
2019-02-24 21:11:51.588 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:11:51.588 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:11:54.791 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:11:54.791 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:11:54.791 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:11:54.791 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:11:54.791 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:11:54.791 +01:00 [DBG] Start discovery request
2019-02-24 21:12:02.149 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:12:02.149 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:12:02.149 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-02-24 21:12:02.152 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-02-24 21:12:02.152 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-02-24 21:12:02.173 +01:00 [DBG] Start userinfo request
2019-02-24 21:12:02.179 +01:00 [DBG] Bearer token not found
2019-02-24 21:12:02.180 +01:00 [ERR] No access token found.
2019-02-24 21:12:03.574 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:12:03.574 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:12:03.574 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-02-24 21:12:03.575 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-02-24 21:12:03.575 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-02-24 21:12:03.575 +01:00 [DBG] Start userinfo request
2019-02-24 21:12:03.575 +01:00 [DBG] Bearer token not found
2019-02-24 21:12:03.575 +01:00 [ERR] No access token found.
2019-02-24 21:15:27.783 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:15:27.783 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:15:27.784 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:15:27.784 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:15:27.784 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:15:27.784 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:15:27.784 +01:00 [DBG] Start discovery request
2019-02-24 21:15:27.862 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:15:27.862 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:15:27.863 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:15:27.863 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:15:27.863 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:15:27.863 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:15:27.863 +01:00 [DBG] Start key discovery request
2019-02-24 21:15:28.874 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:15:28.874 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:15:28.875 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 21:15:28.875 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 21:15:28.875 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 21:15:28.875 +01:00 [DBG] Start authorize request
2019-02-24 21:15:28.875 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:15:28.875 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:15:28.875 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:15:28.875 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:15:28.875 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "vYLyl8xyscUPpepBiscz4Kk7DFNJylTHbUi72VxH",
  "Nonce": "vYLyl8xyscUPpepBiscz4Kk7DFNJylTHbUi72VxH",
  "SessionId": "daf6007629dd6d9258dc397a6d860e79",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "vYLyl8xyscUPpepBiscz4Kk7DFNJylTHbUi72VxH",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "vYLyl8xyscUPpepBiscz4Kk7DFNJylTHbUi72VxH"
  }
}
2019-02-24 21:15:28.878 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 21:15:28.878 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 21:15:28.878 +01:00 [INF] Showing consent: User has not yet consented
2019-02-24 21:15:28.883 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:15:28.883 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:15:28.883 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:15:28.883 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:15:28.883 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:15:28.884 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:15:32.061 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 21:15:32.062 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:15:32.062 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:15:32.063 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:15:32.063 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:15:32.063 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:15:32.069 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:15:32.070 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:15:32.070 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-24 21:15:32.070 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-24 21:15:32.070 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-24 21:15:32.070 +01:00 [DBG] Start authorize callback request
2019-02-24 21:15:32.071 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:15:32.071 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:15:32.071 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:15:32.072 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:15:32.072 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "vYLyl8xyscUPpepBiscz4Kk7DFNJylTHbUi72VxH",
  "Nonce": "vYLyl8xyscUPpepBiscz4Kk7DFNJylTHbUi72VxH",
  "SessionId": "daf6007629dd6d9258dc397a6d860e79",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "vYLyl8xyscUPpepBiscz4Kk7DFNJylTHbUi72VxH",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "vYLyl8xyscUPpepBiscz4Kk7DFNJylTHbUi72VxH"
  }
}
2019-02-24 21:15:32.075 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 21:15:32.075 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 21:15:32.075 +01:00 [INF] User consented to scopes: ["openid","profile","api1"]
2019-02-24 21:15:32.075 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1"]
2019-02-24 21:15:32.075 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:15:32.081 +01:00 [DBG] Creating Implicit Flow response.
2019-02-24 21:15:32.081 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-24 21:15:32.081 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:15:32.097 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-24 21:15:32.107 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****YQVg"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****bd10"
    }
  ],
  "ActivityId": "0HLKQH92VR6RR:00000004",
  "TimeStamp": "2019-02-24T20:15:32Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:15:32.107 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "vYLyl8xyscUPpepBiscz4Kk7DFNJylTHbUi72VxH",
  "Scope": "openid profile api1"
}
2019-02-24 21:15:32.358 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:15:32.358 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:15:32.358 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:15:32.358 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:15:32.359 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:15:32.359 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:15:32.359 +01:00 [DBG] Start discovery request
2019-02-24 21:15:32.381 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:15:32.381 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:15:32.381 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:15:32.382 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:15:32.382 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:15:32.383 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:15:32.383 +01:00 [DBG] Start key discovery request
2019-02-24 21:15:33.627 +01:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-02-24 21:15:33.628 +01:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-02-24 21:15:33.628 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-02-24 21:15:33.628 +01:00 [DBG] Starting introspection request.
2019-02-24 21:15:33.628 +01:00 [DBG] Start parsing Basic Authentication secret
2019-02-24 21:15:33.628 +01:00 [DBG] Start parsing for secret in post body
2019-02-24 21:15:33.629 +01:00 [DBG] Parser found secret: PostBodySecretParser
2019-02-24 21:15:33.629 +01:00 [DBG] Secret id found: api1
2019-02-24 21:15:33.629 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-02-24 21:15:33.629 +01:00 [DBG] API resource validation success
2019-02-24 21:15:33.629 +01:00 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "api1",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLKQH92VR6RS:00000001",
  "TimeStamp": "2019-02-24T20:15:33Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:15:33.629 +01:00 [DBG] Introspection request validation started.
2019-02-24 21:15:33.643 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:15:33.643 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:15:33.646 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-02-24 21:15:33.647 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "9fccfbdd5930db1319ef367af9d48910b29fb42cda6a19ac4d126ce66300bd10",
  "Claims": {
    "iss": "http://localhost:49670",
    "nbf": 1551039332,
    "exp": 1551042932,
    "aud": [
      "http://localhost:49670/resources",
      "api1"
    ],
    "client_id": "spa",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551038751,
    "idp": "local",
    "amr": "pwd"
  }
}
2019-02-24 21:15:33.647 +01:00 [DBG] Introspection request validation successful.
2019-02-24 21:15:33.647 +01:00 [DBG] Creating introspection response for active token.
2019-02-24 21:15:33.648 +01:00 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "api1",
  "IsActive": true,
  "Token": "****bd10",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "ActivityId": "0HLKQH92VR6RS:00000001",
  "TimeStamp": "2019-02-24T20:15:33Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:15:33.648 +01:00 [INF] Success token introspection. Token active: true, for API name: api1
2019-02-24 21:16:17.247 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:16:17.247 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:16:17.247 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:16:17.247 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:16:17.247 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:16:17.247 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:16:17.247 +01:00 [DBG] Start discovery request
2019-02-24 21:16:17.336 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:16:17.336 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:16:17.336 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:16:17.336 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:16:17.336 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:16:17.336 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:16:17.337 +01:00 [DBG] Start key discovery request
2019-02-24 21:16:34.497 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:16:34.497 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:16:34.497 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:16:34.497 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:16:34.498 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:16:34.498 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:16:34.498 +01:00 [DBG] Start discovery request
2019-02-24 21:16:34.559 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:16:34.559 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:16:34.559 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:16:34.560 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:16:34.560 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:16:34.560 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:16:34.560 +01:00 [DBG] Start key discovery request
2019-02-24 21:16:45.754 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:16:45.754 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:16:45.754 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:16:45.754 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:16:45.754 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:16:45.754 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:16:45.754 +01:00 [DBG] Start discovery request
2019-02-24 21:16:45.830 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:16:45.830 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:16:45.830 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:16:45.831 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:16:45.831 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:16:45.831 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:16:45.831 +01:00 [DBG] Start key discovery request
2019-02-24 21:17:04.224 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:17:04.224 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:17:04.224 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 21:17:04.224 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 21:17:04.224 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 21:17:04.224 +01:00 [DBG] Start authorize request
2019-02-24 21:17:04.224 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:17:04.224 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:17:04.224 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:17:04.225 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:17:04.225 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "EHkPLPQtsnHh1Yc28G2GEYwbG8qnI9sRUkLxnEMm",
  "Nonce": "EHkPLPQtsnHh1Yc28G2GEYwbG8qnI9sRUkLxnEMm",
  "SessionId": "daf6007629dd6d9258dc397a6d860e79",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "EHkPLPQtsnHh1Yc28G2GEYwbG8qnI9sRUkLxnEMm",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "EHkPLPQtsnHh1Yc28G2GEYwbG8qnI9sRUkLxnEMm"
  }
}
2019-02-24 21:17:04.235 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-02-24 21:17:04.235 +01:00 [DBG] Creating Implicit Flow response.
2019-02-24 21:17:04.235 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-24 21:17:04.235 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:17:04.254 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-24 21:17:04.265 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****Y8uA"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****060d"
    }
  ],
  "ActivityId": "0HLKQH92VR6S0:00000001",
  "TimeStamp": "2019-02-24T20:17:04Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:17:04.265 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "EHkPLPQtsnHh1Yc28G2GEYwbG8qnI9sRUkLxnEMm",
  "Scope": "openid profile api1"
}
2019-02-24 21:17:05.361 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:17:05.361 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:17:05.361 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:17:05.361 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:17:05.361 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:17:05.361 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:17:05.361 +01:00 [DBG] Start discovery request
2019-02-24 21:17:05.419 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:17:05.419 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:17:05.420 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:17:05.420 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:17:05.420 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:17:05.420 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:17:05.420 +01:00 [DBG] Start key discovery request
2019-02-24 21:17:07.741 +01:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-02-24 21:17:07.741 +01:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-02-24 21:17:07.742 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-02-24 21:17:07.742 +01:00 [DBG] Starting introspection request.
2019-02-24 21:17:07.742 +01:00 [DBG] Start parsing Basic Authentication secret
2019-02-24 21:17:07.742 +01:00 [DBG] Start parsing for secret in post body
2019-02-24 21:17:07.742 +01:00 [DBG] Parser found secret: PostBodySecretParser
2019-02-24 21:17:07.743 +01:00 [DBG] Secret id found: api1
2019-02-24 21:17:07.743 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-02-24 21:17:07.743 +01:00 [DBG] API resource validation success
2019-02-24 21:17:07.743 +01:00 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "api1",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLKQH92VR6RS:00000002",
  "TimeStamp": "2019-02-24T20:17:07Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:17:07.744 +01:00 [DBG] Introspection request validation started.
2019-02-24 21:17:07.759 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:17:07.759 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:17:07.761 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-02-24 21:17:07.762 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "f57740f713bd2b5c7c698e9eb25488bc3b6624ba6e520ba3f2ed780bb9b8060d",
  "Claims": {
    "iss": "http://localhost:49670",
    "nbf": 1551039424,
    "exp": 1551043024,
    "aud": [
      "http://localhost:49670/resources",
      "api1"
    ],
    "client_id": "spa",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551038751,
    "idp": "local",
    "amr": "pwd"
  }
}
2019-02-24 21:17:07.762 +01:00 [DBG] Introspection request validation successful.
2019-02-24 21:17:07.762 +01:00 [DBG] Creating introspection response for active token.
2019-02-24 21:17:07.762 +01:00 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "api1",
  "IsActive": true,
  "Token": "****060d",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "ActivityId": "0HLKQH92VR6RS:00000002",
  "TimeStamp": "2019-02-24T20:17:07Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:17:07.762 +01:00 [INF] Success token introspection. Token active: true, for API name: api1
2019-02-24 21:17:19.775 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:17:19.776 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:17:19.776 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:17:19.776 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:17:19.776 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:17:19.776 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:17:19.776 +01:00 [DBG] Start discovery request
2019-02-24 21:17:19.851 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:17:19.852 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:17:19.852 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:17:19.852 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:17:19.852 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:17:19.852 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:17:19.852 +01:00 [DBG] Start key discovery request
2019-02-24 21:22:24.506 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:22:24.506 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:22:24.506 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:22:24.506 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:22:24.506 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:22:24.507 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:22:24.507 +01:00 [DBG] Start discovery request
2019-02-24 21:22:24.526 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:22:24.526 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:22:24.526 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:22:24.526 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:22:24.527 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:22:24.527 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:22:24.527 +01:00 [DBG] Start discovery request
2019-02-24 21:22:24.646 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:22:24.647 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:22:24.647 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:22:24.647 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:22:24.647 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:22:24.647 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:22:24.647 +01:00 [DBG] Start key discovery request
2019-02-24 21:22:24.676 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:22:24.676 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:22:24.676 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:22:24.676 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:22:24.677 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:22:24.677 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:22:24.677 +01:00 [DBG] Start key discovery request
2019-02-24 21:22:27.211 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:22:27.211 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:22:27.211 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 21:22:27.214 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 21:22:27.214 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 21:22:27.214 +01:00 [DBG] Start authorize request
2019-02-24 21:22:27.214 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:22:27.214 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:22:27.214 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:22:27.214 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:22:27.214 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "PL2Ut4E8jFau6Rp18Ctb5o5bgBYnMkhjnaurgcPr",
  "Nonce": "PL2Ut4E8jFau6Rp18Ctb5o5bgBYnMkhjnaurgcPr",
  "SessionId": "daf6007629dd6d9258dc397a6d860e79",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "PL2Ut4E8jFau6Rp18Ctb5o5bgBYnMkhjnaurgcPr",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "PL2Ut4E8jFau6Rp18Ctb5o5bgBYnMkhjnaurgcPr"
  }
}
2019-02-24 21:22:27.226 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-02-24 21:22:27.226 +01:00 [DBG] Creating Implicit Flow response.
2019-02-24 21:22:27.226 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-24 21:22:27.226 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:22:27.244 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-24 21:22:27.256 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****q2NQ"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****a85b"
    }
  ],
  "ActivityId": "0HLKQH92VR6S4:00000001",
  "TimeStamp": "2019-02-24T20:22:27Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:22:27.256 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "PL2Ut4E8jFau6Rp18Ctb5o5bgBYnMkhjnaurgcPr",
  "Scope": "openid profile api1"
}
2019-02-24 21:22:28.334 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:22:28.334 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:22:28.334 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:22:28.335 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:22:28.335 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:22:28.335 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:22:28.335 +01:00 [DBG] Start discovery request
2019-02-24 21:22:28.416 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:22:28.416 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:22:28.416 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:22:28.416 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:22:28.416 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:22:28.417 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:22:28.417 +01:00 [DBG] Start key discovery request
2019-02-24 21:22:30.451 +01:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-02-24 21:22:30.452 +01:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-02-24 21:22:30.452 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-02-24 21:22:30.452 +01:00 [DBG] Starting introspection request.
2019-02-24 21:22:30.452 +01:00 [DBG] Start parsing Basic Authentication secret
2019-02-24 21:22:30.452 +01:00 [DBG] Start parsing for secret in post body
2019-02-24 21:22:30.452 +01:00 [DBG] Parser found secret: PostBodySecretParser
2019-02-24 21:22:30.452 +01:00 [DBG] Secret id found: api1
2019-02-24 21:22:30.452 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-02-24 21:22:30.452 +01:00 [DBG] API resource validation success
2019-02-24 21:22:30.452 +01:00 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "api1",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLKQH92VR6S6:00000001",
  "TimeStamp": "2019-02-24T20:22:30Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:22:30.452 +01:00 [DBG] Introspection request validation started.
2019-02-24 21:22:30.465 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:22:30.465 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:22:30.467 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-02-24 21:22:30.467 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "59a0c8113b907ea9c92161da4a012050b7a27b9edd65ee9befca6a22bb12a85b",
  "Claims": {
    "iss": "http://localhost:49670",
    "nbf": 1551039747,
    "exp": 1551043347,
    "aud": [
      "http://localhost:49670/resources",
      "api1"
    ],
    "client_id": "spa",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551038751,
    "idp": "local",
    "amr": "pwd"
  }
}
2019-02-24 21:22:30.467 +01:00 [DBG] Introspection request validation successful.
2019-02-24 21:22:30.467 +01:00 [DBG] Creating introspection response for active token.
2019-02-24 21:22:30.468 +01:00 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "api1",
  "IsActive": true,
  "Token": "****a85b",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "ActivityId": "0HLKQH92VR6S6:00000001",
  "TimeStamp": "2019-02-24T20:22:30Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:22:30.468 +01:00 [INF] Success token introspection. Token active: true, for API name: api1
2019-02-24 21:22:35.522 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:22:35.523 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:22:35.523 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:22:35.523 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:22:35.523 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:22:35.523 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:22:35.523 +01:00 [DBG] Start discovery request
2019-02-24 21:22:35.603 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:22:35.603 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:22:35.604 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:22:35.604 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:22:35.604 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:22:35.604 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:22:35.604 +01:00 [DBG] Start key discovery request
2019-02-24 21:22:38.035 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:22:38.035 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:22:38.035 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:22:38.035 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:22:38.035 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:22:38.035 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:22:38.035 +01:00 [DBG] Start discovery request
2019-02-24 21:22:38.117 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:22:38.117 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:22:38.117 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:22:38.117 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:22:38.117 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:22:38.117 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:22:38.117 +01:00 [DBG] Start key discovery request
2019-02-24 21:22:47.678 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:22:47.678 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:22:47.678 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:22:47.678 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:22:47.679 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:22:47.679 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:22:47.679 +01:00 [DBG] Start discovery request
2019-02-24 21:22:47.755 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:22:47.755 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:22:47.755 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:22:47.755 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:22:47.756 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:22:47.756 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:22:47.756 +01:00 [DBG] Start key discovery request
2019-02-24 21:23:06.745 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:23:06.745 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:23:06.745 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:23:06.745 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:23:06.746 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:23:06.746 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:23:06.746 +01:00 [DBG] Start discovery request
2019-02-24 21:23:06.823 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:23:06.823 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:23:06.823 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:23:06.823 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:23:06.823 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:23:06.823 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:23:06.824 +01:00 [DBG] Start key discovery request
2019-02-24 21:23:07.499 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:23:07.499 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:23:07.499 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:23:07.499 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:23:07.499 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:23:07.499 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:23:07.500 +01:00 [DBG] Start discovery request
2019-02-24 21:23:07.558 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:23:07.558 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:23:07.559 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:23:07.559 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:23:07.559 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:23:07.559 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:23:07.559 +01:00 [DBG] Start key discovery request
2019-02-24 21:23:22.413 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:23:22.413 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:23:22.413 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:23:22.413 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:23:22.414 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:23:22.414 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:23:22.414 +01:00 [DBG] Start discovery request
2019-02-24 21:23:22.541 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:23:22.541 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:23:22.541 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:23:22.545 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:23:22.545 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:23:22.545 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:23:22.545 +01:00 [DBG] Start key discovery request
2019-02-24 21:23:23.419 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:23:23.420 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:23:23.420 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:23:23.420 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:23:23.420 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:23:23.420 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:23:23.420 +01:00 [DBG] Start discovery request
2019-02-24 21:23:23.542 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:23:23.543 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:23:23.543 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:23:23.543 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:23:23.543 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:23:23.543 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:23:23.543 +01:00 [DBG] Start key discovery request
2019-02-24 21:23:25.024 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:23:25.024 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:23:25.024 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:23:25.024 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:23:25.024 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:23:25.024 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:23:25.025 +01:00 [DBG] Start discovery request
2019-02-24 21:23:25.141 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:23:25.141 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:23:25.141 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:23:25.142 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:23:25.142 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:23:25.142 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:23:25.142 +01:00 [DBG] Start key discovery request
2019-02-24 21:24:25.871 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:24:25.878 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:24:25.878 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:24:25.881 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:24:25.882 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:24:25.882 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:24:25.882 +01:00 [DBG] Start discovery request
2019-02-24 21:24:26.130 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:24:26.130 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:24:26.130 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:24:26.130 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:24:26.130 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:24:26.130 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:24:26.130 +01:00 [DBG] Start key discovery request
2019-02-24 21:24:26.921 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:24:26.921 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:24:26.921 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:24:26.921 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:24:26.922 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:24:26.922 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:24:26.922 +01:00 [DBG] Start discovery request
2019-02-24 21:24:27.029 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:24:27.030 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:24:27.030 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:24:27.030 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:24:27.030 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:24:27.030 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:24:27.030 +01:00 [DBG] Start key discovery request
2019-02-24 21:24:42.551 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:24:42.551 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:24:42.551 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:24:42.551 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:24:42.551 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:24:42.551 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:24:42.551 +01:00 [DBG] Start discovery request
2019-02-24 21:24:42.621 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:24:42.621 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:24:42.621 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:24:42.621 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:24:42.621 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:24:42.623 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:24:42.623 +01:00 [DBG] Start key discovery request
2019-02-24 21:24:43.765 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:24:43.765 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:24:43.765 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:24:43.765 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:24:43.765 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:24:43.765 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:24:43.765 +01:00 [DBG] Start discovery request
2019-02-24 21:24:43.873 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:24:43.873 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:24:43.873 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:24:43.873 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:24:43.874 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:24:43.874 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:24:43.874 +01:00 [DBG] Start key discovery request
2019-02-24 21:24:52.243 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:24:52.243 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:24:52.243 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:24:52.243 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:24:52.244 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:24:52.244 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:24:52.244 +01:00 [DBG] Start discovery request
2019-02-24 21:24:52.360 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:24:52.361 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:24:52.361 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:24:52.361 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:24:52.361 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:24:52.361 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:24:52.362 +01:00 [DBG] Start key discovery request
2019-02-24 21:24:52.916 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:24:52.917 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:24:52.917 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:24:52.917 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:24:52.917 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:24:52.917 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:24:52.917 +01:00 [DBG] Start discovery request
2019-02-24 21:24:52.990 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:24:52.990 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:24:52.990 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:24:52.990 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:24:52.991 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:24:52.991 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:24:52.991 +01:00 [DBG] Start key discovery request
2019-02-24 21:27:47.755 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:27:47.755 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:27:47.755 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:27:47.755 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:27:47.756 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:27:47.756 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:27:47.756 +01:00 [DBG] Start discovery request
2019-02-24 21:27:47.881 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:27:47.881 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:27:47.881 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:27:47.881 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:27:47.881 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:27:47.881 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:27:47.882 +01:00 [DBG] Start key discovery request
2019-02-24 21:27:48.054 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:27:48.055 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:27:48.055 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:27:48.055 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:27:48.055 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:27:48.055 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:27:48.055 +01:00 [DBG] Start discovery request
2019-02-24 21:27:48.143 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:27:48.143 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:27:48.143 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:27:48.143 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:27:48.143 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:27:48.144 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:27:48.144 +01:00 [DBG] Start key discovery request
2019-02-24 21:27:49.746 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:27:49.746 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:27:49.746 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 21:27:49.746 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 21:27:49.746 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 21:27:49.746 +01:00 [DBG] Start authorize request
2019-02-24 21:27:49.746 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:27:49.746 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:27:49.746 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:27:49.747 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:27:49.747 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "gsTohLQ7PseSqhbdTFxMQuLNBjRhLI1yXDkEwzT5",
  "Nonce": "gsTohLQ7PseSqhbdTFxMQuLNBjRhLI1yXDkEwzT5",
  "SessionId": "daf6007629dd6d9258dc397a6d860e79",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "gsTohLQ7PseSqhbdTFxMQuLNBjRhLI1yXDkEwzT5",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "gsTohLQ7PseSqhbdTFxMQuLNBjRhLI1yXDkEwzT5"
  }
}
2019-02-24 21:27:49.759 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-02-24 21:27:49.759 +01:00 [DBG] Creating Implicit Flow response.
2019-02-24 21:27:49.759 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-24 21:27:49.759 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:27:49.776 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-24 21:27:49.788 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****YyPw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****baa1"
    }
  ],
  "ActivityId": "0HLKQH92VR6SF:00000001",
  "TimeStamp": "2019-02-24T20:27:49Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:27:49.788 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "gsTohLQ7PseSqhbdTFxMQuLNBjRhLI1yXDkEwzT5",
  "Scope": "openid profile api1"
}
2019-02-24 21:27:50.579 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:27:50.579 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:27:50.579 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:27:50.579 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:27:50.579 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:27:50.579 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:27:50.579 +01:00 [DBG] Start discovery request
2019-02-24 21:27:50.658 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:27:50.659 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:27:50.659 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:27:50.659 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:27:50.659 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:27:50.660 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:27:50.660 +01:00 [DBG] Start key discovery request
2019-02-24 21:27:55.145 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:27:55.146 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:27:55.146 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:27:55.146 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:27:55.146 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:27:55.146 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:27:55.146 +01:00 [DBG] Start discovery request
2019-02-24 21:27:55.227 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:27:55.227 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:27:55.227 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:27:55.228 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:27:55.228 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:27:55.229 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:27:55.229 +01:00 [DBG] Start key discovery request
2019-02-24 21:28:51.078 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:28:51.078 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:28:51.078 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:28:51.079 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:28:51.079 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:28:51.079 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:28:51.079 +01:00 [DBG] Start discovery request
2019-02-24 21:28:51.175 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:28:51.176 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:28:51.176 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:28:51.177 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:28:51.177 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:28:51.177 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:28:51.178 +01:00 [DBG] Start key discovery request
2019-02-24 21:28:52.525 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:28:52.525 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:28:52.525 +01:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-02-24 21:28:52.525 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-02-24 21:28:52.525 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-02-24 21:28:52.525 +01:00 [DBG] Processing signout request for 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:28:52.526 +01:00 [DBG] Start end session request validation
2019-02-24 21:28:52.526 +01:00 [DBG] Start identity token validation
2019-02-24 21:28:52.526 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:28:52.527 +01:00 [DBG] Client found: spa / SPA Client
2019-02-24 21:28:52.537 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-02-24 21:28:52.537 +01:00 [DBG] Token validation success
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1551040069,
    "exp": 1551040369,
    "iss": "http://localhost:49670",
    "aud": "spa",
    "nonce": "gsTohLQ7PseSqhbdTFxMQuLNBjRhLI1yXDkEwzT5",
    "iat": 1551040069,
    "at_hash": "xJ48SLL4tkK05LvpZUG6ew",
    "sid": "daf6007629dd6d9258dc397a6d860e79",
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551038751,
    "idp": "local",
    "name": "Administrator",
    "website": "https://example.org",
    "preferred_username": "admin",
    "amr": "pwd"
  }
}
2019-02-24 21:28:52.537 +01:00 [INF] End session request validation failure: Invalid post logout URI
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjQzZmNkNmY1ZmI2MDgwMmYzMjA2OTNjZGY1M2JmYjc3IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NTEwNDAwNjksImV4cCI6MTU1MTA0MDM2OSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo0OTY3MCIsImF1ZCI6InNwYSIsIm5vbmNlIjoiZ3NUb2hMUTdQc2VTcWhiZFRGeE1RdUxOQmpSaExJMXlYRGtFd3pUNSIsImlhdCI6MTU1MTA0MDA2OSwiYXRfaGFzaCI6InhKNDhTTEw0dGtLMDVMdnBaVUc2ZXciLCJzaWQiOiJkYWY2MDA3NjI5ZGQ2ZDkyNThkYzM5N2E2ZDg2MGU3OSIsInN1YiI6IjM5ZDU2OWFmLTk3NjYtNGE0MS1hOTNhLWZlYTc2Nzc5ZjlmNCIsImF1dGhfdGltZSI6MTU1MTAzODc1MSwiaWRwIjoibG9jYWwiLCJuYW1lIjoiQWRtaW5pc3RyYXRvciIsIndlYnNpdGUiOiJodHRwczovL2V4YW1wbGUub3JnIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiYWRtaW4iLCJhbXIiOlsicHdkIl19.Km8kI5WXiHTKsAoRWsl_br9K5JGo2rf2DeJ-rBun_JHuzrt_PBPL2qSSjxCQBv5PL5WUqh7d_kwg4RbkbIPbhEXebSo1PngzSk492pas5kyJOO8o5w8YoKPHBUikXMK0RUJSd5znYbYKaPQ5S_zLFL8yF_Oi75qIePs67PaQw3REs3HEfIFe_6Gig7VHqekibg7hT4z5-pOVSx72W5-2JOYnBIlMX-cGD7qg_2gUeo66d5T0ulzrVKn8WZHlQYK7FHX8Q80AAGC9Wpsi_Yf8XZaq_Q68ye26ekHzNr7ez_bYFNnhR99xDiK-CYf52IybwHnKtXIlzh7S9w3aZdYyPw",
    "post_logout_redirect_uri": "http://localhost:4200/home"
  }
}
2019-02-24 21:28:52.537 +01:00 [ERR] Error processing end session request Invalid request
2019-02-24 21:28:52.546 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:28:52.546 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:28:53.788 +01:00 [DBG] CORS request made for path: /account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 21:28:53.788 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:28:53.788 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:28:53.789 +01:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-02-24 21:28:53.789 +01:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-02-24 21:28:53.789 +01:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-02-24 21:28:53.789 +01:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "Administrator",
  "ActivityId": "0HLKQH92VR6SL:00000004",
  "TimeStamp": "2019-02-24T20:28:53Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:28:53.836 +01:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-02-24 21:28:53.836 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-02-24 21:28:53.837 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-02-24 21:28:53.837 +01:00 [DBG] Processing signout callback request
2019-02-24 21:28:53.837 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:28:53.837 +01:00 [DBG] No client front-channel logout URLs
2019-02-24 21:28:53.837 +01:00 [DBG] No client back-channel logout URLs
2019-02-24 21:28:53.837 +01:00 [INF] Successful signout callback.
2019-02-24 21:28:53.837 +01:00 [DBG] No client front-channel iframe urls
2019-02-24 21:28:53.838 +01:00 [DBG] No client back-channel iframe urls
2019-02-24 21:28:59.737 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:28:59.737 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:28:59.737 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:28:59.737 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:28:59.738 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:28:59.738 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:28:59.738 +01:00 [DBG] Start discovery request
2019-02-24 21:28:59.820 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:28:59.820 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:28:59.820 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:28:59.820 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:28:59.821 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:28:59.821 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:28:59.821 +01:00 [DBG] Start key discovery request
2019-02-24 21:29:02.001 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 21:29:02.002 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 21:29:02.003 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 21:29:02.003 +01:00 [DBG] Start authorize request
2019-02-24 21:29:02.003 +01:00 [DBG] No user present in authorize request
2019-02-24 21:29:02.003 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:29:02.003 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:29:02.003 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:29:02.003 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "oIwF9yRrUXYfjdsY6XRG4R5XA51uzJmVGI9lcqd8",
  "Nonce": "oIwF9yRrUXYfjdsY6XRG4R5XA51uzJmVGI9lcqd8",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "oIwF9yRrUXYfjdsY6XRG4R5XA51uzJmVGI9lcqd8",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "oIwF9yRrUXYfjdsY6XRG4R5XA51uzJmVGI9lcqd8"
  }
}
2019-02-24 21:29:02.003 +01:00 [INF] Showing login: User is not authenticated
2019-02-24 21:29:02.013 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:29:02.014 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:29:02.014 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:29:02.014 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:29:07.058 +01:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 21:29:07.092 +01:00 [DBG] Augmenting SignInContext
2019-02-24 21:29:07.092 +01:00 [DBG] Adding idp claim with value: local
2019-02-24 21:29:07.092 +01:00 [DBG] Adding amr claim with value: pwd
2019-02-24 21:29:07.092 +01:00 [DBG] Adding auth_time claim with value: 1551040147
2019-02-24 21:29:07.093 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-02-24 21:29:07.094 +01:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "admin",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "admin",
  "Endpoint": "UI",
  "ActivityId": "0HLKQH92VR6SM:00000003",
  "TimeStamp": "2019-02-24T20:29:07Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:29:07.100 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:29:07.101 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:29:07.101 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-24 21:29:07.101 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-24 21:29:07.101 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-24 21:29:07.101 +01:00 [DBG] Start authorize callback request
2019-02-24 21:29:07.101 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:29:07.102 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:29:07.102 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:29:07.102 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:29:07.102 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "oIwF9yRrUXYfjdsY6XRG4R5XA51uzJmVGI9lcqd8",
  "Nonce": "oIwF9yRrUXYfjdsY6XRG4R5XA51uzJmVGI9lcqd8",
  "SessionId": "61c37269fa0b4e02c80a21776dd5c03e",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "oIwF9yRrUXYfjdsY6XRG4R5XA51uzJmVGI9lcqd8",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "oIwF9yRrUXYfjdsY6XRG4R5XA51uzJmVGI9lcqd8"
  }
}
2019-02-24 21:29:07.112 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-02-24 21:29:07.112 +01:00 [DBG] Creating Implicit Flow response.
2019-02-24 21:29:07.112 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-24 21:29:07.112 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:29:07.128 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-24 21:29:07.141 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****ishw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****f392"
    }
  ],
  "ActivityId": "0HLKQH92VR6SM:00000004",
  "TimeStamp": "2019-02-24T20:29:07Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:29:07.141 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "oIwF9yRrUXYfjdsY6XRG4R5XA51uzJmVGI9lcqd8",
  "Scope": "openid profile api1"
}
2019-02-24 21:29:07.141 +01:00 [DBG] Augmenting SignInContext
2019-02-24 21:29:07.141 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-02-24 21:29:08.217 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:29:08.218 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:29:08.218 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:29:08.218 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:29:08.218 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:29:08.218 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:29:08.218 +01:00 [DBG] Start discovery request
2019-02-24 21:29:08.300 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:29:08.300 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:29:08.300 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:29:08.300 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:29:08.300 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:29:08.300 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:29:08.300 +01:00 [DBG] Start key discovery request
2019-02-24 21:30:50.621 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:30:50.621 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:30:50.621 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:30:50.621 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:30:50.621 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:30:50.621 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:30:50.622 +01:00 [DBG] Start discovery request
2019-02-24 21:30:50.705 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:30:50.705 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:30:50.705 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:30:50.705 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:30:50.706 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:30:50.706 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:30:50.706 +01:00 [DBG] Start key discovery request
2019-02-24 21:31:39.780 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:31:39.780 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:31:39.780 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:31:39.780 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:31:39.780 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:31:39.780 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:31:39.780 +01:00 [DBG] Start discovery request
2019-02-24 21:31:39.898 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:31:39.898 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:31:39.898 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:31:39.898 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:31:39.898 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:31:39.899 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:31:39.899 +01:00 [DBG] Start key discovery request
2019-02-24 21:31:40.594 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:31:40.594 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:31:40.594 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:31:40.594 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:31:40.595 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:31:40.595 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:31:40.595 +01:00 [DBG] Start discovery request
2019-02-24 21:31:40.662 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:31:40.662 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:31:40.662 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:31:40.663 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:31:40.663 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:31:40.663 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:31:40.663 +01:00 [DBG] Start key discovery request
2019-02-24 21:31:42.398 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:31:42.398 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:31:42.398 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 21:31:42.398 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 21:31:42.398 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 21:31:42.398 +01:00 [DBG] Start authorize request
2019-02-24 21:31:42.398 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:31:42.398 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:31:42.398 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:31:42.399 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:31:42.399 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "MKlnMcXlJWA6MBPsKnQn1I7qEhN1mweVB0f2xtO7",
  "Nonce": "MKlnMcXlJWA6MBPsKnQn1I7qEhN1mweVB0f2xtO7",
  "SessionId": "61c37269fa0b4e02c80a21776dd5c03e",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "MKlnMcXlJWA6MBPsKnQn1I7qEhN1mweVB0f2xtO7",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "MKlnMcXlJWA6MBPsKnQn1I7qEhN1mweVB0f2xtO7"
  }
}
2019-02-24 21:31:42.413 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-02-24 21:31:42.413 +01:00 [DBG] Creating Implicit Flow response.
2019-02-24 21:31:42.413 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-24 21:31:42.413 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:31:42.432 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-24 21:31:42.443 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****Qr0Q"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****ab75"
    }
  ],
  "ActivityId": "0HLKQH92VR6SR:00000001",
  "TimeStamp": "2019-02-24T20:31:42Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:31:42.443 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "MKlnMcXlJWA6MBPsKnQn1I7qEhN1mweVB0f2xtO7",
  "Scope": "openid profile api1"
}
2019-02-24 21:31:43.262 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:31:43.262 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:31:43.262 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:31:43.263 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:31:43.263 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:31:43.263 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:31:43.263 +01:00 [DBG] Start discovery request
2019-02-24 21:31:43.356 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:31:43.356 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:31:43.356 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:31:43.357 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:31:43.357 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:31:43.357 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:31:43.357 +01:00 [DBG] Start key discovery request
2019-02-24 21:31:48.361 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:31:48.362 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:31:48.362 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:31:48.362 +01:00 [DBG] Start discovery request
2019-02-24 21:31:48.402 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:31:48.402 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:31:48.403 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:31:48.403 +01:00 [DBG] Start key discovery request
2019-02-24 21:31:48.507 +01:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-02-24 21:31:48.508 +01:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-02-24 21:31:48.508 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-02-24 21:31:48.508 +01:00 [DBG] Starting introspection request.
2019-02-24 21:31:48.508 +01:00 [DBG] Start parsing Basic Authentication secret
2019-02-24 21:31:48.508 +01:00 [DBG] Start parsing for secret in post body
2019-02-24 21:31:48.508 +01:00 [DBG] Parser found secret: PostBodySecretParser
2019-02-24 21:31:48.508 +01:00 [DBG] Secret id found: api1
2019-02-24 21:31:48.508 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-02-24 21:31:48.508 +01:00 [DBG] API resource validation success
2019-02-24 21:31:48.508 +01:00 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "api1",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLKQH92VR6ST:00000001",
  "TimeStamp": "2019-02-24T20:31:48Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:31:48.508 +01:00 [DBG] Introspection request validation started.
2019-02-24 21:31:48.522 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:31:48.522 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:31:48.525 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-02-24 21:31:48.525 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "adab68fe15c883a3e605a13af0a3b84f9674c4f238e76fff8a57cf5d0ab5ab75",
  "Claims": {
    "iss": "http://localhost:49670",
    "nbf": 1551040302,
    "exp": 1551043902,
    "aud": [
      "http://localhost:49670/resources",
      "api1"
    ],
    "client_id": "spa",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551040147,
    "idp": "local",
    "amr": "pwd"
  }
}
2019-02-24 21:31:48.525 +01:00 [DBG] Introspection request validation successful.
2019-02-24 21:31:48.525 +01:00 [DBG] Creating introspection response for active token.
2019-02-24 21:31:48.525 +01:00 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "api1",
  "IsActive": true,
  "Token": "****ab75",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "ActivityId": "0HLKQH92VR6ST:00000001",
  "TimeStamp": "2019-02-24T20:31:48Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:31:48.525 +01:00 [INF] Success token introspection. Token active: true, for API name: api1
2019-02-24 21:32:45.316 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:32:45.316 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:32:45.316 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:32:45.316 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:32:45.317 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:32:45.317 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:32:45.317 +01:00 [DBG] Start discovery request
2019-02-24 21:32:45.402 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:32:45.403 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:32:45.403 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:32:45.403 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:32:45.403 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:32:45.403 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:32:45.403 +01:00 [DBG] Start key discovery request
2019-02-24 21:32:50.017 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:32:50.018 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:32:50.018 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 21:32:50.018 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 21:32:50.018 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 21:32:50.018 +01:00 [DBG] Start authorize request
2019-02-24 21:32:50.018 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:32:50.018 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:32:50.018 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:32:50.018 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:32:50.018 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "0zCpW1FB9XDCBKX6zctq9FHQWoaf1RZzd4hARvaG",
  "Nonce": "0zCpW1FB9XDCBKX6zctq9FHQWoaf1RZzd4hARvaG",
  "SessionId": "61c37269fa0b4e02c80a21776dd5c03e",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "0zCpW1FB9XDCBKX6zctq9FHQWoaf1RZzd4hARvaG",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "0zCpW1FB9XDCBKX6zctq9FHQWoaf1RZzd4hARvaG"
  }
}
2019-02-24 21:32:50.028 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-02-24 21:32:50.028 +01:00 [DBG] Creating Implicit Flow response.
2019-02-24 21:32:50.028 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-24 21:32:50.028 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:32:50.044 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-24 21:32:50.055 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****wIrQ"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****4e17"
    }
  ],
  "ActivityId": "0HLKQH92VR6SV:00000001",
  "TimeStamp": "2019-02-24T20:32:50Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:32:50.055 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "0zCpW1FB9XDCBKX6zctq9FHQWoaf1RZzd4hARvaG",
  "Scope": "openid profile api1"
}
2019-02-24 21:32:50.272 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:32:50.273 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:32:50.273 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:32:50.273 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:32:50.273 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:32:50.273 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:32:50.273 +01:00 [DBG] Start discovery request
2019-02-24 21:32:50.295 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:32:50.295 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:32:50.295 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:32:50.295 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:32:50.296 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:32:50.296 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:32:50.296 +01:00 [DBG] Start key discovery request
2019-02-24 21:32:52.167 +01:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-02-24 21:32:52.168 +01:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-02-24 21:32:52.168 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-02-24 21:32:52.168 +01:00 [DBG] Starting introspection request.
2019-02-24 21:32:52.169 +01:00 [DBG] Start parsing Basic Authentication secret
2019-02-24 21:32:52.169 +01:00 [DBG] Start parsing for secret in post body
2019-02-24 21:32:52.169 +01:00 [DBG] Parser found secret: PostBodySecretParser
2019-02-24 21:32:52.169 +01:00 [DBG] Secret id found: api1
2019-02-24 21:32:52.169 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-02-24 21:32:52.169 +01:00 [DBG] API resource validation success
2019-02-24 21:32:52.169 +01:00 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "api1",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLKQH92VR6ST:00000002",
  "TimeStamp": "2019-02-24T20:32:52Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:32:52.169 +01:00 [DBG] Introspection request validation started.
2019-02-24 21:32:52.184 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:32:52.185 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:32:52.187 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-02-24 21:32:52.188 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "0425378de8bebcc08b6595457c505580a0dbb975bfaeb473fc05028e21594e17",
  "Claims": {
    "iss": "http://localhost:49670",
    "nbf": 1551040370,
    "exp": 1551043970,
    "aud": [
      "http://localhost:49670/resources",
      "api1"
    ],
    "client_id": "spa",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551040147,
    "idp": "local",
    "amr": "pwd"
  }
}
2019-02-24 21:32:52.188 +01:00 [DBG] Introspection request validation successful.
2019-02-24 21:32:52.188 +01:00 [DBG] Creating introspection response for active token.
2019-02-24 21:32:52.188 +01:00 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "api1",
  "IsActive": true,
  "Token": "****4e17",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "ActivityId": "0HLKQH92VR6ST:00000002",
  "TimeStamp": "2019-02-24T20:32:52Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:32:52.188 +01:00 [INF] Success token introspection. Token active: true, for API name: api1
2019-02-24 21:32:54.977 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:32:54.977 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:32:54.977 +01:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-02-24 21:32:54.977 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-02-24 21:32:54.977 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-02-24 21:32:54.977 +01:00 [DBG] Processing signout request for 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:32:54.977 +01:00 [DBG] Start end session request validation
2019-02-24 21:32:54.977 +01:00 [DBG] Start identity token validation
2019-02-24 21:32:54.977 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:32:54.977 +01:00 [DBG] Client found: spa / SPA Client
2019-02-24 21:32:54.984 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-02-24 21:32:54.984 +01:00 [DBG] Token validation success
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1551040370,
    "exp": 1551040670,
    "iss": "http://localhost:49670",
    "aud": "spa",
    "nonce": "0zCpW1FB9XDCBKX6zctq9FHQWoaf1RZzd4hARvaG",
    "iat": 1551040370,
    "at_hash": "WwpM_QGiMFrmQbxO_u_izQ",
    "sid": "61c37269fa0b4e02c80a21776dd5c03e",
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551040147,
    "idp": "local",
    "name": "Administrator",
    "website": "https://example.org",
    "preferred_username": "admin",
    "amr": "pwd"
  }
}
2019-02-24 21:32:54.985 +01:00 [INF] End session request validation failure: Invalid post logout URI
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjQzZmNkNmY1ZmI2MDgwMmYzMjA2OTNjZGY1M2JmYjc3IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NTEwNDAzNzAsImV4cCI6MTU1MTA0MDY3MCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo0OTY3MCIsImF1ZCI6InNwYSIsIm5vbmNlIjoiMHpDcFcxRkI5WERDQktYNnpjdHE5RkhRV29hZjFSWnpkNGhBUnZhRyIsImlhdCI6MTU1MTA0MDM3MCwiYXRfaGFzaCI6Ild3cE1fUUdpTUZybVFieE9fdV9pelEiLCJzaWQiOiI2MWMzNzI2OWZhMGI0ZTAyYzgwYTIxNzc2ZGQ1YzAzZSIsInN1YiI6IjM5ZDU2OWFmLTk3NjYtNGE0MS1hOTNhLWZlYTc2Nzc5ZjlmNCIsImF1dGhfdGltZSI6MTU1MTA0MDE0NywiaWRwIjoibG9jYWwiLCJuYW1lIjoiQWRtaW5pc3RyYXRvciIsIndlYnNpdGUiOiJodHRwczovL2V4YW1wbGUub3JnIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiYWRtaW4iLCJhbXIiOlsicHdkIl19.XD3AZE_uBb3GKyaotAJOjEoy-pu0p7QlwNSzZ-FEie6Qkee1GyNOo3qpogkl0ywnoYjPQOJsAeFYwISmWtchINPfm2pkrTnX3I1MLkDyT0CPU9bno_GfIdRBSJOHPzC9Pcr0LXu028GsnSSYmGjchSlYmHA6r2g30z93Gstc1e1EhHV6eMthKNlq_hsZ3KAkm2l9ZanWwSx3xAiM97rubvYgEiDt7fFrhyCL3E-cGJGDMBIeXWxHeLbZKlqOihXE_icmnUgWEfFHheVg0dNLwHacYmybq2D4cQ01eDw1WuaGPsZbUaQntky9T1JPeRgDlLzZ7AU3f5OaRGEJf9wIrQ",
    "post_logout_redirect_uri": "http://localhost:4200/home"
  }
}
2019-02-24 21:32:54.985 +01:00 [ERR] Error processing end session request Invalid request
2019-02-24 21:32:54.990 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:32:54.990 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:32:56.636 +01:00 [DBG] CORS request made for path: /account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 21:32:56.636 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:32:56.636 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:32:56.637 +01:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-02-24 21:32:56.637 +01:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-02-24 21:32:56.637 +01:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-02-24 21:32:56.637 +01:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "Administrator",
  "ActivityId": "0HLKQH92VR6T0:00000003",
  "TimeStamp": "2019-02-24T20:32:56Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:32:56.668 +01:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-02-24 21:32:56.669 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-02-24 21:32:56.669 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-02-24 21:32:56.669 +01:00 [DBG] Processing signout callback request
2019-02-24 21:32:56.670 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:32:56.671 +01:00 [DBG] No client front-channel logout URLs
2019-02-24 21:32:56.671 +01:00 [DBG] No client back-channel logout URLs
2019-02-24 21:32:56.671 +01:00 [INF] Successful signout callback.
2019-02-24 21:32:56.671 +01:00 [DBG] No client front-channel iframe urls
2019-02-24 21:32:56.671 +01:00 [DBG] No client back-channel iframe urls
2019-02-24 21:33:04.821 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:33:04.821 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:33:04.821 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:33:04.821 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:33:04.821 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:33:04.821 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:33:04.822 +01:00 [DBG] Start discovery request
2019-02-24 21:33:04.994 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:33:04.995 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:33:04.995 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:33:04.995 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:33:04.996 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:33:04.996 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:33:04.996 +01:00 [DBG] Start key discovery request
2019-02-24 21:33:05.156 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:33:05.156 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:33:05.156 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:33:05.157 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:33:05.157 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:33:05.157 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:33:05.157 +01:00 [DBG] Start discovery request
2019-02-24 21:33:05.266 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:33:05.266 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:33:05.266 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:33:05.266 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:33:05.267 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:33:05.267 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:33:05.267 +01:00 [DBG] Start key discovery request
2019-02-24 21:33:05.272 +01:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-02-24 21:33:05.273 +01:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-02-24 21:33:05.273 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-02-24 21:33:05.273 +01:00 [DBG] Starting introspection request.
2019-02-24 21:33:05.273 +01:00 [DBG] Start parsing Basic Authentication secret
2019-02-24 21:33:05.273 +01:00 [DBG] Start parsing for secret in post body
2019-02-24 21:33:05.273 +01:00 [DBG] Parser found secret: PostBodySecretParser
2019-02-24 21:33:05.273 +01:00 [DBG] Secret id found: api1
2019-02-24 21:33:05.273 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-02-24 21:33:05.273 +01:00 [DBG] API resource validation success
2019-02-24 21:33:05.273 +01:00 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "api1",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLKQH92VR6ST:00000003",
  "TimeStamp": "2019-02-24T20:33:05Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:33:05.273 +01:00 [DBG] Introspection request validation started.
2019-02-24 21:33:05.288 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:33:05.288 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:33:05.290 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-02-24 21:33:05.291 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "adab68fe15c883a3e605a13af0a3b84f9674c4f238e76fff8a57cf5d0ab5ab75",
  "Claims": {
    "iss": "http://localhost:49670",
    "nbf": 1551040302,
    "exp": 1551043902,
    "aud": [
      "http://localhost:49670/resources",
      "api1"
    ],
    "client_id": "spa",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551040147,
    "idp": "local",
    "amr": "pwd"
  }
}
2019-02-24 21:33:05.291 +01:00 [DBG] Introspection request validation successful.
2019-02-24 21:33:05.291 +01:00 [DBG] Creating introspection response for active token.
2019-02-24 21:33:05.291 +01:00 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "api1",
  "IsActive": true,
  "Token": "****ab75",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "ActivityId": "0HLKQH92VR6ST:00000003",
  "TimeStamp": "2019-02-24T20:33:05Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:33:05.291 +01:00 [INF] Success token introspection. Token active: true, for API name: api1
2019-02-24 21:33:15.887 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:33:15.888 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:33:15.888 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:33:15.888 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:33:15.888 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:33:15.888 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:33:15.888 +01:00 [DBG] Start discovery request
2019-02-24 21:33:15.984 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:33:15.984 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:33:15.985 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:33:15.985 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:33:15.986 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:33:15.986 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:33:15.986 +01:00 [DBG] Start key discovery request
2019-02-24 21:33:41.459 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:33:41.459 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:33:41.459 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:33:41.459 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:33:41.459 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:33:41.459 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:33:41.459 +01:00 [DBG] Start discovery request
2019-02-24 21:33:41.547 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:33:41.547 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:33:41.547 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:33:41.548 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:33:41.548 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:33:41.548 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:33:41.548 +01:00 [DBG] Start key discovery request
2019-02-24 21:33:52.165 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 21:33:52.166 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 21:33:52.166 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 21:33:52.166 +01:00 [DBG] Start authorize request
2019-02-24 21:33:52.166 +01:00 [DBG] No user present in authorize request
2019-02-24 21:33:52.166 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:33:52.166 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:33:52.166 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:33:52.166 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "ufVmHuh2HiAKNhMA3L6Vw7CoV4dtH5ewIzsMmZt2",
  "Nonce": "ufVmHuh2HiAKNhMA3L6Vw7CoV4dtH5ewIzsMmZt2",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "ufVmHuh2HiAKNhMA3L6Vw7CoV4dtH5ewIzsMmZt2",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "ufVmHuh2HiAKNhMA3L6Vw7CoV4dtH5ewIzsMmZt2"
  }
}
2019-02-24 21:33:52.166 +01:00 [INF] Showing login: User is not authenticated
2019-02-24 21:33:52.177 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:33:52.178 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:33:52.178 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:33:52.178 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:33:59.230 +01:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 21:33:59.262 +01:00 [DBG] Augmenting SignInContext
2019-02-24 21:33:59.262 +01:00 [DBG] Adding idp claim with value: local
2019-02-24 21:33:59.263 +01:00 [DBG] Adding amr claim with value: pwd
2019-02-24 21:33:59.263 +01:00 [DBG] Adding auth_time claim with value: 1551040439
2019-02-24 21:33:59.263 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-02-24 21:33:59.265 +01:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "admin",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "admin",
  "Endpoint": "UI",
  "ActivityId": "0HLKQH92VR6T5:00000003",
  "TimeStamp": "2019-02-24T20:33:59Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:33:59.271 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:33:59.271 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:33:59.271 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-24 21:33:59.271 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-24 21:33:59.271 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-24 21:33:59.271 +01:00 [DBG] Start authorize callback request
2019-02-24 21:33:59.272 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:33:59.272 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:33:59.272 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:33:59.272 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:33:59.272 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "ufVmHuh2HiAKNhMA3L6Vw7CoV4dtH5ewIzsMmZt2",
  "Nonce": "ufVmHuh2HiAKNhMA3L6Vw7CoV4dtH5ewIzsMmZt2",
  "SessionId": "c3054dabd430bcf1ba85e061f95ba0ea",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "ufVmHuh2HiAKNhMA3L6Vw7CoV4dtH5ewIzsMmZt2",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "ufVmHuh2HiAKNhMA3L6Vw7CoV4dtH5ewIzsMmZt2"
  }
}
2019-02-24 21:33:59.281 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-02-24 21:33:59.281 +01:00 [DBG] Creating Implicit Flow response.
2019-02-24 21:33:59.281 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-24 21:33:59.282 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:33:59.299 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-24 21:33:59.311 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****RMVw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****2157"
    }
  ],
  "ActivityId": "0HLKQH92VR6T5:00000004",
  "TimeStamp": "2019-02-24T20:33:59Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:33:59.311 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "ufVmHuh2HiAKNhMA3L6Vw7CoV4dtH5ewIzsMmZt2",
  "Scope": "openid profile api1"
}
2019-02-24 21:33:59.311 +01:00 [DBG] Augmenting SignInContext
2019-02-24 21:33:59.311 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-02-24 21:34:00.394 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:34:00.394 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:34:00.394 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:34:00.394 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:34:00.394 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:34:00.394 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:34:00.394 +01:00 [DBG] Start discovery request
2019-02-24 21:34:00.485 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:34:00.485 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:34:00.485 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:34:00.485 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:34:00.486 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:34:00.486 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:34:00.486 +01:00 [DBG] Start key discovery request
2019-02-24 21:34:09.788 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:34:09.789 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:34:09.789 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:34:09.789 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:34:09.789 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:34:09.789 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:34:09.789 +01:00 [DBG] Start discovery request
2019-02-24 21:34:09.864 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:34:09.865 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:34:09.865 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:34:09.865 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:34:09.866 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:34:09.866 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:34:09.866 +01:00 [DBG] Start key discovery request
2019-02-24 21:34:48.286 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:34:48.286 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:34:48.286 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:34:48.287 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:34:48.287 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:34:48.287 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:34:48.287 +01:00 [DBG] Start discovery request
2019-02-24 21:34:48.444 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:34:48.444 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:34:48.444 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:34:48.444 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:34:48.444 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:34:48.444 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:34:48.445 +01:00 [DBG] Start key discovery request
2019-02-24 21:34:49.513 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:34:49.513 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:34:49.513 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:34:49.513 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:34:49.513 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:34:49.513 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:34:49.513 +01:00 [DBG] Start discovery request
2019-02-24 21:34:49.590 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:34:49.591 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:34:49.591 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:34:49.591 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:34:49.591 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:34:49.591 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:34:49.591 +01:00 [DBG] Start key discovery request
2019-02-24 21:34:49.663 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:34:49.663 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:34:49.663 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:34:49.663 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:34:49.664 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:34:49.664 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:34:49.664 +01:00 [DBG] Start discovery request
2019-02-24 21:34:49.764 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:34:49.764 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:34:49.764 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:34:49.764 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:34:49.765 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:34:49.765 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:34:49.765 +01:00 [DBG] Start key discovery request
2019-02-24 21:34:49.824 +01:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-02-24 21:34:49.824 +01:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-02-24 21:34:49.825 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-02-24 21:34:49.825 +01:00 [DBG] Starting introspection request.
2019-02-24 21:34:49.825 +01:00 [DBG] Start parsing Basic Authentication secret
2019-02-24 21:34:49.825 +01:00 [DBG] Start parsing for secret in post body
2019-02-24 21:34:49.825 +01:00 [DBG] Parser found secret: PostBodySecretParser
2019-02-24 21:34:49.825 +01:00 [DBG] Secret id found: api1
2019-02-24 21:34:49.825 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-02-24 21:34:49.825 +01:00 [DBG] API resource validation success
2019-02-24 21:34:49.825 +01:00 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "api1",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLKQH92VR6ST:00000004",
  "TimeStamp": "2019-02-24T20:34:49Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:34:49.825 +01:00 [DBG] Introspection request validation started.
2019-02-24 21:34:49.840 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:34:49.840 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:34:49.842 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-02-24 21:34:49.843 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "adab68fe15c883a3e605a13af0a3b84f9674c4f238e76fff8a57cf5d0ab5ab75",
  "Claims": {
    "iss": "http://localhost:49670",
    "nbf": 1551040302,
    "exp": 1551043902,
    "aud": [
      "http://localhost:49670/resources",
      "api1"
    ],
    "client_id": "spa",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551040147,
    "idp": "local",
    "amr": "pwd"
  }
}
2019-02-24 21:34:49.843 +01:00 [DBG] Introspection request validation successful.
2019-02-24 21:34:49.843 +01:00 [DBG] Creating introspection response for active token.
2019-02-24 21:34:49.843 +01:00 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "api1",
  "IsActive": true,
  "Token": "****ab75",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "ActivityId": "0HLKQH92VR6ST:00000004",
  "TimeStamp": "2019-02-24T20:34:49Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:34:49.843 +01:00 [INF] Success token introspection. Token active: true, for API name: api1
2019-02-24 21:34:54.433 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:34:54.433 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:34:54.433 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:34:54.433 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:34:54.433 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:34:54.433 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:34:54.434 +01:00 [DBG] Start discovery request
2019-02-24 21:34:54.570 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:34:54.570 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:34:54.571 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:34:54.571 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:34:54.571 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:34:54.572 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:34:54.572 +01:00 [DBG] Start key discovery request
2019-02-24 21:34:55.577 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:34:55.577 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:34:55.577 +01:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-02-24 21:34:55.577 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-02-24 21:34:55.577 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-02-24 21:34:55.577 +01:00 [DBG] Processing signout request for 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:34:55.577 +01:00 [DBG] Start end session request validation
2019-02-24 21:34:55.577 +01:00 [DBG] Start identity token validation
2019-02-24 21:34:55.578 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:34:55.578 +01:00 [DBG] Client found: spa / SPA Client
2019-02-24 21:34:55.586 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-02-24 21:34:55.586 +01:00 [DBG] Token validation success
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1551040439,
    "exp": 1551040739,
    "iss": "http://localhost:49670",
    "aud": "spa",
    "nonce": "ufVmHuh2HiAKNhMA3L6Vw7CoV4dtH5ewIzsMmZt2",
    "iat": 1551040439,
    "at_hash": "LBmtEMmCdqmxoEv0t6NwiA",
    "sid": "c3054dabd430bcf1ba85e061f95ba0ea",
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551040439,
    "idp": "local",
    "name": "Administrator",
    "website": "https://example.org",
    "preferred_username": "admin",
    "amr": "pwd"
  }
}
2019-02-24 21:34:55.586 +01:00 [INF] End session request validation failure: Invalid post logout URI
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjQzZmNkNmY1ZmI2MDgwMmYzMjA2OTNjZGY1M2JmYjc3IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NTEwNDA0MzksImV4cCI6MTU1MTA0MDczOSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo0OTY3MCIsImF1ZCI6InNwYSIsIm5vbmNlIjoidWZWbUh1aDJIaUFLTmhNQTNMNlZ3N0NvVjRkdEg1ZXdJenNNbVp0MiIsImlhdCI6MTU1MTA0MDQzOSwiYXRfaGFzaCI6IkxCbXRFTW1DZHFteG9FdjB0Nk53aUEiLCJzaWQiOiJjMzA1NGRhYmQ0MzBiY2YxYmE4NWUwNjFmOTViYTBlYSIsInN1YiI6IjM5ZDU2OWFmLTk3NjYtNGE0MS1hOTNhLWZlYTc2Nzc5ZjlmNCIsImF1dGhfdGltZSI6MTU1MTA0MDQzOSwiaWRwIjoibG9jYWwiLCJuYW1lIjoiQWRtaW5pc3RyYXRvciIsIndlYnNpdGUiOiJodHRwczovL2V4YW1wbGUub3JnIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiYWRtaW4iLCJhbXIiOlsicHdkIl19.FTcs2RgTgX9-8dmp3xOATMIM8AJ-N69nJlSvN5Vz9WWWqPUt37FddAGA-YR2JiY7L6vcLUPT5VWeeIXvjp5_MIiqC8S6q2rijTlX0YGDRQ0K8Y9VedSBNEPQ83mzL7cCUQaaMqwjTR3x6B2CJ172nkQJ9iU1OOVvygJg4C-q1Oc1QSBS6uY4G4HZmWwqaY4nlcvz7_wUpqWPuFdbYSc_-A4fANqC4T2ScQAHfWGSmHFlGg-Z_chpDCHWJDepGuX7WapglJqQOcjct_COV3YywDBZBsD33kux4nRthGwadN1rX4mWYLIu96H989ObAhal8XtJdBekUtAcMXjgRuRMVw",
    "post_logout_redirect_uri": "http://localhost:4200/home"
  }
}
2019-02-24 21:34:55.586 +01:00 [ERR] Error processing end session request Invalid request
2019-02-24 21:34:55.592 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:34:55.592 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:34:56.683 +01:00 [DBG] CORS request made for path: /account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 21:34:56.684 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:34:56.684 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:34:56.684 +01:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-02-24 21:34:56.685 +01:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-02-24 21:34:56.685 +01:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-02-24 21:34:56.685 +01:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "Administrator",
  "ActivityId": "0HLKQH92VR6TA:00000003",
  "TimeStamp": "2019-02-24T20:34:56Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:34:56.729 +01:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-02-24 21:34:56.729 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-02-24 21:34:56.730 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-02-24 21:34:56.730 +01:00 [DBG] Processing signout callback request
2019-02-24 21:34:56.730 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:34:56.730 +01:00 [DBG] No client front-channel logout URLs
2019-02-24 21:34:56.730 +01:00 [DBG] No client back-channel logout URLs
2019-02-24 21:34:56.730 +01:00 [INF] Successful signout callback.
2019-02-24 21:34:56.730 +01:00 [DBG] No client front-channel iframe urls
2019-02-24 21:34:56.730 +01:00 [DBG] No client back-channel iframe urls
2019-02-24 21:35:03.681 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:35:03.681 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:35:03.681 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:35:03.681 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:35:03.682 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:35:03.682 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:35:03.682 +01:00 [DBG] Start discovery request
2019-02-24 21:35:03.748 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:35:03.749 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:35:03.749 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:35:03.749 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:35:03.750 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:35:03.750 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:35:03.750 +01:00 [DBG] Start key discovery request
2019-02-24 21:35:03.770 +01:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-02-24 21:35:03.771 +01:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-02-24 21:35:03.771 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-02-24 21:35:03.771 +01:00 [DBG] Starting introspection request.
2019-02-24 21:35:03.771 +01:00 [DBG] Start parsing Basic Authentication secret
2019-02-24 21:35:03.771 +01:00 [DBG] Start parsing for secret in post body
2019-02-24 21:35:03.771 +01:00 [DBG] Parser found secret: PostBodySecretParser
2019-02-24 21:35:03.771 +01:00 [DBG] Secret id found: api1
2019-02-24 21:35:03.771 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-02-24 21:35:03.771 +01:00 [DBG] API resource validation success
2019-02-24 21:35:03.771 +01:00 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "api1",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLKQH92VR6ST:00000005",
  "TimeStamp": "2019-02-24T20:35:03Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:35:03.772 +01:00 [DBG] Introspection request validation started.
2019-02-24 21:35:03.792 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:35:03.793 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:35:03.795 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-02-24 21:35:03.796 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "adab68fe15c883a3e605a13af0a3b84f9674c4f238e76fff8a57cf5d0ab5ab75",
  "Claims": {
    "iss": "http://localhost:49670",
    "nbf": 1551040302,
    "exp": 1551043902,
    "aud": [
      "http://localhost:49670/resources",
      "api1"
    ],
    "client_id": "spa",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551040147,
    "idp": "local",
    "amr": "pwd"
  }
}
2019-02-24 21:35:03.796 +01:00 [DBG] Introspection request validation successful.
2019-02-24 21:35:03.796 +01:00 [DBG] Creating introspection response for active token.
2019-02-24 21:35:03.796 +01:00 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "api1",
  "IsActive": true,
  "Token": "****ab75",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "ActivityId": "0HLKQH92VR6ST:00000005",
  "TimeStamp": "2019-02-24T20:35:03Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:35:03.796 +01:00 [INF] Success token introspection. Token active: true, for API name: api1
2019-02-24 21:35:03.802 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:35:03.804 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:35:03.805 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:35:03.808 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:35:03.811 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:35:03.811 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:35:03.811 +01:00 [DBG] Start discovery request
2019-02-24 21:35:03.896 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:35:03.896 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:35:03.896 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:35:03.896 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:35:03.896 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:35:03.896 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:35:03.896 +01:00 [DBG] Start key discovery request
2019-02-24 21:35:05.257 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:35:05.257 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:35:05.258 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:35:05.258 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:35:05.258 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:35:05.258 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:35:05.258 +01:00 [DBG] Start discovery request
2019-02-24 21:35:05.367 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:35:05.367 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:35:05.368 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:35:05.368 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:35:05.368 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:35:05.368 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:35:05.368 +01:00 [DBG] Start key discovery request
2019-02-24 21:35:09.392 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 21:35:09.392 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 21:35:09.392 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 21:35:09.392 +01:00 [DBG] Start authorize request
2019-02-24 21:35:09.392 +01:00 [DBG] No user present in authorize request
2019-02-24 21:35:09.392 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:35:09.392 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:35:09.396 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:35:09.396 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "Nq0m6Y4UL82zmH3qx5r9DChMU5HTWtyksRt1kVfy",
  "Nonce": "Nq0m6Y4UL82zmH3qx5r9DChMU5HTWtyksRt1kVfy",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "Nq0m6Y4UL82zmH3qx5r9DChMU5HTWtyksRt1kVfy",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "Nq0m6Y4UL82zmH3qx5r9DChMU5HTWtyksRt1kVfy"
  }
}
2019-02-24 21:35:09.396 +01:00 [INF] Showing login: User is not authenticated
2019-02-24 21:35:09.403 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:35:09.403 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:35:09.404 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:35:09.404 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:35:12.455 +01:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 21:35:12.486 +01:00 [DBG] Augmenting SignInContext
2019-02-24 21:35:12.486 +01:00 [DBG] Adding idp claim with value: local
2019-02-24 21:35:12.486 +01:00 [DBG] Adding amr claim with value: pwd
2019-02-24 21:35:12.486 +01:00 [DBG] Adding auth_time claim with value: 1551040512
2019-02-24 21:35:12.486 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-02-24 21:35:12.488 +01:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "admin",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "admin",
  "Endpoint": "UI",
  "ActivityId": "0HLKQH92VR6TD:00000001",
  "TimeStamp": "2019-02-24T20:35:12Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:35:12.493 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:35:12.494 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:35:12.494 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-24 21:35:12.494 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-24 21:35:12.494 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-24 21:35:12.494 +01:00 [DBG] Start authorize callback request
2019-02-24 21:35:12.494 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:35:12.494 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:35:12.494 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:35:12.494 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:35:12.494 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "Nq0m6Y4UL82zmH3qx5r9DChMU5HTWtyksRt1kVfy",
  "Nonce": "Nq0m6Y4UL82zmH3qx5r9DChMU5HTWtyksRt1kVfy",
  "SessionId": "61defa1606c8bd8cd2a0bfacf384395e",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "Nq0m6Y4UL82zmH3qx5r9DChMU5HTWtyksRt1kVfy",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "Nq0m6Y4UL82zmH3qx5r9DChMU5HTWtyksRt1kVfy"
  }
}
2019-02-24 21:35:12.502 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-02-24 21:35:12.502 +01:00 [DBG] Creating Implicit Flow response.
2019-02-24 21:35:12.502 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-24 21:35:12.502 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:35:12.518 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-24 21:35:12.529 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****fLDg"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****f53e"
    }
  ],
  "ActivityId": "0HLKQH92VR6TD:00000002",
  "TimeStamp": "2019-02-24T20:35:12Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:35:12.529 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "Nq0m6Y4UL82zmH3qx5r9DChMU5HTWtyksRt1kVfy",
  "Scope": "openid profile api1"
}
2019-02-24 21:35:12.530 +01:00 [DBG] Augmenting SignInContext
2019-02-24 21:35:12.530 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-02-24 21:35:13.668 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:35:13.668 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:35:13.668 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:35:13.668 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:35:13.668 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:35:13.668 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:35:13.668 +01:00 [DBG] Start discovery request
2019-02-24 21:35:13.750 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:35:13.750 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:35:13.750 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:35:13.750 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:35:13.751 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:35:13.751 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:35:13.751 +01:00 [DBG] Start key discovery request
2019-02-24 21:35:16.196 +01:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-02-24 21:35:16.197 +01:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-02-24 21:35:16.197 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-02-24 21:35:16.197 +01:00 [DBG] Starting introspection request.
2019-02-24 21:35:16.197 +01:00 [DBG] Start parsing Basic Authentication secret
2019-02-24 21:35:16.197 +01:00 [DBG] Start parsing for secret in post body
2019-02-24 21:35:16.199 +01:00 [DBG] Parser found secret: PostBodySecretParser
2019-02-24 21:35:16.199 +01:00 [DBG] Secret id found: api1
2019-02-24 21:35:16.199 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-02-24 21:35:16.199 +01:00 [DBG] API resource validation success
2019-02-24 21:35:16.199 +01:00 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "api1",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLKQH92VR6ST:00000006",
  "TimeStamp": "2019-02-24T20:35:16Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:35:16.199 +01:00 [DBG] Introspection request validation started.
2019-02-24 21:35:16.216 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:35:16.216 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:35:16.219 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-02-24 21:35:16.219 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "6ff18c0a6f21ccf5d8f725b469f6b829bbfb2f348f80759e592574a34203f53e",
  "Claims": {
    "iss": "http://localhost:49670",
    "nbf": 1551040512,
    "exp": 1551044112,
    "aud": [
      "http://localhost:49670/resources",
      "api1"
    ],
    "client_id": "spa",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551040512,
    "idp": "local",
    "amr": "pwd"
  }
}
2019-02-24 21:35:16.219 +01:00 [DBG] Introspection request validation successful.
2019-02-24 21:35:16.219 +01:00 [DBG] Creating introspection response for active token.
2019-02-24 21:35:16.220 +01:00 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "api1",
  "IsActive": true,
  "Token": "****f53e",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "ActivityId": "0HLKQH92VR6ST:00000006",
  "TimeStamp": "2019-02-24T20:35:16Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:35:16.220 +01:00 [INF] Success token introspection. Token active: true, for API name: api1
2019-02-24 21:35:26.601 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:35:26.601 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:35:26.602 +01:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-02-24 21:35:26.602 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-02-24 21:35:26.602 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-02-24 21:35:26.602 +01:00 [DBG] Processing signout request for 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:35:26.602 +01:00 [DBG] Start end session request validation
2019-02-24 21:35:26.602 +01:00 [DBG] Start identity token validation
2019-02-24 21:35:26.602 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:35:26.602 +01:00 [DBG] Client found: spa / SPA Client
2019-02-24 21:35:26.609 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-02-24 21:35:26.609 +01:00 [DBG] Token validation success
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1551040512,
    "exp": 1551040812,
    "iss": "http://localhost:49670",
    "aud": "spa",
    "nonce": "Nq0m6Y4UL82zmH3qx5r9DChMU5HTWtyksRt1kVfy",
    "iat": 1551040512,
    "at_hash": "y02c0Li0IzB-Me-gCcUe8Q",
    "sid": "61defa1606c8bd8cd2a0bfacf384395e",
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551040512,
    "idp": "local",
    "name": "Administrator",
    "website": "https://example.org",
    "preferred_username": "admin",
    "amr": "pwd"
  }
}
2019-02-24 21:35:26.610 +01:00 [INF] End session request validation failure: Invalid post logout URI
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjQzZmNkNmY1ZmI2MDgwMmYzMjA2OTNjZGY1M2JmYjc3IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NTEwNDA1MTIsImV4cCI6MTU1MTA0MDgxMiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo0OTY3MCIsImF1ZCI6InNwYSIsIm5vbmNlIjoiTnEwbTZZNFVMODJ6bUgzcXg1cjlEQ2hNVTVIVFd0eWtzUnQxa1ZmeSIsImlhdCI6MTU1MTA0MDUxMiwiYXRfaGFzaCI6InkwMmMwTGkwSXpCLU1lLWdDY1VlOFEiLCJzaWQiOiI2MWRlZmExNjA2YzhiZDhjZDJhMGJmYWNmMzg0Mzk1ZSIsInN1YiI6IjM5ZDU2OWFmLTk3NjYtNGE0MS1hOTNhLWZlYTc2Nzc5ZjlmNCIsImF1dGhfdGltZSI6MTU1MTA0MDUxMiwiaWRwIjoibG9jYWwiLCJuYW1lIjoiQWRtaW5pc3RyYXRvciIsIndlYnNpdGUiOiJodHRwczovL2V4YW1wbGUub3JnIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiYWRtaW4iLCJhbXIiOlsicHdkIl19.plkkzXJjA095TRbgdmZOktazufnbE2mGsic6Q3sczcfun4Snt4ssb4v6N74pkBdAb7oXhcs9LlS8wG21wsfumRAaiV2-s1Emt4bLg3Pfym1RCOGg3bxB9WsZ8TnwLhLloGt4NEt1wtkcy1uIW8F-O_codwS2Yg9KeiD3fjYFECQD0_-iOR7NwlRpqRUBWtCiDE9g0RT3zqIZwHy6k8MlTmL-Fj6wZCS4v4BLjh4bf2rWdsaTBQeF9Qk_38gaY7TDmL8qZpaCx403Lvjdn862XIAq7OrwtuO9yWhLNFM8agAJBJMWSxFcIAtRVAmBTWc9b2miBzBvVwAWwHx8AtfLDg",
    "post_logout_redirect_uri": "http://localhost:4200/home"
  }
}
2019-02-24 21:35:26.610 +01:00 [ERR] Error processing end session request Invalid request
2019-02-24 21:35:26.617 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:35:26.617 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:35:27.858 +01:00 [DBG] CORS request made for path: /account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 21:35:27.859 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:35:27.859 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:35:27.860 +01:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-02-24 21:35:27.860 +01:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-02-24 21:35:27.860 +01:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-02-24 21:35:27.860 +01:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "Administrator",
  "ActivityId": "0HLKQH92VR6TF:00000003",
  "TimeStamp": "2019-02-24T20:35:27Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:35:27.905 +01:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-02-24 21:35:27.905 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-02-24 21:35:27.906 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-02-24 21:35:27.906 +01:00 [DBG] Processing signout callback request
2019-02-24 21:35:27.906 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:35:27.906 +01:00 [DBG] No client front-channel logout URLs
2019-02-24 21:35:27.906 +01:00 [DBG] No client back-channel logout URLs
2019-02-24 21:35:27.906 +01:00 [INF] Successful signout callback.
2019-02-24 21:35:27.906 +01:00 [DBG] No client front-channel iframe urls
2019-02-24 21:35:27.906 +01:00 [DBG] No client back-channel iframe urls
2019-02-24 21:35:53.071 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:35:53.071 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:35:53.071 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:35:53.071 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:35:53.071 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:35:53.071 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:35:53.071 +01:00 [DBG] Start discovery request
2019-02-24 21:35:53.167 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:35:53.167 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:35:53.167 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:35:53.167 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:35:53.168 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:35:53.168 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:35:53.168 +01:00 [DBG] Start key discovery request
2019-02-24 21:35:56.488 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 21:35:56.489 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 21:35:56.489 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 21:35:56.490 +01:00 [DBG] Start authorize request
2019-02-24 21:35:56.490 +01:00 [DBG] No user present in authorize request
2019-02-24 21:35:56.490 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:35:56.490 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:35:56.491 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:35:56.491 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "iiY6SDdzq5HpVrF0mfe48ETk0xI88OgZvY6T5ivs",
  "Nonce": "iiY6SDdzq5HpVrF0mfe48ETk0xI88OgZvY6T5ivs",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "iiY6SDdzq5HpVrF0mfe48ETk0xI88OgZvY6T5ivs",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "iiY6SDdzq5HpVrF0mfe48ETk0xI88OgZvY6T5ivs"
  }
}
2019-02-24 21:35:56.492 +01:00 [INF] Showing login: User is not authenticated
2019-02-24 21:35:56.499 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:35:56.499 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:35:56.499 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:35:56.499 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:35:59.421 +01:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 21:35:59.451 +01:00 [DBG] Augmenting SignInContext
2019-02-24 21:35:59.451 +01:00 [DBG] Adding idp claim with value: local
2019-02-24 21:35:59.451 +01:00 [DBG] Adding amr claim with value: pwd
2019-02-24 21:35:59.451 +01:00 [DBG] Adding auth_time claim with value: 1551040559
2019-02-24 21:35:59.451 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-02-24 21:35:59.453 +01:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "admin",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "admin",
  "Endpoint": "UI",
  "ActivityId": "0HLKQH92VR6TH:00000003",
  "TimeStamp": "2019-02-24T20:35:59Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:35:59.458 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:35:59.458 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:35:59.458 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-24 21:35:59.458 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-24 21:35:59.459 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-24 21:35:59.459 +01:00 [DBG] Start authorize callback request
2019-02-24 21:35:59.459 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:35:59.459 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:35:59.459 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:35:59.459 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:35:59.459 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "iiY6SDdzq5HpVrF0mfe48ETk0xI88OgZvY6T5ivs",
  "Nonce": "iiY6SDdzq5HpVrF0mfe48ETk0xI88OgZvY6T5ivs",
  "SessionId": "a5b930670d4c1be40e7ae6b5b1ae2008",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "iiY6SDdzq5HpVrF0mfe48ETk0xI88OgZvY6T5ivs",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "iiY6SDdzq5HpVrF0mfe48ETk0xI88OgZvY6T5ivs"
  }
}
2019-02-24 21:35:59.467 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-02-24 21:35:59.468 +01:00 [DBG] Creating Implicit Flow response.
2019-02-24 21:35:59.468 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-24 21:35:59.468 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:35:59.483 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-24 21:35:59.494 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****8Msw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****4364"
    }
  ],
  "ActivityId": "0HLKQH92VR6TH:00000004",
  "TimeStamp": "2019-02-24T20:35:59Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:35:59.494 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "iiY6SDdzq5HpVrF0mfe48ETk0xI88OgZvY6T5ivs",
  "Scope": "openid profile api1"
}
2019-02-24 21:35:59.494 +01:00 [DBG] Augmenting SignInContext
2019-02-24 21:35:59.495 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-02-24 21:36:00.277 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:36:00.277 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:36:00.277 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:36:00.277 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:36:00.278 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:36:00.278 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:36:00.278 +01:00 [DBG] Start discovery request
2019-02-24 21:36:00.371 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:36:00.371 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:36:00.371 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:36:00.371 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:36:00.372 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:36:00.372 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:36:00.372 +01:00 [DBG] Start key discovery request
2019-02-24 21:38:01.408 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:38:01.409 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:38:01.409 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:38:01.409 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:38:01.409 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:38:01.409 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:38:01.409 +01:00 [DBG] Start discovery request
2019-02-24 21:38:01.518 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:38:01.518 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:38:01.518 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:38:01.518 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:38:01.518 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:38:01.518 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:38:01.518 +01:00 [DBG] Start key discovery request
2019-02-24 21:38:34.582 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:38:34.582 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:38:34.582 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:38:34.582 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:38:34.582 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:38:34.582 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:38:34.582 +01:00 [DBG] Start discovery request
2019-02-24 21:38:34.689 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:38:34.689 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:38:34.689 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:38:34.689 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:38:34.689 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:38:34.689 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:38:34.689 +01:00 [DBG] Start key discovery request
2019-02-24 21:38:39.975 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:38:39.975 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:38:39.975 +01:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-02-24 21:38:39.976 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-02-24 21:38:39.976 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-02-24 21:38:39.976 +01:00 [DBG] Processing signout request for 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:38:39.976 +01:00 [DBG] Start end session request validation
2019-02-24 21:38:39.976 +01:00 [DBG] Start identity token validation
2019-02-24 21:38:39.977 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:38:39.977 +01:00 [DBG] Client found: spa / SPA Client
2019-02-24 21:38:39.985 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-02-24 21:38:39.985 +01:00 [DBG] Token validation success
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1551040559,
    "exp": 1551040859,
    "iss": "http://localhost:49670",
    "aud": "spa",
    "nonce": "iiY6SDdzq5HpVrF0mfe48ETk0xI88OgZvY6T5ivs",
    "iat": 1551040559,
    "at_hash": "NqgWkswmWiuGDkBA-aJUcw",
    "sid": "a5b930670d4c1be40e7ae6b5b1ae2008",
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551040559,
    "idp": "local",
    "name": "Administrator",
    "website": "https://example.org",
    "preferred_username": "admin",
    "amr": "pwd"
  }
}
2019-02-24 21:38:39.986 +01:00 [INF] End session request validation failure: Invalid post logout URI
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjQzZmNkNmY1ZmI2MDgwMmYzMjA2OTNjZGY1M2JmYjc3IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NTEwNDA1NTksImV4cCI6MTU1MTA0MDg1OSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo0OTY3MCIsImF1ZCI6InNwYSIsIm5vbmNlIjoiaWlZNlNEZHpxNUhwVnJGMG1mZTQ4RVRrMHhJODhPZ1p2WTZUNWl2cyIsImlhdCI6MTU1MTA0MDU1OSwiYXRfaGFzaCI6Ik5xZ1drc3dtV2l1R0RrQkEtYUpVY3ciLCJzaWQiOiJhNWI5MzA2NzBkNGMxYmU0MGU3YWU2YjViMWFlMjAwOCIsInN1YiI6IjM5ZDU2OWFmLTk3NjYtNGE0MS1hOTNhLWZlYTc2Nzc5ZjlmNCIsImF1dGhfdGltZSI6MTU1MTA0MDU1OSwiaWRwIjoibG9jYWwiLCJuYW1lIjoiQWRtaW5pc3RyYXRvciIsIndlYnNpdGUiOiJodHRwczovL2V4YW1wbGUub3JnIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiYWRtaW4iLCJhbXIiOlsicHdkIl19.GQVzaepVa1B-4i-20TtaRLjo0aYqEO0fYPYlXn34I4rSk7gXwvzoSLtO4cig6BEIv_Yyg1dVhemnyZZCb2S1r4jSLJZsAsL_VE7nIOIL9_fDdR4esz7ogkwdyh6QkXvBumsK-YFuV8IQ9Aw4ojwuvHC52ekWCHlS78fvNWQPWytYoj8isFR1Zo9Dz9RZwrrAvMkNmZkDDScZSfkStJgsaYvmfoOMciVjEnMiqVnNgdy-K9j9A7eAa7fdO4i_oo-Ve2favXVG1jYGh_MB35kgAUA4HxwH0hbn2pLLMHfAFlAuo5Pw6rN7XTiz--4niDV9BlAcAEYLbP2G-uI5br8Msw",
    "post_logout_redirect_uri": "http://localhost:4200/home"
  }
}
2019-02-24 21:38:39.986 +01:00 [ERR] Error processing end session request Invalid request
2019-02-24 21:38:39.995 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:38:39.995 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:38:41.135 +01:00 [DBG] CORS request made for path: /account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 21:38:41.135 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:38:41.135 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:38:41.136 +01:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-02-24 21:38:41.136 +01:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-02-24 21:38:41.137 +01:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-02-24 21:38:41.137 +01:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "Administrator",
  "ActivityId": "0HLKQH92VR6TL:00000001",
  "TimeStamp": "2019-02-24T20:38:41Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:38:41.226 +01:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-02-24 21:38:41.227 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-02-24 21:38:41.227 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-02-24 21:38:41.227 +01:00 [DBG] Processing signout callback request
2019-02-24 21:38:41.227 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:38:41.227 +01:00 [DBG] No client front-channel logout URLs
2019-02-24 21:38:41.227 +01:00 [DBG] No client back-channel logout URLs
2019-02-24 21:38:41.227 +01:00 [INF] Successful signout callback.
2019-02-24 21:38:41.227 +01:00 [DBG] No client front-channel iframe urls
2019-02-24 21:38:41.227 +01:00 [DBG] No client back-channel iframe urls
2019-02-24 21:38:45.680 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:38:45.680 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:38:45.680 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:38:45.680 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:38:45.680 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:38:45.680 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:38:45.680 +01:00 [DBG] Start discovery request
2019-02-24 21:38:45.800 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:38:45.800 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:38:45.800 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:38:45.800 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:38:45.800 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:38:45.801 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:38:45.801 +01:00 [DBG] Start key discovery request
2019-02-24 21:38:46.678 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 21:38:46.678 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 21:38:46.678 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 21:38:46.678 +01:00 [DBG] Start authorize request
2019-02-24 21:38:46.678 +01:00 [DBG] No user present in authorize request
2019-02-24 21:38:46.678 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:38:46.678 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:38:46.679 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:38:46.679 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "R7vxTBCKEcBvdJtWYz5J367xCAPDewMEmTt8H8aO",
  "Nonce": "R7vxTBCKEcBvdJtWYz5J367xCAPDewMEmTt8H8aO",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "R7vxTBCKEcBvdJtWYz5J367xCAPDewMEmTt8H8aO",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "R7vxTBCKEcBvdJtWYz5J367xCAPDewMEmTt8H8aO"
  }
}
2019-02-24 21:38:46.679 +01:00 [INF] Showing login: User is not authenticated
2019-02-24 21:38:46.689 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:38:46.689 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:38:46.690 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:38:46.690 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:38:50.270 +01:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 21:38:50.301 +01:00 [DBG] Augmenting SignInContext
2019-02-24 21:38:50.301 +01:00 [DBG] Adding idp claim with value: local
2019-02-24 21:38:50.301 +01:00 [DBG] Adding amr claim with value: pwd
2019-02-24 21:38:50.301 +01:00 [DBG] Adding auth_time claim with value: 1551040730
2019-02-24 21:38:50.301 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-02-24 21:38:50.303 +01:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "admin",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "admin",
  "Endpoint": "UI",
  "ActivityId": "0HLKQH92VR6TL:00000005",
  "TimeStamp": "2019-02-24T20:38:50Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:38:50.308 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:38:50.309 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:38:50.309 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-24 21:38:50.309 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-24 21:38:50.309 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-24 21:38:50.309 +01:00 [DBG] Start authorize callback request
2019-02-24 21:38:50.309 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:38:50.309 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:38:50.309 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:38:50.310 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:38:50.310 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "R7vxTBCKEcBvdJtWYz5J367xCAPDewMEmTt8H8aO",
  "Nonce": "R7vxTBCKEcBvdJtWYz5J367xCAPDewMEmTt8H8aO",
  "SessionId": "c31e487c9a43ce409c1f74bfe7243633",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "R7vxTBCKEcBvdJtWYz5J367xCAPDewMEmTt8H8aO",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "R7vxTBCKEcBvdJtWYz5J367xCAPDewMEmTt8H8aO"
  }
}
2019-02-24 21:38:50.318 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-02-24 21:38:50.318 +01:00 [DBG] Creating Implicit Flow response.
2019-02-24 21:38:50.318 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-24 21:38:50.318 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:38:50.332 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-24 21:38:50.344 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****ypsw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****f24b"
    }
  ],
  "ActivityId": "0HLKQH92VR6TL:00000006",
  "TimeStamp": "2019-02-24T20:38:50Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:38:50.344 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "R7vxTBCKEcBvdJtWYz5J367xCAPDewMEmTt8H8aO",
  "Scope": "openid profile api1"
}
2019-02-24 21:38:50.344 +01:00 [DBG] Augmenting SignInContext
2019-02-24 21:38:50.344 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-02-24 21:38:51.122 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:38:51.122 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:38:51.122 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:38:51.123 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:38:51.123 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:38:51.123 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:38:51.123 +01:00 [DBG] Start discovery request
2019-02-24 21:38:51.213 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:38:51.213 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:38:51.213 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:38:51.213 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:38:51.214 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:38:51.214 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:38:51.214 +01:00 [DBG] Start key discovery request
2019-02-24 21:38:53.643 +01:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-02-24 21:38:53.644 +01:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-02-24 21:38:53.644 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-02-24 21:38:53.644 +01:00 [DBG] Starting introspection request.
2019-02-24 21:38:53.644 +01:00 [DBG] Start parsing Basic Authentication secret
2019-02-24 21:38:53.644 +01:00 [DBG] Start parsing for secret in post body
2019-02-24 21:38:53.644 +01:00 [DBG] Parser found secret: PostBodySecretParser
2019-02-24 21:38:53.644 +01:00 [DBG] Secret id found: api1
2019-02-24 21:38:53.644 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-02-24 21:38:53.644 +01:00 [DBG] API resource validation success
2019-02-24 21:38:53.644 +01:00 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "api1",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLKQH92VR6TO:00000001",
  "TimeStamp": "2019-02-24T20:38:53Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:38:53.644 +01:00 [DBG] Introspection request validation started.
2019-02-24 21:38:53.660 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:38:53.660 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:38:53.663 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-02-24 21:38:53.663 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "c408aba7ed1af0db67c4ffe3044d3fc2db31bfd66c6fb7fb621c3f89df2ff24b",
  "Claims": {
    "iss": "http://localhost:49670",
    "nbf": 1551040730,
    "exp": 1551044330,
    "aud": [
      "http://localhost:49670/resources",
      "api1"
    ],
    "client_id": "spa",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551040730,
    "idp": "local",
    "amr": "pwd"
  }
}
2019-02-24 21:38:53.663 +01:00 [DBG] Introspection request validation successful.
2019-02-24 21:38:53.663 +01:00 [DBG] Creating introspection response for active token.
2019-02-24 21:38:53.663 +01:00 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "api1",
  "IsActive": true,
  "Token": "****f24b",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "ActivityId": "0HLKQH92VR6TO:00000001",
  "TimeStamp": "2019-02-24T20:38:53Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:38:53.663 +01:00 [INF] Success token introspection. Token active: true, for API name: api1
2019-02-24 21:38:57.584 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:38:57.584 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:38:57.584 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:38:57.584 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:38:57.585 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:38:57.585 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:38:57.585 +01:00 [DBG] Start discovery request
2019-02-24 21:38:57.661 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:38:57.662 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:38:57.662 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:38:57.663 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:38:57.664 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:38:57.664 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:38:57.664 +01:00 [DBG] Start key discovery request
2019-02-24 21:38:57.668 +01:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-02-24 21:38:57.668 +01:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-02-24 21:38:57.669 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-02-24 21:38:57.669 +01:00 [DBG] Starting introspection request.
2019-02-24 21:38:57.669 +01:00 [DBG] Start parsing Basic Authentication secret
2019-02-24 21:38:57.669 +01:00 [DBG] Start parsing for secret in post body
2019-02-24 21:38:57.669 +01:00 [DBG] Parser found secret: PostBodySecretParser
2019-02-24 21:38:57.669 +01:00 [DBG] Secret id found: api1
2019-02-24 21:38:57.669 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-02-24 21:38:57.669 +01:00 [DBG] API resource validation success
2019-02-24 21:38:57.669 +01:00 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "api1",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLKQH92VR6TO:00000002",
  "TimeStamp": "2019-02-24T20:38:57Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:38:57.669 +01:00 [DBG] Introspection request validation started.
2019-02-24 21:38:57.688 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:38:57.689 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:38:57.691 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-02-24 21:38:57.691 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "c408aba7ed1af0db67c4ffe3044d3fc2db31bfd66c6fb7fb621c3f89df2ff24b",
  "Claims": {
    "iss": "http://localhost:49670",
    "nbf": 1551040730,
    "exp": 1551044330,
    "aud": [
      "http://localhost:49670/resources",
      "api1"
    ],
    "client_id": "spa",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551040730,
    "idp": "local",
    "amr": "pwd"
  }
}
2019-02-24 21:38:57.691 +01:00 [DBG] Introspection request validation successful.
2019-02-24 21:38:57.691 +01:00 [DBG] Creating introspection response for active token.
2019-02-24 21:38:57.692 +01:00 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "api1",
  "IsActive": true,
  "Token": "****f24b",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "ActivityId": "0HLKQH92VR6TO:00000002",
  "TimeStamp": "2019-02-24T20:38:57Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:38:57.692 +01:00 [INF] Success token introspection. Token active: true, for API name: api1
2019-02-24 21:39:08.116 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:39:08.116 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:39:08.116 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:39:08.116 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:39:08.117 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:39:08.117 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:39:08.117 +01:00 [DBG] Start discovery request
2019-02-24 21:39:08.195 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:39:08.196 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:39:08.196 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:39:08.196 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:39:08.196 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:39:08.197 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:39:08.197 +01:00 [DBG] Start key discovery request
2019-02-24 21:39:08.201 +01:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-02-24 21:39:08.202 +01:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-02-24 21:39:08.202 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-02-24 21:39:08.202 +01:00 [DBG] Starting introspection request.
2019-02-24 21:39:08.202 +01:00 [DBG] Start parsing Basic Authentication secret
2019-02-24 21:39:08.202 +01:00 [DBG] Start parsing for secret in post body
2019-02-24 21:39:08.202 +01:00 [DBG] Parser found secret: PostBodySecretParser
2019-02-24 21:39:08.202 +01:00 [DBG] Secret id found: api1
2019-02-24 21:39:08.202 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-02-24 21:39:08.202 +01:00 [DBG] API resource validation success
2019-02-24 21:39:08.203 +01:00 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "api1",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLKQH92VR6TO:00000003",
  "TimeStamp": "2019-02-24T20:39:08Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:39:08.203 +01:00 [DBG] Introspection request validation started.
2019-02-24 21:39:08.227 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:39:08.227 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:39:08.231 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-02-24 21:39:08.231 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "c408aba7ed1af0db67c4ffe3044d3fc2db31bfd66c6fb7fb621c3f89df2ff24b",
  "Claims": {
    "iss": "http://localhost:49670",
    "nbf": 1551040730,
    "exp": 1551044330,
    "aud": [
      "http://localhost:49670/resources",
      "api1"
    ],
    "client_id": "spa",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551040730,
    "idp": "local",
    "amr": "pwd"
  }
}
2019-02-24 21:39:08.231 +01:00 [DBG] Introspection request validation successful.
2019-02-24 21:39:08.232 +01:00 [DBG] Creating introspection response for active token.
2019-02-24 21:39:08.232 +01:00 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "api1",
  "IsActive": true,
  "Token": "****f24b",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "ActivityId": "0HLKQH92VR6TO:00000003",
  "TimeStamp": "2019-02-24T20:39:08Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:39:08.232 +01:00 [INF] Success token introspection. Token active: true, for API name: api1
2019-02-24 21:39:14.535 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:39:14.535 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:39:14.535 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:39:14.535 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:39:14.536 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:39:14.536 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:39:14.536 +01:00 [DBG] Start discovery request
2019-02-24 21:39:14.639 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:39:14.640 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:39:14.640 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:39:14.642 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:39:14.642 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:39:14.642 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:39:14.642 +01:00 [DBG] Start key discovery request
2019-02-24 21:39:15.902 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:39:15.902 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:39:15.902 +01:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-02-24 21:39:15.903 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-02-24 21:39:15.903 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-02-24 21:39:15.903 +01:00 [DBG] Processing signout request for 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:39:15.903 +01:00 [DBG] Start end session request validation
2019-02-24 21:39:15.903 +01:00 [DBG] Start identity token validation
2019-02-24 21:39:15.903 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:39:15.903 +01:00 [DBG] Client found: spa / SPA Client
2019-02-24 21:39:15.911 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-02-24 21:39:15.911 +01:00 [DBG] Token validation success
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1551040730,
    "exp": 1551041030,
    "iss": "http://localhost:49670",
    "aud": "spa",
    "nonce": "R7vxTBCKEcBvdJtWYz5J367xCAPDewMEmTt8H8aO",
    "iat": 1551040730,
    "at_hash": "Q5oxEcDWHDrfDdDHvJ9nLg",
    "sid": "c31e487c9a43ce409c1f74bfe7243633",
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551040730,
    "idp": "local",
    "name": "Administrator",
    "website": "https://example.org",
    "preferred_username": "admin",
    "amr": "pwd"
  }
}
2019-02-24 21:39:15.911 +01:00 [INF] End session request validation failure: Invalid post logout URI
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjQzZmNkNmY1ZmI2MDgwMmYzMjA2OTNjZGY1M2JmYjc3IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NTEwNDA3MzAsImV4cCI6MTU1MTA0MTAzMCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo0OTY3MCIsImF1ZCI6InNwYSIsIm5vbmNlIjoiUjd2eFRCQ0tFY0J2ZEp0V1l6NUozNjd4Q0FQRGV3TUVtVHQ4SDhhTyIsImlhdCI6MTU1MTA0MDczMCwiYXRfaGFzaCI6IlE1b3hFY0RXSERyZkRkREh2SjluTGciLCJzaWQiOiJjMzFlNDg3YzlhNDNjZTQwOWMxZjc0YmZlNzI0MzYzMyIsInN1YiI6IjM5ZDU2OWFmLTk3NjYtNGE0MS1hOTNhLWZlYTc2Nzc5ZjlmNCIsImF1dGhfdGltZSI6MTU1MTA0MDczMCwiaWRwIjoibG9jYWwiLCJuYW1lIjoiQWRtaW5pc3RyYXRvciIsIndlYnNpdGUiOiJodHRwczovL2V4YW1wbGUub3JnIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiYWRtaW4iLCJhbXIiOlsicHdkIl19.rnuJBEE7IiuDgcnIfsOijlz8zf7jWk6HFgwYcqYhsInZDbaZZYtgxv2YDMY4eoJhZ-k91bvFbt1zwtpQoUvqZzIHdVMH1gD06zaAHQGs6_6L3bVs3JbtpiJaI68AwtxWUy0V0CHcBLCxM71ILU58I24Uqsgbl_cWiPyslUL3q-EGnJKH5HlmkkBkISUmSUq1Su2vELbBAya0WYGG2W4TeJQU-PltwHNSnHXJt-Qrv6OHff1nm7WamR1XBgDUuE724EI2qK70LtxN9W9ff3DMJ2r1ZzFUOG_W17H9SAH84Pw60qOh9PNhA1ZoO-1uNyHq-BGiKPeMlA9zw2pjYpypsw",
    "post_logout_redirect_uri": "http://localhost:4200/home"
  }
}
2019-02-24 21:39:15.911 +01:00 [ERR] Error processing end session request Invalid request
2019-02-24 21:39:15.918 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:39:15.918 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:39:16.932 +01:00 [DBG] CORS request made for path: /account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 21:39:16.933 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:39:16.933 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:39:16.933 +01:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-02-24 21:39:16.934 +01:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-02-24 21:39:16.934 +01:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-02-24 21:39:16.934 +01:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "Administrator",
  "ActivityId": "0HLKQH92VR6TR:00000003",
  "TimeStamp": "2019-02-24T20:39:16Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:39:16.973 +01:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-02-24 21:39:16.974 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-02-24 21:39:16.975 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-02-24 21:39:16.975 +01:00 [DBG] Processing signout callback request
2019-02-24 21:39:16.975 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:39:16.975 +01:00 [DBG] No client front-channel logout URLs
2019-02-24 21:39:16.975 +01:00 [DBG] No client back-channel logout URLs
2019-02-24 21:39:16.975 +01:00 [INF] Successful signout callback.
2019-02-24 21:39:16.975 +01:00 [DBG] No client front-channel iframe urls
2019-02-24 21:39:16.975 +01:00 [DBG] No client back-channel iframe urls
2019-02-24 21:44:11.282 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:44:11.282 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:44:11.283 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:44:11.283 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:44:11.283 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:44:11.283 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:44:11.283 +01:00 [DBG] Start discovery request
2019-02-24 21:44:11.364 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:44:11.364 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:44:11.365 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:44:11.365 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:44:11.365 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:44:11.365 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:44:11.365 +01:00 [DBG] Start key discovery request
2019-02-24 21:44:23.873 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 21:44:23.874 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 21:44:23.874 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 21:44:23.874 +01:00 [DBG] Start authorize request
2019-02-24 21:44:23.874 +01:00 [DBG] No user present in authorize request
2019-02-24 21:44:23.874 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:44:23.874 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:44:23.874 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:44:23.874 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "ttWzGx2eTijxJVODyRTrEcEjXPxHvkyBHXmrxhr7",
  "Nonce": "ttWzGx2eTijxJVODyRTrEcEjXPxHvkyBHXmrxhr7",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "ttWzGx2eTijxJVODyRTrEcEjXPxHvkyBHXmrxhr7",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "ttWzGx2eTijxJVODyRTrEcEjXPxHvkyBHXmrxhr7"
  }
}
2019-02-24 21:44:23.874 +01:00 [INF] Showing login: User is not authenticated
2019-02-24 21:44:23.884 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:44:23.884 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:44:23.885 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:44:23.885 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:44:27.890 +01:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 21:44:27.921 +01:00 [DBG] Augmenting SignInContext
2019-02-24 21:44:27.921 +01:00 [DBG] Adding idp claim with value: local
2019-02-24 21:44:27.921 +01:00 [DBG] Adding amr claim with value: pwd
2019-02-24 21:44:27.921 +01:00 [DBG] Adding auth_time claim with value: 1551041067
2019-02-24 21:44:27.921 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-02-24 21:44:27.922 +01:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "admin",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "admin",
  "Endpoint": "UI",
  "ActivityId": "0HLKQH92VR6TT:00000003",
  "TimeStamp": "2019-02-24T20:44:27Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:44:27.928 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:44:27.928 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 21:44:27.928 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-24 21:44:27.928 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-24 21:44:27.928 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-24 21:44:27.928 +01:00 [DBG] Start authorize callback request
2019-02-24 21:44:27.928 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:44:27.929 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 21:44:27.929 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:44:27.929 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 21:44:27.929 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "ttWzGx2eTijxJVODyRTrEcEjXPxHvkyBHXmrxhr7",
  "Nonce": "ttWzGx2eTijxJVODyRTrEcEjXPxHvkyBHXmrxhr7",
  "SessionId": "cd84a1919420a5e12a54764a93956520",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "ttWzGx2eTijxJVODyRTrEcEjXPxHvkyBHXmrxhr7",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "ttWzGx2eTijxJVODyRTrEcEjXPxHvkyBHXmrxhr7"
  }
}
2019-02-24 21:44:27.937 +01:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-02-24 21:44:27.937 +01:00 [DBG] Creating Implicit Flow response.
2019-02-24 21:44:27.937 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-24 21:44:27.937 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 21:44:27.952 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-24 21:44:27.963 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****XQ5g"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****ba4e"
    }
  ],
  "ActivityId": "0HLKQH92VR6TT:00000004",
  "TimeStamp": "2019-02-24T20:44:27Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:44:27.963 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "ttWzGx2eTijxJVODyRTrEcEjXPxHvkyBHXmrxhr7",
  "Scope": "openid profile api1"
}
2019-02-24 21:44:27.963 +01:00 [DBG] Augmenting SignInContext
2019-02-24 21:44:27.963 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-02-24 21:44:29.083 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 21:44:29.083 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:44:29.083 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:44:29.084 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 21:44:29.084 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 21:44:29.084 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 21:44:29.084 +01:00 [DBG] Start discovery request
2019-02-24 21:44:29.167 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 21:44:29.167 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 21:44:29.167 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 21:44:29.167 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 21:44:29.167 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 21:44:29.167 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 21:44:29.167 +01:00 [DBG] Start key discovery request
2019-02-24 21:44:31.769 +01:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-02-24 21:44:31.769 +01:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-02-24 21:44:31.769 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-02-24 21:44:31.769 +01:00 [DBG] Starting introspection request.
2019-02-24 21:44:31.769 +01:00 [DBG] Start parsing Basic Authentication secret
2019-02-24 21:44:31.769 +01:00 [DBG] Start parsing for secret in post body
2019-02-24 21:44:31.769 +01:00 [DBG] Parser found secret: PostBodySecretParser
2019-02-24 21:44:31.769 +01:00 [DBG] Secret id found: api1
2019-02-24 21:44:31.770 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-02-24 21:44:31.770 +01:00 [DBG] API resource validation success
2019-02-24 21:44:31.770 +01:00 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "api1",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLKQH92VR6TV:00000001",
  "TimeStamp": "2019-02-24T20:44:31Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:44:31.770 +01:00 [DBG] Introspection request validation started.
2019-02-24 21:44:31.782 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:44:31.783 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 21:44:31.785 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-02-24 21:44:31.785 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "382dd961539d8390412fd0fb4a44444f2c31c99e5a833581996468752177ba4e",
  "Claims": {
    "iss": "http://localhost:49670",
    "nbf": 1551041067,
    "exp": 1551044667,
    "aud": [
      "http://localhost:49670/resources",
      "api1"
    ],
    "client_id": "spa",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551041067,
    "idp": "local",
    "amr": "pwd"
  }
}
2019-02-24 21:44:31.785 +01:00 [DBG] Introspection request validation successful.
2019-02-24 21:44:31.785 +01:00 [DBG] Creating introspection response for active token.
2019-02-24 21:44:31.785 +01:00 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "api1",
  "IsActive": true,
  "Token": "****ba4e",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "ActivityId": "0HLKQH92VR6TV:00000001",
  "TimeStamp": "2019-02-24T20:44:31Z",
  "ProcessId": 9112,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 21:44:31.785 +01:00 [INF] Success token introspection. Token active: true, for API name: api1
2019-02-24 22:07:30.520 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-24 22:07:30.570 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-24 22:07:30.574 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-24 22:07:30.575 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-24 22:07:30.575 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-24 22:07:30.576 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-24 22:07:45.420 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 22:07:45.433 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:07:45.433 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:07:45.633 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 22:07:45.843 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 22:07:45.843 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 22:07:45.848 +01:00 [DBG] Start discovery request
2019-02-24 22:07:46.069 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 22:07:46.069 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:07:46.069 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:07:46.070 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 22:07:46.072 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 22:07:46.072 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 22:07:46.083 +01:00 [DBG] Start key discovery request
2019-02-24 22:07:54.271 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:07:54.274 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:07:54.275 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 22:07:54.282 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 22:07:54.282 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 22:07:54.287 +01:00 [DBG] Start authorize request
2019-02-24 22:07:54.315 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 22:07:54.327 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 22:07:54.347 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:07:54.413 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 22:07:54.435 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "hAbTFBKXBXJU1NNf7p6SJfoV91Q1WfvGNmfiXXVJ",
  "Nonce": "hAbTFBKXBXJU1NNf7p6SJfoV91Q1WfvGNmfiXXVJ",
  "SessionId": "cd84a1919420a5e12a54764a93956520",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "hAbTFBKXBXJU1NNf7p6SJfoV91Q1WfvGNmfiXXVJ",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "hAbTFBKXBXJU1NNf7p6SJfoV91Q1WfvGNmfiXXVJ"
  }
}
2019-02-24 22:07:56.114 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 22:07:56.115 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 22:07:56.115 +01:00 [INF] Showing consent: User has not yet consented
2019-02-24 22:07:56.137 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:07:56.137 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:07:56.650 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 22:07:56.652 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:07:56.652 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 22:07:56.654 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:08:13.703 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 22:08:13.705 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:08:13.705 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:08:13.879 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 22:08:13.879 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:08:13.880 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 22:08:13.941 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:08:13.941 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:08:13.941 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-24 22:08:13.942 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-24 22:08:13.942 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-24 22:08:13.948 +01:00 [DBG] Start authorize callback request
2019-02-24 22:08:13.990 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 22:08:13.990 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 22:08:13.990 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:08:13.990 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 22:08:13.990 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "hAbTFBKXBXJU1NNf7p6SJfoV91Q1WfvGNmfiXXVJ",
  "Nonce": "hAbTFBKXBXJU1NNf7p6SJfoV91Q1WfvGNmfiXXVJ",
  "SessionId": "cd84a1919420a5e12a54764a93956520",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "hAbTFBKXBXJU1NNf7p6SJfoV91Q1WfvGNmfiXXVJ",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "hAbTFBKXBXJU1NNf7p6SJfoV91Q1WfvGNmfiXXVJ"
  }
}
2019-02-24 22:08:14.004 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 22:08:14.004 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 22:08:14.016 +01:00 [INF] User consented to scopes: ["openid","profile","api1"]
2019-02-24 22:08:14.032 +01:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 22:08:14.045 +01:00 [DBG] Creating Implicit Flow response.
2019-02-24 22:08:14.060 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-24 22:08:14.061 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 22:08:14.496 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-24 22:08:14.558 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****vbjA"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****0LWg"
    }
  ],
  "ActivityId": "0HLKQJGFM383I:00000002",
  "TimeStamp": "2019-02-24T21:08:14Z",
  "ProcessId": 992,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 22:08:14.563 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "hAbTFBKXBXJU1NNf7p6SJfoV91Q1WfvGNmfiXXVJ",
  "Scope": "openid profile api1"
}
2019-02-24 22:08:15.675 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 22:08:15.675 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:08:15.675 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:08:15.675 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 22:08:15.676 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 22:08:15.676 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 22:08:15.676 +01:00 [DBG] Start discovery request
2019-02-24 22:08:15.761 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 22:08:15.761 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:08:15.761 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:08:15.761 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 22:08:15.762 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 22:08:15.762 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 22:08:15.762 +01:00 [DBG] Start key discovery request
2019-02-24 22:11:33.278 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 22:11:33.278 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:11:33.278 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:11:33.279 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 22:11:33.279 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 22:11:33.279 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 22:11:33.279 +01:00 [DBG] Start discovery request
2019-02-24 22:11:33.364 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 22:11:33.364 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:11:33.364 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:11:33.365 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 22:11:33.365 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 22:11:33.365 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 22:11:33.365 +01:00 [DBG] Start key discovery request
2019-02-24 22:12:01.211 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 22:12:01.211 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:12:01.211 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:12:01.212 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 22:12:01.212 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 22:12:01.212 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 22:12:01.212 +01:00 [DBG] Start discovery request
2019-02-24 22:12:01.289 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 22:12:01.289 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:12:01.289 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:12:01.292 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 22:12:01.292 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 22:12:01.292 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 22:12:01.292 +01:00 [DBG] Start key discovery request
2019-02-24 22:12:01.530 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 22:12:01.530 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 22:12:01.530 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 22:12:01.530 +01:00 [DBG] Start discovery request
2019-02-24 22:12:01.695 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 22:12:01.695 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 22:12:01.695 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 22:12:01.695 +01:00 [DBG] Start key discovery request
2019-02-24 22:15:56.333 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 22:15:56.333 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:15:56.333 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:15:56.333 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 22:15:56.333 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 22:15:56.333 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 22:15:56.333 +01:00 [DBG] Start discovery request
2019-02-24 22:15:56.430 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 22:15:56.430 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:15:56.430 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:15:56.431 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 22:15:56.431 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 22:15:56.431 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 22:15:56.431 +01:00 [DBG] Start key discovery request
2019-02-24 22:16:01.459 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 22:16:01.459 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:16:01.459 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:16:01.460 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 22:16:01.460 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 22:16:01.460 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 22:16:01.460 +01:00 [DBG] Start discovery request
2019-02-24 22:16:01.579 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 22:16:01.580 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:16:01.580 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:16:01.580 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 22:16:01.581 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 22:16:01.581 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 22:16:01.581 +01:00 [DBG] Start key discovery request
2019-02-24 22:16:10.560 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 22:16:10.560 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:16:10.560 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:16:10.560 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 22:16:10.560 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 22:16:10.560 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 22:16:10.560 +01:00 [DBG] Start discovery request
2019-02-24 22:16:10.642 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 22:16:10.642 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:16:10.642 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:16:10.643 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 22:16:10.643 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 22:16:10.643 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 22:16:10.643 +01:00 [DBG] Start key discovery request
2019-02-24 22:16:21.359 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 22:16:21.359 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:16:21.359 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:16:21.360 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 22:16:21.360 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 22:16:21.360 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 22:16:21.360 +01:00 [DBG] Start discovery request
2019-02-24 22:16:21.443 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 22:16:21.443 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:16:21.443 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:16:21.443 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 22:16:21.443 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 22:16:21.443 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 22:16:21.443 +01:00 [DBG] Start key discovery request
2019-02-24 22:16:28.156 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 22:16:28.157 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:16:28.157 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:16:28.157 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 22:16:28.157 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 22:16:28.157 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 22:16:28.157 +01:00 [DBG] Start discovery request
2019-02-24 22:16:28.263 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 22:16:28.263 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:16:28.264 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:16:28.264 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 22:16:28.264 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 22:16:28.264 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 22:16:28.264 +01:00 [DBG] Start key discovery request
2019-02-24 22:16:31.048 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 22:16:31.048 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:16:31.048 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:16:31.048 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 22:16:31.049 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 22:16:31.049 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 22:16:31.049 +01:00 [DBG] Start discovery request
2019-02-24 22:16:31.157 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 22:16:31.157 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:16:31.157 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:16:31.157 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 22:16:31.158 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 22:16:31.158 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 22:16:31.158 +01:00 [DBG] Start key discovery request
2019-02-24 22:16:44.678 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 22:16:44.678 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:16:44.679 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:16:44.679 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 22:16:44.679 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 22:16:44.679 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 22:16:44.679 +01:00 [DBG] Start discovery request
2019-02-24 22:16:44.758 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 22:16:44.758 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:16:44.758 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:16:44.758 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 22:16:44.759 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 22:16:44.759 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 22:16:44.759 +01:00 [DBG] Start key discovery request
2019-02-24 22:16:45.917 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:16:45.917 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:16:45.917 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 22:16:45.917 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 22:16:45.917 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 22:16:45.917 +01:00 [DBG] Start authorize request
2019-02-24 22:16:45.918 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 22:16:45.918 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 22:16:45.918 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:16:45.918 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 22:16:45.918 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "TKzoJCiNvZ3d5hJ2E001YTItnPoxy1vkjfhOtBNf",
  "Nonce": "TKzoJCiNvZ3d5hJ2E001YTItnPoxy1vkjfhOtBNf",
  "SessionId": "cd84a1919420a5e12a54764a93956520",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "TKzoJCiNvZ3d5hJ2E001YTItnPoxy1vkjfhOtBNf",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "TKzoJCiNvZ3d5hJ2E001YTItnPoxy1vkjfhOtBNf"
  }
}
2019-02-24 22:16:45.918 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 22:16:45.918 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 22:16:45.918 +01:00 [INF] Showing consent: User has not yet consented
2019-02-24 22:16:45.950 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:16:45.950 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:16:45.951 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 22:16:45.952 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:16:45.952 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 22:16:45.952 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:16:48.388 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 22:16:48.389 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:16:48.389 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:16:48.390 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 22:16:48.390 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:16:48.391 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 22:16:48.401 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:16:48.402 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:16:48.402 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-24 22:16:48.402 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-24 22:16:48.402 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-24 22:16:48.402 +01:00 [DBG] Start authorize callback request
2019-02-24 22:16:48.403 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 22:16:48.403 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 22:16:48.403 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:16:48.404 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 22:16:48.404 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "TKzoJCiNvZ3d5hJ2E001YTItnPoxy1vkjfhOtBNf",
  "Nonce": "TKzoJCiNvZ3d5hJ2E001YTItnPoxy1vkjfhOtBNf",
  "SessionId": "cd84a1919420a5e12a54764a93956520",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "TKzoJCiNvZ3d5hJ2E001YTItnPoxy1vkjfhOtBNf",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "TKzoJCiNvZ3d5hJ2E001YTItnPoxy1vkjfhOtBNf"
  }
}
2019-02-24 22:16:48.406 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 22:16:48.406 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 22:16:48.406 +01:00 [INF] User consented to scopes: ["openid","profile","api1"]
2019-02-24 22:16:48.407 +01:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 22:16:48.407 +01:00 [DBG] Creating Implicit Flow response.
2019-02-24 22:16:48.407 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-24 22:16:48.407 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 22:16:48.419 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-24 22:16:48.431 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****bUqQ"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****huCw"
    }
  ],
  "ActivityId": "0HLKQJGFM383U:00000002",
  "TimeStamp": "2019-02-24T21:16:48Z",
  "ProcessId": 992,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 22:16:48.431 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "TKzoJCiNvZ3d5hJ2E001YTItnPoxy1vkjfhOtBNf",
  "Scope": "openid profile api1"
}
2019-02-24 22:16:49.489 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 22:16:49.489 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:16:49.490 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:16:49.490 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 22:16:49.490 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 22:16:49.490 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 22:16:49.490 +01:00 [DBG] Start discovery request
2019-02-24 22:16:49.567 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 22:16:49.567 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:16:49.567 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:16:49.567 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 22:16:49.568 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 22:16:49.568 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 22:16:49.568 +01:00 [DBG] Start key discovery request
2019-02-24 22:28:43.750 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-24 22:28:43.800 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-24 22:28:43.805 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-24 22:28:43.805 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-24 22:28:43.806 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-24 22:28:43.806 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-24 22:28:57.257 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 22:28:57.269 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:28:57.269 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:28:57.414 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 22:28:57.617 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 22:28:57.617 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 22:28:57.622 +01:00 [DBG] Start discovery request
2019-02-24 22:28:57.836 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 22:28:57.836 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:28:57.836 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:28:57.837 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 22:28:57.839 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 22:28:57.839 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 22:28:57.857 +01:00 [DBG] Start key discovery request
2019-02-24 22:28:58.617 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:28:58.619 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:28:58.620 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 22:28:58.625 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 22:28:58.625 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 22:28:58.630 +01:00 [DBG] Start authorize request
2019-02-24 22:28:58.651 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 22:28:58.658 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 22:28:58.675 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:28:58.731 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 22:28:58.753 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "XMS0DOX707nmabdItkDHowd9j0hmW1KMGEzLYxiI",
  "Nonce": "XMS0DOX707nmabdItkDHowd9j0hmW1KMGEzLYxiI",
  "SessionId": "cd84a1919420a5e12a54764a93956520",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "XMS0DOX707nmabdItkDHowd9j0hmW1KMGEzLYxiI",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "XMS0DOX707nmabdItkDHowd9j0hmW1KMGEzLYxiI"
  }
}
2019-02-24 22:29:00.378 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 22:29:00.379 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 22:29:00.379 +01:00 [INF] Showing consent: User has not yet consented
2019-02-24 22:29:00.400 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:29:00.400 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:29:00.918 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 22:29:00.920 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:29:00.921 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 22:29:00.923 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:29:20.215 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 22:29:20.216 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:29:20.217 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:29:20.398 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 22:29:20.398 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:29:20.399 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 22:29:20.462 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:29:20.463 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:29:20.463 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-24 22:29:20.463 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-24 22:29:20.464 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-24 22:29:20.471 +01:00 [DBG] Start authorize callback request
2019-02-24 22:29:20.512 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 22:29:20.512 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 22:29:20.512 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:29:20.512 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 22:29:20.512 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "XMS0DOX707nmabdItkDHowd9j0hmW1KMGEzLYxiI",
  "Nonce": "XMS0DOX707nmabdItkDHowd9j0hmW1KMGEzLYxiI",
  "SessionId": "cd84a1919420a5e12a54764a93956520",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "XMS0DOX707nmabdItkDHowd9j0hmW1KMGEzLYxiI",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "XMS0DOX707nmabdItkDHowd9j0hmW1KMGEzLYxiI"
  }
}
2019-02-24 22:29:20.528 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 22:29:20.528 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 22:29:20.541 +01:00 [INF] User consented to scopes: ["openid","profile","api1"]
2019-02-24 22:29:20.554 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1"]
2019-02-24 22:29:20.559 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 22:29:20.587 +01:00 [DBG] Creating Implicit Flow response.
2019-02-24 22:29:20.603 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-24 22:29:20.604 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 22:29:21.050 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-24 22:29:21.107 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****23ew"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****0_4g"
    }
  ],
  "ActivityId": "0HLKQJSANBOMR:00000007",
  "TimeStamp": "2019-02-24T21:29:21Z",
  "ProcessId": 1264,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 22:29:21.113 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "XMS0DOX707nmabdItkDHowd9j0hmW1KMGEzLYxiI",
  "Scope": "openid profile api1"
}
2019-02-24 22:29:22.227 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 22:29:22.228 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:29:22.228 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:29:22.228 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 22:29:22.228 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 22:29:22.228 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 22:29:22.228 +01:00 [DBG] Start discovery request
2019-02-24 22:29:22.316 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 22:29:22.316 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:29:22.316 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:29:22.316 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 22:29:22.317 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 22:29:22.317 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 22:29:22.317 +01:00 [DBG] Start key discovery request
2019-02-24 22:29:25.025 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 22:29:25.026 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 22:29:25.026 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 22:29:25.026 +01:00 [DBG] Start discovery request
2019-02-24 22:29:25.148 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 22:29:25.148 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 22:29:25.148 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 22:29:25.148 +01:00 [DBG] Start key discovery request
2019-02-24 22:43:46.416 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-24 22:43:46.469 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-24 22:43:46.475 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-24 22:43:46.476 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-24 22:43:46.476 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-24 22:43:46.477 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-24 22:46:24.254 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 22:46:24.268 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:46:24.268 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:46:24.436 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 22:46:24.618 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 22:46:24.618 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 22:46:24.623 +01:00 [DBG] Start discovery request
2019-02-24 22:46:24.829 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 22:46:24.829 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:46:24.829 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:46:24.830 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 22:46:24.832 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 22:46:24.832 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 22:46:24.837 +01:00 [DBG] Start key discovery request
2019-02-24 22:46:25.852 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:46:25.854 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:46:25.855 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 22:46:25.861 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 22:46:25.861 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 22:46:25.866 +01:00 [DBG] Start authorize request
2019-02-24 22:46:25.890 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 22:46:25.898 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 22:46:25.914 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:46:25.973 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 22:46:25.994 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "69SdQQqfPDpEf75vtg3RXMMayZD0l12EYzqHi8MN",
  "Nonce": "69SdQQqfPDpEf75vtg3RXMMayZD0l12EYzqHi8MN",
  "SessionId": "cd84a1919420a5e12a54764a93956520",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "69SdQQqfPDpEf75vtg3RXMMayZD0l12EYzqHi8MN",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "69SdQQqfPDpEf75vtg3RXMMayZD0l12EYzqHi8MN"
  }
}
2019-02-24 22:46:27.616 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 22:46:27.616 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 22:46:27.616 +01:00 [INF] Showing consent: User has not yet consented
2019-02-24 22:46:27.638 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:46:27.638 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:46:28.154 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 22:46:28.156 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:46:28.157 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 22:46:28.159 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:46:40.296 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 22:46:40.297 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:46:40.297 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:46:40.473 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 22:46:40.473 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:46:40.473 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 22:46:40.537 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:46:40.537 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:46:40.538 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-24 22:46:40.538 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-24 22:46:40.538 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-24 22:46:40.545 +01:00 [DBG] Start authorize callback request
2019-02-24 22:46:40.588 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 22:46:40.588 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 22:46:40.588 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:46:40.589 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 22:46:40.589 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "69SdQQqfPDpEf75vtg3RXMMayZD0l12EYzqHi8MN",
  "Nonce": "69SdQQqfPDpEf75vtg3RXMMayZD0l12EYzqHi8MN",
  "SessionId": "cd84a1919420a5e12a54764a93956520",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "69SdQQqfPDpEf75vtg3RXMMayZD0l12EYzqHi8MN",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "69SdQQqfPDpEf75vtg3RXMMayZD0l12EYzqHi8MN"
  }
}
2019-02-24 22:46:40.603 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 22:46:40.603 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 22:46:40.616 +01:00 [INF] User consented to scopes: ["openid","profile","api1"]
2019-02-24 22:46:40.633 +01:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 22:46:40.646 +01:00 [DBG] Creating Implicit Flow response.
2019-02-24 22:46:40.660 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-24 22:46:40.661 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 22:46:41.104 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-24 22:46:41.168 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****5VEg"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****V6IQ"
    }
  ],
  "ActivityId": "0HLKQK62O27GD:00000004",
  "TimeStamp": "2019-02-24T21:46:41Z",
  "ProcessId": 4072,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 22:46:41.174 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "69SdQQqfPDpEf75vtg3RXMMayZD0l12EYzqHi8MN",
  "Scope": "openid profile api1"
}
2019-02-24 22:46:41.906 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 22:46:41.907 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:46:41.907 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:46:41.907 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 22:46:41.907 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 22:46:41.908 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 22:46:41.908 +01:00 [DBG] Start discovery request
2019-02-24 22:46:41.973 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 22:46:41.973 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:46:41.973 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:46:41.973 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 22:46:41.974 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 22:46:41.974 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 22:46:41.974 +01:00 [DBG] Start key discovery request
2019-02-24 22:46:49.578 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 22:46:49.578 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 22:46:49.578 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 22:46:49.578 +01:00 [DBG] Start discovery request
2019-02-24 22:46:49.692 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 22:46:49.692 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 22:46:49.692 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 22:46:49.692 +01:00 [DBG] Start key discovery request
2019-02-24 22:47:58.674 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 22:47:58.674 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:47:58.675 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:47:58.675 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 22:47:58.675 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 22:47:58.675 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 22:47:58.675 +01:00 [DBG] Start discovery request
2019-02-24 22:47:58.779 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 22:47:58.780 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:47:58.780 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:47:58.780 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 22:47:58.780 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 22:47:58.781 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 22:47:58.781 +01:00 [DBG] Start key discovery request
2019-02-24 22:48:00.815 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:48:00.815 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:48:00.815 +01:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-02-24 22:48:00.817 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-02-24 22:48:00.817 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-02-24 22:48:00.822 +01:00 [DBG] Processing signout request for 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 22:48:00.830 +01:00 [DBG] Start end session request validation
2019-02-24 22:48:00.840 +01:00 [DBG] Start identity token validation
2019-02-24 22:48:00.863 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:48:00.863 +01:00 [DBG] Client found: spa / SPA Client
2019-02-24 22:48:00.926 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-02-24 22:48:00.931 +01:00 [DBG] Token validation success
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1551044801,
    "exp": 1551045101,
    "iss": "http://localhost:49670",
    "aud": "spa",
    "nonce": "69SdQQqfPDpEf75vtg3RXMMayZD0l12EYzqHi8MN",
    "iat": 1551044801,
    "at_hash": "pbhP4zZ2j05J0dcKZpbCLA",
    "sid": "cd84a1919420a5e12a54764a93956520",
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551041067,
    "idp": "local",
    "name": "Administrator",
    "website": "https://example.org",
    "preferred_username": "admin",
    "amr": "pwd"
  }
}
2019-02-24 22:48:00.938 +01:00 [INF] End session request validation failure: Invalid post logout URI
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjQzZmNkNmY1ZmI2MDgwMmYzMjA2OTNjZGY1M2JmYjc3IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NTEwNDQ4MDEsImV4cCI6MTU1MTA0NTEwMSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo0OTY3MCIsImF1ZCI6InNwYSIsIm5vbmNlIjoiNjlTZFFRcWZQRHBFZjc1dnRnM1JYTU1heVpEMGwxMkVZenFIaThNTiIsImlhdCI6MTU1MTA0NDgwMSwiYXRfaGFzaCI6InBiaFA0eloyajA1SjBkY0tacGJDTEEiLCJzaWQiOiJjZDg0YTE5MTk0MjBhNWUxMmE1NDc2NGE5Mzk1NjUyMCIsInN1YiI6IjM5ZDU2OWFmLTk3NjYtNGE0MS1hOTNhLWZlYTc2Nzc5ZjlmNCIsImF1dGhfdGltZSI6MTU1MTA0MTA2NywiaWRwIjoibG9jYWwiLCJuYW1lIjoiQWRtaW5pc3RyYXRvciIsIndlYnNpdGUiOiJodHRwczovL2V4YW1wbGUub3JnIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiYWRtaW4iLCJhbXIiOlsicHdkIl19.Qa0CKduLwHsj-P4h6J4GIW3Vp0qyfRs-pKPJSiJDTKbsgMERSzrFqhqAc5aL8-yeQFPp93n9AQl78yJz-nUmzejtnKjx3C_QIeFFA9RmuCfuo2L9ZIdBfIwx9UzXnDjaE5_JvbScfJmFYNZBf9SeYM20JH2p8puvImklHlBbIuVh6SymkbqMxP6-mz6RUuHbbiymrfI07TO_V_Fkz06anHuVpKKiK4olcJCNLrMY1Gp776p1lHo8uJyXbMeRd3h1virgYNt_ISjjTvxSzvjUEV2T-X2G7aXft2HfRUuiH4GIooVYHHVXlBGTYbIUXlILUrqlTw7ZAE1DEqTlhd5VEg",
    "post_logout_redirect_uri": "http://localhost:4200/home"
  }
}
2019-02-24 22:48:00.939 +01:00 [ERR] Error processing end session request Invalid request
2019-02-24 22:48:00.977 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:48:00.978 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:48:01.917 +01:00 [DBG] CORS request made for path: /account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 22:48:01.918 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:48:01.918 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:48:01.967 +01:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-02-24 22:48:01.971 +01:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-02-24 22:48:01.972 +01:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-02-24 22:48:01.979 +01:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "Administrator",
  "ActivityId": "0HLKQK62O27GD:00000007",
  "TimeStamp": "2019-02-24T21:48:01Z",
  "ProcessId": 4072,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 22:48:02.196 +01:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-02-24 22:48:02.199 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-02-24 22:48:02.199 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-02-24 22:48:02.207 +01:00 [DBG] Processing signout callback request
2019-02-24 22:48:02.226 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:48:02.226 +01:00 [DBG] No client front-channel logout URLs
2019-02-24 22:48:02.226 +01:00 [DBG] No client back-channel logout URLs
2019-02-24 22:48:02.227 +01:00 [INF] Successful signout callback.
2019-02-24 22:48:02.227 +01:00 [DBG] No client front-channel iframe urls
2019-02-24 22:48:02.227 +01:00 [DBG] No client back-channel iframe urls
2019-02-24 22:48:05.488 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 22:48:05.488 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:48:05.488 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:48:05.488 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 22:48:05.489 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 22:48:05.489 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 22:48:05.489 +01:00 [DBG] Start discovery request
2019-02-24 22:48:05.577 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 22:48:05.577 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:48:05.577 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:48:05.578 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 22:48:05.578 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 22:48:05.578 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 22:48:05.578 +01:00 [DBG] Start key discovery request
2019-02-24 22:48:06.683 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 22:48:06.684 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 22:48:06.684 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 22:48:06.684 +01:00 [DBG] Start authorize request
2019-02-24 22:48:06.685 +01:00 [DBG] No user present in authorize request
2019-02-24 22:48:06.685 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 22:48:06.686 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:48:06.686 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 22:48:06.687 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "4XUbl7lLKF6HnZM2QRHrFXlv28EwIFQMPLqiXQmw",
  "Nonce": "4XUbl7lLKF6HnZM2QRHrFXlv28EwIFQMPLqiXQmw",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "4XUbl7lLKF6HnZM2QRHrFXlv28EwIFQMPLqiXQmw",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "4XUbl7lLKF6HnZM2QRHrFXlv28EwIFQMPLqiXQmw"
  }
}
2019-02-24 22:48:06.687 +01:00 [INF] Showing login: User is not authenticated
2019-02-24 22:48:06.710 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 22:48:06.710 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:48:06.710 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 22:48:06.713 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:48:10.526 +01:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 22:48:10.674 +01:00 [DBG] Augmenting SignInContext
2019-02-24 22:48:10.676 +01:00 [DBG] Adding idp claim with value: local
2019-02-24 22:48:10.676 +01:00 [DBG] Adding amr claim with value: pwd
2019-02-24 22:48:10.677 +01:00 [DBG] Adding auth_time claim with value: 1551044890
2019-02-24 22:48:10.697 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-02-24 22:48:10.707 +01:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "admin",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "admin",
  "Endpoint": "UI",
  "ActivityId": "0HLKQK62O27GD:0000000B",
  "TimeStamp": "2019-02-24T21:48:10Z",
  "ProcessId": 4072,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 22:48:10.714 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:48:10.714 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:48:10.714 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-24 22:48:10.715 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-24 22:48:10.715 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-24 22:48:10.715 +01:00 [DBG] Start authorize callback request
2019-02-24 22:48:10.715 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 22:48:10.715 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 22:48:10.715 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:48:10.716 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 22:48:10.716 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "4XUbl7lLKF6HnZM2QRHrFXlv28EwIFQMPLqiXQmw",
  "Nonce": "4XUbl7lLKF6HnZM2QRHrFXlv28EwIFQMPLqiXQmw",
  "SessionId": "790646eaa9decf12af6e919f40df9e52",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "4XUbl7lLKF6HnZM2QRHrFXlv28EwIFQMPLqiXQmw",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "4XUbl7lLKF6HnZM2QRHrFXlv28EwIFQMPLqiXQmw"
  }
}
2019-02-24 22:48:10.718 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 22:48:10.718 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 22:48:10.718 +01:00 [INF] Showing consent: User has not yet consented
2019-02-24 22:48:10.724 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:48:10.724 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:48:10.726 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 22:48:10.726 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:48:10.726 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 22:48:10.726 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:48:14.258 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 22:48:14.259 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:48:14.259 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:48:14.260 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 22:48:14.261 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:48:14.261 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 22:48:14.268 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:48:14.269 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 22:48:14.269 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-24 22:48:14.269 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-24 22:48:14.269 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-24 22:48:14.269 +01:00 [DBG] Start authorize callback request
2019-02-24 22:48:14.270 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 22:48:14.270 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 22:48:14.270 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 22:48:14.270 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 22:48:14.270 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "4XUbl7lLKF6HnZM2QRHrFXlv28EwIFQMPLqiXQmw",
  "Nonce": "4XUbl7lLKF6HnZM2QRHrFXlv28EwIFQMPLqiXQmw",
  "SessionId": "790646eaa9decf12af6e919f40df9e52",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "4XUbl7lLKF6HnZM2QRHrFXlv28EwIFQMPLqiXQmw",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "4XUbl7lLKF6HnZM2QRHrFXlv28EwIFQMPLqiXQmw"
  }
}
2019-02-24 22:48:14.273 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 22:48:14.273 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 22:48:14.273 +01:00 [INF] User consented to scopes: ["openid","profile","api1"]
2019-02-24 22:48:14.273 +01:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 22:48:14.273 +01:00 [DBG] Creating Implicit Flow response.
2019-02-24 22:48:14.273 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-24 22:48:14.273 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 22:48:14.284 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-24 22:48:14.296 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****k7Jg"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****T5Lg"
    }
  ],
  "ActivityId": "0HLKQK62O27GD:0000000F",
  "TimeStamp": "2019-02-24T21:48:14Z",
  "ProcessId": 4072,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 22:48:14.296 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "4XUbl7lLKF6HnZM2QRHrFXlv28EwIFQMPLqiXQmw",
  "Scope": "openid profile api1"
}
2019-02-24 22:48:14.304 +01:00 [DBG] Augmenting SignInContext
2019-02-24 22:48:14.304 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-02-24 22:48:15.107 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 22:48:15.108 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:48:15.108 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:48:15.108 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 22:48:15.108 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 22:48:15.108 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 22:48:15.108 +01:00 [DBG] Start discovery request
2019-02-24 22:48:15.211 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 22:48:15.212 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 22:48:15.212 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 22:48:15.212 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 22:48:15.213 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 22:48:15.213 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 22:48:15.213 +01:00 [DBG] Start key discovery request
2019-02-24 23:10:06.192 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-24 23:10:06.282 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-24 23:10:06.287 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-24 23:10:06.288 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-24 23:10:06.288 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-24 23:10:06.289 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-24 23:10:07.827 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:10:07.859 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:10:42.409 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-24 23:10:42.461 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-24 23:10:42.466 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-24 23:10:42.466 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-24 23:10:42.467 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-24 23:10:42.467 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-24 23:11:43.629 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-24 23:11:43.688 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-24 23:11:43.692 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-24 23:11:43.693 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-24 23:11:43.693 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-24 23:11:43.694 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-24 23:13:28.034 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 23:13:28.047 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:13:28.047 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:13:28.238 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 23:13:28.486 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 23:13:28.486 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 23:13:28.491 +01:00 [DBG] Start discovery request
2019-02-24 23:13:28.748 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 23:13:28.748 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:13:28.748 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:13:28.750 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 23:13:28.757 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 23:13:28.757 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 23:13:28.773 +01:00 [DBG] Start key discovery request
2019-02-24 23:13:35.453 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:13:35.455 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:13:35.456 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 23:13:35.462 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 23:13:35.462 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 23:13:35.467 +01:00 [DBG] Start authorize request
2019-02-24 23:13:35.490 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:13:35.497 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:13:35.515 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:13:35.577 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:13:35.600 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "3sxShkllg5JY4hKDFDOA0N4TlUf63Yayk3dmJy3J",
  "Nonce": "3sxShkllg5JY4hKDFDOA0N4TlUf63Yayk3dmJy3J",
  "SessionId": "790646eaa9decf12af6e919f40df9e52",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "3sxShkllg5JY4hKDFDOA0N4TlUf63Yayk3dmJy3J",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "3sxShkllg5JY4hKDFDOA0N4TlUf63Yayk3dmJy3J"
  }
}
2019-02-24 23:13:37.416 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 23:13:37.416 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 23:13:37.416 +01:00 [INF] Showing consent: User has not yet consented
2019-02-24 23:13:37.439 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:13:37.439 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:13:38.043 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:13:38.045 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:13:38.045 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:13:38.047 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:13:50.945 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 23:13:50.946 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:13:50.947 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:13:51.126 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:13:51.127 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:13:51.127 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:13:51.192 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:13:51.192 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:13:51.192 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-24 23:13:51.193 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-24 23:13:51.193 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-24 23:13:51.201 +01:00 [DBG] Start authorize callback request
2019-02-24 23:13:51.247 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:13:51.247 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:13:51.247 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:13:51.247 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:13:51.247 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "3sxShkllg5JY4hKDFDOA0N4TlUf63Yayk3dmJy3J",
  "Nonce": "3sxShkllg5JY4hKDFDOA0N4TlUf63Yayk3dmJy3J",
  "SessionId": "790646eaa9decf12af6e919f40df9e52",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "3sxShkllg5JY4hKDFDOA0N4TlUf63Yayk3dmJy3J",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "3sxShkllg5JY4hKDFDOA0N4TlUf63Yayk3dmJy3J"
  }
}
2019-02-24 23:13:51.263 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 23:13:51.263 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 23:13:51.277 +01:00 [INF] User consented to scopes: ["openid","profile","api1"]
2019-02-24 23:13:51.295 +01:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:13:51.309 +01:00 [DBG] Creating Implicit Flow response.
2019-02-24 23:13:51.325 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-24 23:13:51.325 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:13:51.814 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-24 23:13:51.890 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****G5yA"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****Iijg"
    }
  ],
  "ActivityId": "0HLKQKL6L0VQA:00000002",
  "TimeStamp": "2019-02-24T22:13:51Z",
  "ProcessId": 7232,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 23:13:51.895 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "3sxShkllg5JY4hKDFDOA0N4TlUf63Yayk3dmJy3J",
  "Scope": "openid profile api1"
}
2019-02-24 23:13:53.036 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 23:13:53.036 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:13:53.036 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:13:53.036 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 23:13:53.037 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 23:13:53.037 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 23:13:53.037 +01:00 [DBG] Start discovery request
2019-02-24 23:13:53.129 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 23:13:53.129 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:13:53.129 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:13:53.130 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 23:13:53.130 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 23:13:53.130 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 23:13:53.130 +01:00 [DBG] Start key discovery request
2019-02-24 23:13:57.280 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 23:13:57.281 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 23:13:57.281 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 23:13:57.281 +01:00 [DBG] Start discovery request
2019-02-24 23:13:57.438 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 23:13:57.438 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 23:13:57.438 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 23:13:57.438 +01:00 [DBG] Start key discovery request
2019-02-24 23:23:48.621 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 23:23:48.621 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:23:48.621 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:23:48.622 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 23:23:48.622 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 23:23:48.622 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 23:23:48.622 +01:00 [DBG] Start discovery request
2019-02-24 23:23:48.704 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 23:23:48.705 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:23:48.705 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:23:48.705 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 23:23:48.705 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 23:23:48.705 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 23:23:48.705 +01:00 [DBG] Start key discovery request
2019-02-24 23:23:50.343 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:23:50.343 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:23:50.344 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 23:23:50.344 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 23:23:50.344 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 23:23:50.344 +01:00 [DBG] Start authorize request
2019-02-24 23:23:50.344 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:23:50.344 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:23:50.344 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:23:50.344 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:23:50.344 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "sSgYNKMNXMPNIErJJihswgwtFbc8mjHIxiu6ijlm",
  "Nonce": "sSgYNKMNXMPNIErJJihswgwtFbc8mjHIxiu6ijlm",
  "SessionId": "790646eaa9decf12af6e919f40df9e52",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "sSgYNKMNXMPNIErJJihswgwtFbc8mjHIxiu6ijlm",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "sSgYNKMNXMPNIErJJihswgwtFbc8mjHIxiu6ijlm"
  }
}
2019-02-24 23:23:50.344 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 23:23:50.344 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 23:23:50.345 +01:00 [INF] Showing consent: User has not yet consented
2019-02-24 23:23:50.384 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:23:50.385 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:23:50.386 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:23:50.386 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:23:50.389 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:23:50.389 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:23:52.924 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 23:23:52.925 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:23:52.925 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:23:52.931 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:23:52.932 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:23:52.932 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:23:52.940 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:23:52.940 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:23:52.940 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-24 23:23:52.940 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-24 23:23:52.940 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-24 23:23:52.941 +01:00 [DBG] Start authorize callback request
2019-02-24 23:23:52.941 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:23:52.941 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:23:52.941 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:23:52.941 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:23:52.941 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "sSgYNKMNXMPNIErJJihswgwtFbc8mjHIxiu6ijlm",
  "Nonce": "sSgYNKMNXMPNIErJJihswgwtFbc8mjHIxiu6ijlm",
  "SessionId": "790646eaa9decf12af6e919f40df9e52",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "sSgYNKMNXMPNIErJJihswgwtFbc8mjHIxiu6ijlm",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "sSgYNKMNXMPNIErJJihswgwtFbc8mjHIxiu6ijlm"
  }
}
2019-02-24 23:23:52.944 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 23:23:52.944 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 23:23:52.944 +01:00 [INF] User consented to scopes: ["openid","profile","api1"]
2019-02-24 23:23:52.945 +01:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:23:52.945 +01:00 [DBG] Creating Implicit Flow response.
2019-02-24 23:23:52.945 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-24 23:23:52.945 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:23:52.956 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-24 23:23:52.968 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****oVJg"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****tjTA"
    }
  ],
  "ActivityId": "0HLKQKL6L0VQE:00000004",
  "TimeStamp": "2019-02-24T22:23:52Z",
  "ProcessId": 7232,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-24 23:23:52.968 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "sSgYNKMNXMPNIErJJihswgwtFbc8mjHIxiu6ijlm",
  "Scope": "openid profile api1"
}
2019-02-24 23:23:53.754 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 23:23:53.754 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:23:53.754 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:23:53.754 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 23:23:53.754 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 23:23:53.754 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 23:23:53.754 +01:00 [DBG] Start discovery request
2019-02-24 23:23:53.847 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 23:23:53.847 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:23:53.847 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:23:53.847 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 23:23:53.848 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 23:23:53.848 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 23:23:53.848 +01:00 [DBG] Start key discovery request
2019-02-24 23:24:43.522 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:24:43.522 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:25:17.286 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-24 23:25:17.349 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-24 23:25:17.357 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-24 23:25:17.358 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-24 23:25:17.358 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-24 23:25:17.359 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-24 23:25:19.404 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:25:19.447 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:26:04.057 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-24 23:26:04.118 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-24 23:26:04.124 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-24 23:26:04.125 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-24 23:26:04.127 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-24 23:26:04.128 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-24 23:26:05.797 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:26:05.834 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:26:30.693 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:26:30.694 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:26:41.451 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 23:26:41.458 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:26:41.458 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:26:41.483 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 23:26:41.493 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 23:26:41.493 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 23:26:41.499 +01:00 [DBG] Start discovery request
2019-02-24 23:26:41.695 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 23:26:41.695 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:26:41.695 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:26:41.696 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 23:26:41.697 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 23:26:41.697 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 23:26:41.704 +01:00 [DBG] Start key discovery request
2019-02-24 23:26:43.527 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:26:43.527 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:26:43.528 +01:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-02-24 23:26:43.536 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-02-24 23:26:43.536 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-02-24 23:26:43.557 +01:00 [DBG] Processing signout request for 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:26:43.566 +01:00 [DBG] Start end session request validation
2019-02-24 23:26:43.580 +01:00 [DBG] Start identity token validation
2019-02-24 23:26:43.654 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:26:43.654 +01:00 [DBG] Client found: spa / SPA Client
2019-02-24 23:26:45.657 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-02-24 23:26:45.668 +01:00 [DBG] Token validation success
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1551047032,
    "exp": 1551047332,
    "iss": "http://localhost:49670",
    "aud": "spa",
    "nonce": "sSgYNKMNXMPNIErJJihswgwtFbc8mjHIxiu6ijlm",
    "iat": 1551047032,
    "at_hash": "CFE7H61pzX4QtgQghhbVUw",
    "sid": "790646eaa9decf12af6e919f40df9e52",
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551044890,
    "idp": "local",
    "name": "Administrator",
    "website": "https://example.org",
    "preferred_username": "admin",
    "amr": "pwd"
  }
}
2019-02-24 23:26:45.693 +01:00 [INF] End session request validation failure: Invalid post logout URI
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjQzZmNkNmY1ZmI2MDgwMmYzMjA2OTNjZGY1M2JmYjc3IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NTEwNDcwMzIsImV4cCI6MTU1MTA0NzMzMiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo0OTY3MCIsImF1ZCI6InNwYSIsIm5vbmNlIjoic1NnWU5LTU5YTVBOSUVySkppaHN3Z3d0RmJjOG1qSEl4aXU2aWpsbSIsImlhdCI6MTU1MTA0NzAzMiwiYXRfaGFzaCI6IkNGRTdINjFwelg0UXRnUWdoaGJWVXciLCJzaWQiOiI3OTA2NDZlYWE5ZGVjZjEyYWY2ZTkxOWY0MGRmOWU1MiIsInN1YiI6IjM5ZDU2OWFmLTk3NjYtNGE0MS1hOTNhLWZlYTc2Nzc5ZjlmNCIsImF1dGhfdGltZSI6MTU1MTA0NDg5MCwiaWRwIjoibG9jYWwiLCJuYW1lIjoiQWRtaW5pc3RyYXRvciIsIndlYnNpdGUiOiJodHRwczovL2V4YW1wbGUub3JnIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiYWRtaW4iLCJhbXIiOlsicHdkIl19.fDftDMV_hzVjoemInHP5XW6qNCucTN5ypOlWoxQumlcjkmJhZ231OZb5PJt8pjyLSJsqlf2d1QpPAUYmUL521tdWpA1G5Yu3H2HLtUt00g5yHL5M6IZ3QLxqldRMkGuyvOsG_UjWLUEDVTrl-4ah6ygLXv_V3555F22BYa8atRYS2zpEEjejdXtZ7fgA-lP-c7-ArfAmtcRj2CgwBhXVXAbu6D-PsZjAtz0Z9Ikavjs6PE2ev4-KGkiX6-LBTojO0upVNlcyOYPTPnIEC0zjeRSjPu2-UceCInq265ZI3viOTsWBMp0kFKepQexaZf3oydODZ31gJqYtQBMzseoVJg",
    "post_logout_redirect_uri": "http://localhost:4200/home"
  }
}
2019-02-24 23:26:45.694 +01:00 [ERR] Error processing end session request Invalid request
2019-02-24 23:26:45.712 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:26:45.712 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:26:47.312 +01:00 [DBG] CORS request made for path: /account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 23:26:47.313 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:26:47.314 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:26:47.587 +01:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-02-24 23:26:47.590 +01:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-02-24 23:26:47.591 +01:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-02-24 23:26:47.637 +01:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "Administrator",
  "ActivityId": "0HLKQKS8AB7O0:00000004",
  "TimeStamp": "2019-02-24T22:26:47Z",
  "ProcessId": 2504,
  "LocalIpAddress": "127.0.0.1:20321",
  "RemoteIpAddress": "::1"
}
2019-02-24 23:26:47.897 +01:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-02-24 23:26:47.901 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-02-24 23:26:47.902 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-02-24 23:26:47.908 +01:00 [DBG] Processing signout callback request
2019-02-24 23:26:47.954 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:26:47.955 +01:00 [DBG] No client front-channel logout URLs
2019-02-24 23:26:47.956 +01:00 [DBG] No client back-channel logout URLs
2019-02-24 23:26:47.956 +01:00 [INF] Successful signout callback.
2019-02-24 23:26:47.956 +01:00 [DBG] No client front-channel iframe urls
2019-02-24 23:26:47.956 +01:00 [DBG] No client back-channel iframe urls
2019-02-24 23:26:51.683 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 23:26:51.683 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:26:51.683 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:26:51.684 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 23:26:51.685 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 23:26:51.685 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 23:26:51.685 +01:00 [DBG] Start discovery request
2019-02-24 23:26:51.787 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 23:26:51.787 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:26:51.787 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:26:51.788 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 23:26:51.788 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 23:26:51.789 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 23:26:51.789 +01:00 [DBG] Start key discovery request
2019-02-24 23:26:53.064 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 23:26:53.072 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 23:26:53.072 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 23:26:53.079 +01:00 [DBG] Start authorize request
2019-02-24 23:26:53.087 +01:00 [DBG] No user present in authorize request
2019-02-24 23:26:53.094 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:26:53.101 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:26:53.159 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:26:53.175 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "SJT2hzWTqgZurGwkFcGauo4yoAxqox3QECcEcPjP",
  "Nonce": "SJT2hzWTqgZurGwkFcGauo4yoAxqox3QECcEcPjP",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "SJT2hzWTqgZurGwkFcGauo4yoAxqox3QECcEcPjP",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "SJT2hzWTqgZurGwkFcGauo4yoAxqox3QECcEcPjP"
  }
}
2019-02-24 23:26:53.187 +01:00 [INF] Showing login: User is not authenticated
2019-02-24 23:26:53.228 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:26:53.228 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:26:53.229 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:26:53.234 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:26:58.345 +01:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 23:26:58.918 +01:00 [DBG] Augmenting SignInContext
2019-02-24 23:26:58.921 +01:00 [DBG] Adding idp claim with value: local
2019-02-24 23:26:58.921 +01:00 [DBG] Adding amr claim with value: pwd
2019-02-24 23:26:58.922 +01:00 [DBG] Adding auth_time claim with value: 1551047218
2019-02-24 23:26:58.956 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-02-24 23:26:58.975 +01:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "admin",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "admin",
  "Endpoint": "UI",
  "ActivityId": "0HLKQKS8AB7O0:00000007",
  "TimeStamp": "2019-02-24T22:26:58Z",
  "ProcessId": 2504,
  "LocalIpAddress": "127.0.0.1:20321",
  "RemoteIpAddress": "::1"
}
2019-02-24 23:26:58.993 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:26:58.993 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:26:58.993 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-24 23:26:58.994 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-24 23:26:58.994 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-24 23:26:59.004 +01:00 [DBG] Start authorize callback request
2019-02-24 23:26:59.010 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:26:59.010 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:26:59.011 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:26:59.011 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:26:59.011 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "SJT2hzWTqgZurGwkFcGauo4yoAxqox3QECcEcPjP",
  "Nonce": "SJT2hzWTqgZurGwkFcGauo4yoAxqox3QECcEcPjP",
  "SessionId": "83131d733c4ead45b70c0566fb2caedf",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "SJT2hzWTqgZurGwkFcGauo4yoAxqox3QECcEcPjP",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "SJT2hzWTqgZurGwkFcGauo4yoAxqox3QECcEcPjP"
  }
}
2019-02-24 23:26:59.034 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 23:26:59.034 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 23:26:59.035 +01:00 [INF] Showing consent: User has not yet consented
2019-02-24 23:26:59.044 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:26:59.044 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:26:59.059 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:26:59.059 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:26:59.059 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:26:59.059 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:27:03.297 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 23:27:03.298 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:27:03.299 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:27:03.340 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:27:03.340 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:27:03.340 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:27:03.370 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:27:03.370 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:27:03.370 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-24 23:27:03.371 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-24 23:27:03.371 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-24 23:27:03.371 +01:00 [DBG] Start authorize callback request
2019-02-24 23:27:03.378 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:27:03.378 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:27:03.378 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:27:03.378 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:27:03.379 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "SJT2hzWTqgZurGwkFcGauo4yoAxqox3QECcEcPjP",
  "Nonce": "SJT2hzWTqgZurGwkFcGauo4yoAxqox3QECcEcPjP",
  "SessionId": "83131d733c4ead45b70c0566fb2caedf",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "SJT2hzWTqgZurGwkFcGauo4yoAxqox3QECcEcPjP",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "SJT2hzWTqgZurGwkFcGauo4yoAxqox3QECcEcPjP"
  }
}
2019-02-24 23:27:03.382 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 23:27:03.382 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 23:27:03.405 +01:00 [INF] User consented to scopes: ["openid","profile","api1"]
2019-02-24 23:27:03.431 +01:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:27:03.454 +01:00 [DBG] Creating Implicit Flow response.
2019-02-24 23:27:03.474 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-24 23:27:03.475 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:27:03.558 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-24 23:27:03.592 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****G7_g"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****L-xQ"
    }
  ],
  "ActivityId": "0HLKQKS8AB7O0:00000009",
  "TimeStamp": "2019-02-24T22:27:03Z",
  "ProcessId": 2504,
  "LocalIpAddress": "127.0.0.1:20321",
  "RemoteIpAddress": "::1"
}
2019-02-24 23:27:03.602 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "SJT2hzWTqgZurGwkFcGauo4yoAxqox3QECcEcPjP",
  "Scope": "openid profile api1"
}
2019-02-24 23:27:03.628 +01:00 [DBG] Augmenting SignInContext
2019-02-24 23:27:03.630 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-02-24 23:27:04.762 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 23:27:04.762 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:27:04.762 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:27:04.763 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 23:27:04.764 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 23:27:04.764 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 23:27:04.764 +01:00 [DBG] Start discovery request
2019-02-24 23:27:04.846 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 23:27:04.846 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:27:04.846 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:27:04.846 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 23:27:04.847 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 23:27:04.849 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 23:27:04.850 +01:00 [DBG] Start key discovery request
2019-02-24 23:27:58.535 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-24 23:27:58.596 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-24 23:27:58.602 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-24 23:27:58.602 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-24 23:27:58.603 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-24 23:27:58.603 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-24 23:28:00.145 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:28:00.176 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:28:48.669 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-24 23:28:48.733 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-24 23:28:48.741 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-24 23:28:48.742 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-24 23:28:48.742 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-24 23:28:48.743 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-24 23:28:50.059 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 23:28:50.077 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:28:50.078 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:28:50.239 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 23:28:50.521 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 23:28:50.521 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 23:28:50.529 +01:00 [DBG] Start discovery request
2019-02-24 23:28:50.542 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:28:50.547 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:28:50.866 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 23:28:50.867 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:28:50.871 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:28:50.872 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 23:28:50.877 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 23:28:50.877 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 23:28:50.888 +01:00 [DBG] Start key discovery request
2019-02-24 23:29:52.301 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-24 23:29:52.367 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-24 23:29:52.373 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-24 23:29:52.373 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-24 23:29:52.374 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-24 23:29:52.374 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-24 23:29:54.097 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:29:54.130 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:35:56.179 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-24 23:35:56.245 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-24 23:35:56.256 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-24 23:35:56.257 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-24 23:35:56.258 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-24 23:35:56.258 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-24 23:35:58.043 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:35:58.071 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:36:50.658 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:36:50.659 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:36:50.693 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 23:36:50.702 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 23:36:50.703 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 23:36:50.712 +01:00 [DBG] Start authorize request
2019-02-24 23:36:50.757 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:36:50.764 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:36:50.784 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:36:50.865 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:36:50.964 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "k9MC98vPc2INynsYaeOOCafvIJjoJiuEkHGbLhoU",
  "Nonce": "k9MC98vPc2INynsYaeOOCafvIJjoJiuEkHGbLhoU",
  "SessionId": "83131d733c4ead45b70c0566fb2caedf",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "k9MC98vPc2INynsYaeOOCafvIJjoJiuEkHGbLhoU",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "k9MC98vPc2INynsYaeOOCafvIJjoJiuEkHGbLhoU"
  }
}
2019-02-24 23:36:52.814 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 23:36:52.814 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 23:36:52.814 +01:00 [INF] Showing consent: User has not yet consented
2019-02-24 23:36:52.840 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:36:52.841 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:36:53.068 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:36:53.070 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:36:53.071 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:36:53.073 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:37:00.971 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:37:00.972 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:37:02.194 +01:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 23:37:02.195 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:37:02.195 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:37:02.420 +01:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-02-24 23:37:02.422 +01:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-02-24 23:37:02.423 +01:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-02-24 23:37:02.473 +01:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "Administrator",
  "ActivityId": "0HLKQL1OQ09K0:00000003",
  "TimeStamp": "2019-02-24T22:37:02Z",
  "ProcessId": 8712,
  "LocalIpAddress": "127.0.0.1:16947",
  "RemoteIpAddress": "::1"
}
2019-02-24 23:37:02.726 +01:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-02-24 23:37:02.733 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-02-24 23:37:02.733 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-02-24 23:37:02.741 +01:00 [DBG] Processing signout callback request
2019-02-24 23:37:02.787 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:37:02.788 +01:00 [DBG] No client front-channel logout URLs
2019-02-24 23:37:02.788 +01:00 [DBG] No client back-channel logout URLs
2019-02-24 23:37:02.789 +01:00 [INF] Successful signout callback.
2019-02-24 23:37:02.789 +01:00 [DBG] No client front-channel iframe urls
2019-02-24 23:37:02.789 +01:00 [DBG] No client back-channel iframe urls
2019-02-24 23:37:06.777 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 23:37:06.784 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:37:06.785 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:37:06.810 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 23:37:06.824 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 23:37:06.826 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 23:37:06.852 +01:00 [DBG] Start discovery request
2019-02-24 23:37:06.958 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 23:37:06.960 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:37:06.960 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:37:06.960 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 23:37:06.961 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 23:37:06.962 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 23:37:06.968 +01:00 [DBG] Start key discovery request
2019-02-24 23:37:07.967 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 23:37:07.968 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 23:37:07.968 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 23:37:07.968 +01:00 [DBG] Start authorize request
2019-02-24 23:37:07.968 +01:00 [DBG] No user present in authorize request
2019-02-24 23:37:07.968 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:37:07.971 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:37:07.973 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:37:07.973 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "xlmFzcpV1Es6QDsU9tdAMQhQFBr6f4EqD8rMYA6h",
  "Nonce": "xlmFzcpV1Es6QDsU9tdAMQhQFBr6f4EqD8rMYA6h",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "xlmFzcpV1Es6QDsU9tdAMQhQFBr6f4EqD8rMYA6h",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "xlmFzcpV1Es6QDsU9tdAMQhQFBr6f4EqD8rMYA6h"
  }
}
2019-02-24 23:37:07.973 +01:00 [INF] Showing login: User is not authenticated
2019-02-24 23:37:08.011 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:37:08.011 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:37:08.012 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:37:08.016 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:37:15.217 +01:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 23:37:18.400 +01:00 [DBG] Augmenting SignInContext
2019-02-24 23:37:18.402 +01:00 [DBG] Adding idp claim with value: local
2019-02-24 23:37:18.402 +01:00 [DBG] Adding amr claim with value: pwd
2019-02-24 23:37:18.403 +01:00 [DBG] Adding auth_time claim with value: 1551047838
2019-02-24 23:37:18.435 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-02-24 23:37:18.454 +01:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "admin",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "admin",
  "Endpoint": "UI",
  "ActivityId": "0HLKQL1OQ09K0:00000006",
  "TimeStamp": "2019-02-24T22:37:18Z",
  "ProcessId": 8712,
  "LocalIpAddress": "127.0.0.1:16947",
  "RemoteIpAddress": "::1"
}
2019-02-24 23:37:18.470 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:37:18.471 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:37:18.471 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-24 23:37:18.472 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-24 23:37:18.472 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-24 23:37:18.481 +01:00 [DBG] Start authorize callback request
2019-02-24 23:37:18.487 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:37:18.487 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:37:18.487 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:37:18.487 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:37:18.488 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "xlmFzcpV1Es6QDsU9tdAMQhQFBr6f4EqD8rMYA6h",
  "Nonce": "xlmFzcpV1Es6QDsU9tdAMQhQFBr6f4EqD8rMYA6h",
  "SessionId": "e2c856e07cc31743a783cf1be632ccd3",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "xlmFzcpV1Es6QDsU9tdAMQhQFBr6f4EqD8rMYA6h",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "xlmFzcpV1Es6QDsU9tdAMQhQFBr6f4EqD8rMYA6h"
  }
}
2019-02-24 23:37:18.492 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 23:37:18.492 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 23:37:18.492 +01:00 [INF] Showing consent: User has not yet consented
2019-02-24 23:37:18.500 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:37:18.500 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:37:18.506 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:37:18.506 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:37:18.506 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:37:18.506 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:37:20.805 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 23:37:20.806 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:37:20.806 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:37:20.843 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:37:20.843 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:37:20.844 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:37:20.873 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:37:20.873 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:37:20.873 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-24 23:37:20.873 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-24 23:37:20.873 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-24 23:37:20.874 +01:00 [DBG] Start authorize callback request
2019-02-24 23:37:20.880 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:37:20.880 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:37:20.880 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:37:20.880 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:37:20.880 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "xlmFzcpV1Es6QDsU9tdAMQhQFBr6f4EqD8rMYA6h",
  "Nonce": "xlmFzcpV1Es6QDsU9tdAMQhQFBr6f4EqD8rMYA6h",
  "SessionId": "e2c856e07cc31743a783cf1be632ccd3",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "xlmFzcpV1Es6QDsU9tdAMQhQFBr6f4EqD8rMYA6h",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "xlmFzcpV1Es6QDsU9tdAMQhQFBr6f4EqD8rMYA6h"
  }
}
2019-02-24 23:37:20.883 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 23:37:20.883 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 23:37:20.902 +01:00 [INF] User consented to scopes: ["openid","profile","api1"]
2019-02-24 23:37:20.922 +01:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:37:20.940 +01:00 [DBG] Creating Implicit Flow response.
2019-02-24 23:37:20.957 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-24 23:37:20.959 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:37:21.103 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-24 23:37:21.142 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****ez2A"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****LLjQ"
    }
  ],
  "ActivityId": "0HLKQL1OQ09K0:00000008",
  "TimeStamp": "2019-02-24T22:37:21Z",
  "ProcessId": 8712,
  "LocalIpAddress": "127.0.0.1:16947",
  "RemoteIpAddress": "::1"
}
2019-02-24 23:37:21.150 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "xlmFzcpV1Es6QDsU9tdAMQhQFBr6f4EqD8rMYA6h",
  "Scope": "openid profile api1"
}
2019-02-24 23:37:21.173 +01:00 [DBG] Augmenting SignInContext
2019-02-24 23:37:21.173 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-02-24 23:37:22.283 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 23:37:22.283 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:37:22.283 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:37:22.283 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 23:37:22.283 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 23:37:22.284 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 23:37:22.284 +01:00 [DBG] Start discovery request
2019-02-24 23:37:22.417 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 23:37:22.417 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:37:22.417 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:37:22.417 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 23:37:22.418 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 23:37:22.418 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 23:37:22.418 +01:00 [DBG] Start key discovery request
2019-02-24 23:40:39.004 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-24 23:40:39.066 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-24 23:40:39.071 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-24 23:40:39.072 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-24 23:40:39.073 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-24 23:40:39.074 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-24 23:40:40.791 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:40:40.824 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:41:17.004 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 23:41:17.011 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:41:17.012 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:41:17.031 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 23:41:17.045 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 23:41:17.045 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 23:41:17.081 +01:00 [DBG] Start discovery request
2019-02-24 23:41:17.248 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 23:41:17.248 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:41:17.248 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:41:17.249 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 23:41:17.250 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 23:41:17.250 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 23:41:17.255 +01:00 [DBG] Start key discovery request
2019-02-24 23:41:35.070 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 23:41:35.070 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:41:35.070 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:41:35.070 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 23:41:35.071 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 23:41:35.071 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 23:41:35.071 +01:00 [DBG] Start discovery request
2019-02-24 23:41:35.156 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 23:41:35.156 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:41:35.156 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:41:35.157 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 23:41:35.157 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 23:41:35.157 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 23:41:35.157 +01:00 [DBG] Start key discovery request
2019-02-24 23:41:36.034 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:41:36.034 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:41:36.034 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 23:41:41.258 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 23:41:41.259 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 23:41:41.265 +01:00 [DBG] Start authorize request
2019-02-24 23:41:41.288 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:41:41.294 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:41:41.311 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:41:41.366 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:41:41.387 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "4MHCj0lHl1dygF7DNYuHXMwfdjonDtpzBggXxIxA",
  "Nonce": "4MHCj0lHl1dygF7DNYuHXMwfdjonDtpzBggXxIxA",
  "SessionId": "e2c856e07cc31743a783cf1be632ccd3",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "4MHCj0lHl1dygF7DNYuHXMwfdjonDtpzBggXxIxA",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "4MHCj0lHl1dygF7DNYuHXMwfdjonDtpzBggXxIxA"
  }
}
2019-02-24 23:41:43.315 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 23:41:43.315 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 23:41:43.316 +01:00 [INF] Showing consent: User has not yet consented
2019-02-24 23:41:43.338 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:41:43.339 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:41:43.586 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:41:43.588 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:41:43.589 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:41:43.591 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:41:47.387 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 23:41:47.388 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:41:47.389 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:41:47.584 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:41:47.584 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:41:47.584 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:41:47.649 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:41:47.649 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:41:47.649 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-24 23:41:50.797 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-24 23:41:50.797 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-24 23:41:50.805 +01:00 [DBG] Start authorize callback request
2019-02-24 23:41:50.845 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:41:50.845 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:41:50.845 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:41:50.845 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:41:50.846 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "4MHCj0lHl1dygF7DNYuHXMwfdjonDtpzBggXxIxA",
  "Nonce": "4MHCj0lHl1dygF7DNYuHXMwfdjonDtpzBggXxIxA",
  "SessionId": "e2c856e07cc31743a783cf1be632ccd3",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "4MHCj0lHl1dygF7DNYuHXMwfdjonDtpzBggXxIxA",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "4MHCj0lHl1dygF7DNYuHXMwfdjonDtpzBggXxIxA"
  }
}
2019-02-24 23:41:50.876 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 23:41:50.876 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 23:41:50.890 +01:00 [INF] User consented to scopes: ["openid","profile","api1"]
2019-02-24 23:41:50.906 +01:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:41:50.920 +01:00 [DBG] Creating Implicit Flow response.
2019-02-24 23:41:50.936 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-24 23:41:50.937 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:42:00.185 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-24 23:42:15.079 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****moTA"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****F40Q"
    }
  ],
  "ActivityId": "0HLKQL4D3583L:00000003",
  "TimeStamp": "2019-02-24T22:42:15Z",
  "ProcessId": 5968,
  "LocalIpAddress": "127.0.0.1:26832",
  "RemoteIpAddress": "::1"
}
2019-02-24 23:42:15.086 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "4MHCj0lHl1dygF7DNYuHXMwfdjonDtpzBggXxIxA",
  "Scope": "openid profile api1"
}
2019-02-24 23:42:16.320 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 23:42:16.321 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:42:16.321 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:42:16.321 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 23:42:16.322 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 23:42:16.322 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 23:42:16.323 +01:00 [DBG] Start discovery request
2019-02-24 23:42:16.432 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 23:42:16.432 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:42:16.432 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:42:16.432 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 23:42:16.432 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 23:42:16.433 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 23:42:16.433 +01:00 [DBG] Start key discovery request
2019-02-24 23:47:51.376 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 23:47:51.378 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:47:51.378 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:47:51.379 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 23:47:51.379 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 23:47:51.379 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 23:47:51.379 +01:00 [DBG] Start discovery request
2019-02-24 23:47:51.473 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 23:47:51.473 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:47:51.473 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:47:51.474 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 23:47:51.476 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 23:47:51.476 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 23:47:51.476 +01:00 [DBG] Start key discovery request
2019-02-24 23:48:08.322 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:48:08.322 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:48:08.322 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-24 23:48:08.322 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-24 23:48:08.322 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-24 23:48:08.322 +01:00 [DBG] Start authorize request
2019-02-24 23:48:08.323 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:48:08.323 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:48:08.323 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:48:08.323 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:48:08.324 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "viqMxh8ss8QodxY7v1hItVkkTiIyNwUEOA1Gs5x8",
  "Nonce": "viqMxh8ss8QodxY7v1hItVkkTiIyNwUEOA1Gs5x8",
  "SessionId": "e2c856e07cc31743a783cf1be632ccd3",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "viqMxh8ss8QodxY7v1hItVkkTiIyNwUEOA1Gs5x8",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "viqMxh8ss8QodxY7v1hItVkkTiIyNwUEOA1Gs5x8"
  }
}
2019-02-24 23:48:08.334 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 23:48:08.334 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 23:48:08.334 +01:00 [INF] Showing consent: User has not yet consented
2019-02-24 23:48:08.371 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:48:08.371 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:48:08.373 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:48:08.373 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:48:08.373 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:48:08.373 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:48:10.082 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-24 23:48:10.084 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:48:10.084 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:48:10.087 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:48:10.087 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:48:10.087 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:48:10.106 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:48:10.107 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-24 23:48:10.107 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-24 23:48:10.107 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-24 23:48:10.107 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-24 23:48:10.107 +01:00 [DBG] Start authorize callback request
2019-02-24 23:48:10.108 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:48:10.108 +01:00 [DBG] Start authorize request protocol validation
2019-02-24 23:48:10.108 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-24 23:48:10.109 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-24 23:48:10.109 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "viqMxh8ss8QodxY7v1hItVkkTiIyNwUEOA1Gs5x8",
  "Nonce": "viqMxh8ss8QodxY7v1hItVkkTiIyNwUEOA1Gs5x8",
  "SessionId": "e2c856e07cc31743a783cf1be632ccd3",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "viqMxh8ss8QodxY7v1hItVkkTiIyNwUEOA1Gs5x8",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "viqMxh8ss8QodxY7v1hItVkkTiIyNwUEOA1Gs5x8"
  }
}
2019-02-24 23:48:10.112 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-24 23:48:10.112 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-24 23:48:10.112 +01:00 [INF] User consented to scopes: ["openid","profile","api1"]
2019-02-24 23:48:10.112 +01:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:48:10.113 +01:00 [DBG] Creating Implicit Flow response.
2019-02-24 23:48:10.113 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-24 23:48:10.113 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-24 23:48:10.124 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-24 23:48:10.132 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****IRig"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****9ywQ"
    }
  ],
  "ActivityId": "0HLKQL4D3583M:00000006",
  "TimeStamp": "2019-02-24T22:48:10Z",
  "ProcessId": 5968,
  "LocalIpAddress": "127.0.0.1:26832",
  "RemoteIpAddress": "::1"
}
2019-02-24 23:48:10.132 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "viqMxh8ss8QodxY7v1hItVkkTiIyNwUEOA1Gs5x8",
  "Scope": "openid profile api1"
}
2019-02-24 23:48:11.308 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 23:48:11.309 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:48:11.315 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:48:11.315 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 23:48:11.316 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 23:48:11.316 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 23:48:11.316 +01:00 [DBG] Start discovery request
2019-02-24 23:48:11.387 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 23:48:11.387 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:48:11.387 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:48:11.388 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 23:48:11.389 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 23:48:11.389 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 23:48:11.389 +01:00 [DBG] Start key discovery request
2019-02-24 23:48:17.681 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-24 23:48:17.681 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:48:17.681 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:48:17.681 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 23:48:17.682 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 23:48:17.682 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 23:48:17.682 +01:00 [DBG] Start discovery request
2019-02-24 23:48:17.769 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-24 23:48:17.769 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-24 23:48:17.769 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-24 23:48:17.769 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 23:48:17.771 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 23:48:17.773 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 23:48:17.773 +01:00 [DBG] Start key discovery request
2019-02-24 23:48:20.237 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-24 23:48:20.237 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-24 23:48:20.238 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-24 23:48:20.238 +01:00 [DBG] Start discovery request
2019-02-24 23:48:20.367 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-24 23:48:20.367 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-24 23:48:20.367 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-24 23:48:20.367 +01:00 [DBG] Start key discovery request
2019-02-25 00:20:32.601 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-25 00:20:32.664 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-25 00:20:32.673 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-25 00:20:32.673 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-25 00:20:32.674 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-25 00:20:32.675 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-25 00:20:33.787 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-25 00:20:33.802 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-25 00:20:33.802 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-25 00:20:33.986 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-25 00:20:34.198 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-25 00:20:34.198 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-25 00:20:34.205 +01:00 [DBG] Start discovery request
2019-02-25 00:20:34.448 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-25 00:20:34.448 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-25 00:20:34.448 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-25 00:20:34.449 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-25 00:20:34.451 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-25 00:20:34.451 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-25 00:20:34.458 +01:00 [DBG] Start key discovery request
2019-02-25 00:20:37.707 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-25 00:20:37.707 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-25 00:20:37.707 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-25 00:20:37.708 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-25 00:20:37.708 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-25 00:20:37.708 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-25 00:20:37.708 +01:00 [DBG] Start discovery request
2019-02-25 00:20:37.790 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-25 00:20:37.790 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-25 00:20:37.790 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-25 00:20:37.790 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-25 00:20:37.791 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-25 00:20:37.791 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-25 00:20:37.791 +01:00 [DBG] Start key discovery request
2019-02-25 00:21:13.325 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-25 00:21:13.380 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-25 00:21:13.385 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-25 00:21:13.386 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-25 00:21:13.386 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-25 00:21:13.387 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-25 00:21:13.819 +01:00 [WRN] Unable to bind to http://localhost:49670 on the IPv4 loopback interface: 'Error -4092 EACCES permission denied'.
2019-02-25 00:21:13.821 +01:00 [WRN] Unable to bind to http://localhost:49670 on the IPv6 loopback interface: 'Error -4092 EACCES permission denied'.
2019-02-25 00:21:13.829 +01:00 [FTL] Unable to start Kestrel.
System.IO.IOException: Failed to bind to address http://localhost:49670. ---> System.AggregateException: One or more errors occurred. (Error -4092 EACCES permission denied) (Error -4092 EACCES permission denied) ---> Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.Networking.UvException: Error -4092 EACCES permission denied
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.Networking.LibuvFunctions.ThrowError(Int32 statusCode)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.Networking.UvTcpHandle.Bind(IPEndPoint endPoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.Listener.ListenTcp(Boolean useFileHandle)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.Listener.<>c.<StartAsync>b__8_0(Listener listener)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.LibuvThread.DoPostWork()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.ListenerPrimary.StartAsync(String pipeName, Byte[] pipeMessage, IEndPointInformation endPointInformation, LibuvThread thread)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.LibuvTransport.BindAsync()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.LibuvTransport.BindAsync()
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.<>c__DisplayClass23_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindLocalhostAsync(ServerAddress address, AddressBindContext context)
   --- End of inner exception stack trace ---
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindLocalhostAsync(ServerAddress address, AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAddressAsync(String address, AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(IServerAddressesFeature addresses, List`1 listenOptions, ILogger logger, Func`2 createBinding)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
2019-02-25 00:21:29.508 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-25 00:21:29.561 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-25 00:21:29.566 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-25 00:21:29.567 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-25 00:21:29.568 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-25 00:21:29.568 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-25 00:21:30.002 +01:00 [WRN] Unable to bind to http://localhost:49670 on the IPv4 loopback interface: 'Error -4092 EACCES permission denied'.
2019-02-25 00:21:30.005 +01:00 [WRN] Unable to bind to http://localhost:49670 on the IPv6 loopback interface: 'Error -4092 EACCES permission denied'.
2019-02-25 00:21:30.012 +01:00 [FTL] Unable to start Kestrel.
System.IO.IOException: Failed to bind to address http://localhost:49670. ---> System.AggregateException: One or more errors occurred. (Error -4092 EACCES permission denied) (Error -4092 EACCES permission denied) ---> Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.Networking.UvException: Error -4092 EACCES permission denied
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.Networking.LibuvFunctions.ThrowError(Int32 statusCode)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.Networking.UvTcpHandle.Bind(IPEndPoint endPoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.Listener.ListenTcp(Boolean useFileHandle)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.Listener.<>c.<StartAsync>b__8_0(Listener listener)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.LibuvThread.DoPostWork()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.ListenerPrimary.StartAsync(String pipeName, Byte[] pipeMessage, IEndPointInformation endPointInformation, LibuvThread thread)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.LibuvTransport.BindAsync()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.LibuvTransport.BindAsync()
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.<>c__DisplayClass23_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindLocalhostAsync(ServerAddress address, AddressBindContext context)
   --- End of inner exception stack trace ---
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindLocalhostAsync(ServerAddress address, AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAddressAsync(String address, AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(IServerAddressesFeature addresses, List`1 listenOptions, ILogger logger, Func`2 createBinding)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
2019-02-25 00:21:40.961 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-25 00:21:41.014 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-25 00:21:41.018 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-25 00:21:41.019 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-25 00:21:41.019 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-25 00:21:41.020 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-25 00:21:41.455 +01:00 [WRN] Unable to bind to http://localhost:49670 on the IPv4 loopback interface: 'Error -4092 EACCES permission denied'.
2019-02-25 00:21:41.457 +01:00 [WRN] Unable to bind to http://localhost:49670 on the IPv6 loopback interface: 'Error -4092 EACCES permission denied'.
2019-02-25 00:21:41.465 +01:00 [FTL] Unable to start Kestrel.
System.IO.IOException: Failed to bind to address http://localhost:49670. ---> System.AggregateException: One or more errors occurred. (Error -4092 EACCES permission denied) (Error -4092 EACCES permission denied) ---> Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.Networking.UvException: Error -4092 EACCES permission denied
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.Networking.LibuvFunctions.ThrowError(Int32 statusCode)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.Networking.UvTcpHandle.Bind(IPEndPoint endPoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.Listener.ListenTcp(Boolean useFileHandle)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.Listener.<>c.<StartAsync>b__8_0(Listener listener)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.LibuvThread.DoPostWork()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.ListenerPrimary.StartAsync(String pipeName, Byte[] pipeMessage, IEndPointInformation endPointInformation, LibuvThread thread)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.LibuvTransport.BindAsync()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.LibuvTransport.BindAsync()
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.<>c__DisplayClass23_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindLocalhostAsync(ServerAddress address, AddressBindContext context)
   --- End of inner exception stack trace ---
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindLocalhostAsync(ServerAddress address, AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAddressAsync(String address, AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(IServerAddressesFeature addresses, List`1 listenOptions, ILogger logger, Func`2 createBinding)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
2019-02-25 00:21:54.916 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-25 00:21:54.969 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-25 00:21:54.974 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-25 00:21:54.974 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-25 00:21:54.975 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-25 00:21:54.975 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-25 00:22:05.396 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-25 00:22:05.408 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-25 00:22:05.408 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-25 00:22:05.566 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-25 00:22:05.757 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-25 00:22:05.757 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-25 00:22:05.762 +01:00 [DBG] Start discovery request
2019-02-25 00:22:05.982 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-25 00:22:05.982 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-25 00:22:05.982 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-25 00:22:05.983 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-25 00:22:05.984 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-25 00:22:05.984 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-25 00:22:05.991 +01:00 [DBG] Start key discovery request
2019-02-25 00:22:10.311 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-25 00:22:10.314 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-25 00:22:10.315 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-25 00:22:10.321 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-25 00:22:10.321 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-25 00:22:10.325 +01:00 [DBG] Start authorize request
2019-02-25 00:22:10.347 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-25 00:22:10.353 +01:00 [DBG] Start authorize request protocol validation
2019-02-25 00:22:10.370 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-25 00:22:10.425 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-25 00:22:10.445 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "GYbwmEN22FXSRdKU3wbYJHZrk4enu42xPbs55j8B",
  "Nonce": "GYbwmEN22FXSRdKU3wbYJHZrk4enu42xPbs55j8B",
  "SessionId": "e2c856e07cc31743a783cf1be632ccd3",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "GYbwmEN22FXSRdKU3wbYJHZrk4enu42xPbs55j8B",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "GYbwmEN22FXSRdKU3wbYJHZrk4enu42xPbs55j8B"
  }
}
2019-02-25 00:22:10.475 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-25 00:22:10.475 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-25 00:22:10.475 +01:00 [INF] Showing consent: User has not yet consented
2019-02-25 00:22:10.546 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-25 00:22:10.546 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-25 00:22:11.090 +01:00 [DBG] Start authorize request protocol validation
2019-02-25 00:22:11.092 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-25 00:22:11.092 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-25 00:22:11.094 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-25 00:22:24.510 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-25 00:22:24.512 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-25 00:22:24.512 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-25 00:22:24.685 +01:00 [DBG] Start authorize request protocol validation
2019-02-25 00:22:24.685 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-25 00:22:24.685 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-25 00:22:24.727 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-25 00:22:24.727 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-25 00:22:24.728 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-25 00:22:24.728 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-25 00:22:24.728 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-25 00:22:24.737 +01:00 [DBG] Start authorize callback request
2019-02-25 00:22:24.778 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-25 00:22:24.778 +01:00 [DBG] Start authorize request protocol validation
2019-02-25 00:22:24.778 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-25 00:22:24.778 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-25 00:22:24.779 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "GYbwmEN22FXSRdKU3wbYJHZrk4enu42xPbs55j8B",
  "Nonce": "GYbwmEN22FXSRdKU3wbYJHZrk4enu42xPbs55j8B",
  "SessionId": "e2c856e07cc31743a783cf1be632ccd3",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "GYbwmEN22FXSRdKU3wbYJHZrk4enu42xPbs55j8B",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "GYbwmEN22FXSRdKU3wbYJHZrk4enu42xPbs55j8B"
  }
}
2019-02-25 00:22:24.793 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-25 00:22:24.793 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-25 00:22:24.808 +01:00 [INF] User consented to scopes: ["openid","profile","api1"]
2019-02-25 00:22:24.828 +01:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-25 00:22:24.843 +01:00 [DBG] Creating Implicit Flow response.
2019-02-25 00:22:24.860 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-25 00:22:24.861 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-25 00:22:24.973 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-25 00:22:25.033 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****ooEw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****w7uQ"
    }
  ],
  "ActivityId": "0HLKQLRHO5JH6:00000002",
  "TimeStamp": "2019-02-24T23:22:24Z",
  "ProcessId": 8132,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-25 00:22:25.038 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "GYbwmEN22FXSRdKU3wbYJHZrk4enu42xPbs55j8B",
  "Scope": "openid profile api1"
}
2019-02-25 00:22:26.210 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-25 00:22:26.211 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-25 00:22:26.211 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-25 00:22:26.211 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-25 00:22:26.211 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-25 00:22:26.211 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-25 00:22:26.211 +01:00 [DBG] Start discovery request
2019-02-25 00:22:26.299 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-25 00:22:26.299 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-25 00:22:26.299 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-25 00:22:26.299 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-25 00:22:26.300 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-25 00:22:26.300 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-25 00:22:26.300 +01:00 [DBG] Start key discovery request
2019-02-25 00:22:28.421 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-25 00:22:28.421 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-25 00:22:28.421 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-25 00:22:28.421 +01:00 [DBG] Start discovery request
2019-02-25 00:22:28.547 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-25 00:22:28.548 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-25 00:22:28.548 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-25 00:22:28.548 +01:00 [DBG] Start key discovery request
2019-02-25 00:31:14.364 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-25 00:31:14.423 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-25 00:31:14.429 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-25 00:31:14.429 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-25 00:31:14.430 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-25 00:31:14.431 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-25 00:31:25.269 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-25 00:31:25.283 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-25 00:31:25.283 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-25 00:31:25.460 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-25 00:31:25.654 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-25 00:31:25.655 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-25 00:31:25.659 +01:00 [DBG] Start discovery request
2019-02-25 00:31:25.884 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-25 00:31:25.884 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-25 00:31:25.884 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-25 00:31:25.885 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-25 00:31:25.887 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-25 00:31:25.887 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-25 00:31:25.893 +01:00 [DBG] Start key discovery request
2019-02-25 00:31:27.699 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-25 00:31:27.701 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-25 00:31:27.702 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-25 00:31:27.709 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-25 00:31:27.709 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-25 00:31:27.715 +01:00 [DBG] Start authorize request
2019-02-25 00:31:27.744 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-25 00:31:27.750 +01:00 [DBG] Start authorize request protocol validation
2019-02-25 00:31:27.771 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-25 00:31:27.832 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-25 00:31:27.855 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "teJhrXHNEzAAbnX6S32sAShXSYd9NfRCCZepYrKd",
  "Nonce": "teJhrXHNEzAAbnX6S32sAShXSYd9NfRCCZepYrKd",
  "SessionId": "e2c856e07cc31743a783cf1be632ccd3",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "teJhrXHNEzAAbnX6S32sAShXSYd9NfRCCZepYrKd",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "teJhrXHNEzAAbnX6S32sAShXSYd9NfRCCZepYrKd"
  }
}
2019-02-25 00:31:29.561 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-25 00:31:29.561 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-25 00:31:29.561 +01:00 [INF] Showing consent: User has not yet consented
2019-02-25 00:31:29.584 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-25 00:31:29.584 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-25 00:31:30.146 +01:00 [DBG] Start authorize request protocol validation
2019-02-25 00:31:30.148 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-25 00:31:30.148 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-25 00:31:30.150 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-25 00:31:42.515 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-25 00:31:42.519 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-25 00:31:42.519 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-25 00:31:42.741 +01:00 [DBG] Start authorize request protocol validation
2019-02-25 00:31:42.742 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-25 00:31:42.742 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-25 00:31:42.802 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-25 00:31:42.802 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-25 00:31:42.803 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-25 00:31:42.803 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-25 00:31:42.803 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-25 00:31:42.811 +01:00 [DBG] Start authorize callback request
2019-02-25 00:31:42.853 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-25 00:31:42.853 +01:00 [DBG] Start authorize request protocol validation
2019-02-25 00:31:42.853 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-25 00:31:42.853 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-25 00:31:42.853 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "teJhrXHNEzAAbnX6S32sAShXSYd9NfRCCZepYrKd",
  "Nonce": "teJhrXHNEzAAbnX6S32sAShXSYd9NfRCCZepYrKd",
  "SessionId": "e2c856e07cc31743a783cf1be632ccd3",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "teJhrXHNEzAAbnX6S32sAShXSYd9NfRCCZepYrKd",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "teJhrXHNEzAAbnX6S32sAShXSYd9NfRCCZepYrKd"
  }
}
2019-02-25 00:31:42.867 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-25 00:31:42.868 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-25 00:31:42.881 +01:00 [INF] User consented to scopes: ["openid","profile","api1"]
2019-02-25 00:31:42.897 +01:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-25 00:31:42.912 +01:00 [DBG] Creating Implicit Flow response.
2019-02-25 00:31:42.927 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-25 00:31:42.928 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-25 00:31:43.211 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-25 00:31:43.276 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****ZHBA"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****vF7A"
    }
  ],
  "ActivityId": "0HLKQM0OJ4FAU:00000004",
  "TimeStamp": "2019-02-24T23:31:43Z",
  "ProcessId": 1848,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-25 00:31:43.282 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "teJhrXHNEzAAbnX6S32sAShXSYd9NfRCCZepYrKd",
  "Scope": "openid profile api1"
}
2019-02-25 00:31:44.409 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-25 00:31:44.409 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-25 00:31:44.409 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-25 00:31:44.409 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-25 00:31:44.410 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-25 00:31:44.410 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-25 00:31:44.410 +01:00 [DBG] Start discovery request
2019-02-25 00:31:44.499 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-25 00:31:44.499 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-25 00:31:44.499 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-25 00:31:44.500 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-25 00:31:44.502 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-25 00:31:44.503 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-25 00:31:44.503 +01:00 [DBG] Start key discovery request
2019-02-25 00:31:47.143 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-25 00:31:47.143 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-25 00:31:47.143 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-25 00:31:47.143 +01:00 [DBG] Start discovery request
2019-02-25 00:31:47.271 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-25 00:31:47.271 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-25 00:31:47.271 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-25 00:31:47.271 +01:00 [DBG] Start key discovery request
2019-02-25 00:39:14.598 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-25 00:39:14.650 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-02-25 00:39:14.655 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-02-25 00:39:14.655 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-02-25 00:39:14.655 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-02-25 00:39:14.656 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-02-25 00:39:28.826 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-25 00:39:28.841 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-25 00:39:28.841 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-25 00:39:29.024 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-25 00:39:29.211 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-25 00:39:29.211 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-25 00:39:29.216 +01:00 [DBG] Start discovery request
2019-02-25 00:39:29.536 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-25 00:39:29.538 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-25 00:39:29.538 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-25 00:39:29.539 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-25 00:39:29.540 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-25 00:39:29.541 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-25 00:39:29.557 +01:00 [DBG] Start key discovery request
2019-02-25 00:39:37.197 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-25 00:39:37.198 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-25 00:39:37.198 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-25 00:39:37.198 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-25 00:39:37.198 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-25 00:39:37.198 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-25 00:39:37.198 +01:00 [DBG] Start discovery request
2019-02-25 00:39:37.301 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-25 00:39:37.302 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-25 00:39:37.302 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-25 00:39:37.303 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-25 00:39:37.304 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-25 00:39:37.304 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-25 00:39:37.304 +01:00 [DBG] Start key discovery request
2019-02-25 00:39:39.329 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-25 00:39:39.332 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-25 00:39:39.334 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-02-25 00:39:39.341 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-02-25 00:39:39.341 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-25 00:39:39.345 +01:00 [DBG] Start authorize request
2019-02-25 00:39:39.371 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-25 00:39:39.378 +01:00 [DBG] Start authorize request protocol validation
2019-02-25 00:39:39.397 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-25 00:39:39.456 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-25 00:39:39.478 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "5g1iFrfkU0aCgbK7fvikrExeSz6huz3yxajaW0uh",
  "Nonce": "5g1iFrfkU0aCgbK7fvikrExeSz6huz3yxajaW0uh",
  "SessionId": "e2c856e07cc31743a783cf1be632ccd3",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "5g1iFrfkU0aCgbK7fvikrExeSz6huz3yxajaW0uh",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "5g1iFrfkU0aCgbK7fvikrExeSz6huz3yxajaW0uh"
  }
}
2019-02-25 00:39:41.154 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-25 00:39:41.154 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-25 00:39:41.155 +01:00 [INF] Showing consent: User has not yet consented
2019-02-25 00:39:41.177 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-25 00:39:41.177 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-25 00:39:41.707 +01:00 [DBG] Start authorize request protocol validation
2019-02-25 00:39:41.709 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-25 00:39:41.709 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-25 00:39:41.711 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-25 00:39:53.471 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-02-25 00:39:53.472 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-25 00:39:53.472 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-25 00:39:53.653 +01:00 [DBG] Start authorize request protocol validation
2019-02-25 00:39:53.653 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-25 00:39:53.653 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-25 00:39:53.713 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-25 00:39:53.713 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-02-25 00:39:53.713 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-02-25 00:39:53.714 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-02-25 00:39:53.714 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-02-25 00:39:53.720 +01:00 [DBG] Start authorize callback request
2019-02-25 00:39:53.760 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-25 00:39:53.760 +01:00 [DBG] Start authorize request protocol validation
2019-02-25 00:39:53.760 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-25 00:39:53.760 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-02-25 00:39:53.761 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "5g1iFrfkU0aCgbK7fvikrExeSz6huz3yxajaW0uh",
  "Nonce": "5g1iFrfkU0aCgbK7fvikrExeSz6huz3yxajaW0uh",
  "SessionId": "e2c856e07cc31743a783cf1be632ccd3",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "5g1iFrfkU0aCgbK7fvikrExeSz6huz3yxajaW0uh",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "5g1iFrfkU0aCgbK7fvikrExeSz6huz3yxajaW0uh"
  }
}
2019-02-25 00:39:53.774 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-02-25 00:39:53.774 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-02-25 00:39:53.786 +01:00 [INF] User consented to scopes: ["openid","profile","api1"]
2019-02-25 00:39:53.801 +01:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-25 00:39:53.814 +01:00 [DBG] Creating Implicit Flow response.
2019-02-25 00:39:53.829 +01:00 [DBG] Getting claims for access token for client: spa
2019-02-25 00:39:53.830 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-02-25 00:39:54.070 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-02-25 00:39:54.189 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****Cohw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****5fdd"
    }
  ],
  "ActivityId": "0HLKQM58MJGDR:00000004",
  "TimeStamp": "2019-02-24T23:39:54Z",
  "ProcessId": 5496,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-25 00:39:54.195 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "5g1iFrfkU0aCgbK7fvikrExeSz6huz3yxajaW0uh",
  "Scope": "openid profile api1"
}
2019-02-25 00:39:55.308 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-02-25 00:39:55.308 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-25 00:39:55.308 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-25 00:39:55.308 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-25 00:39:55.308 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-25 00:39:55.308 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-25 00:39:55.308 +01:00 [DBG] Start discovery request
2019-02-25 00:39:55.389 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-02-25 00:39:55.389 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-02-25 00:39:55.389 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-02-25 00:39:55.389 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-25 00:39:55.389 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-25 00:39:55.389 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-25 00:39:55.390 +01:00 [DBG] Start key discovery request
2019-02-25 00:40:15.827 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-02-25 00:40:15.828 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-02-25 00:40:15.828 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-25 00:40:15.828 +01:00 [DBG] Start discovery request
2019-02-25 00:40:15.868 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-02-25 00:40:15.868 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-02-25 00:40:15.868 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-25 00:40:15.868 +01:00 [DBG] Start key discovery request
2019-02-25 00:40:15.981 +01:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-02-25 00:40:15.984 +01:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-02-25 00:40:15.984 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-02-25 00:40:15.999 +01:00 [DBG] Starting introspection request.
2019-02-25 00:40:16.015 +01:00 [DBG] Start parsing Basic Authentication secret
2019-02-25 00:40:16.020 +01:00 [DBG] Start parsing for secret in post body
2019-02-25 00:40:16.020 +01:00 [DBG] Parser found secret: PostBodySecretParser
2019-02-25 00:40:16.021 +01:00 [DBG] Secret id found: api1
2019-02-25 00:40:16.036 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-02-25 00:40:16.036 +01:00 [DBG] API resource validation success
2019-02-25 00:40:16.043 +01:00 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "api1",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLKQM58MJGDU:00000001",
  "TimeStamp": "2019-02-24T23:40:16Z",
  "ProcessId": 5496,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-25 00:40:16.047 +01:00 [DBG] Introspection request validation started.
2019-02-25 00:40:16.101 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-25 00:40:16.107 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-02-25 00:40:16.111 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-02-25 00:40:16.118 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "e720fcedc63523a8fc6130341212cf2edaed40f17425d1fb712141253c3e5fdd",
  "Claims": {
    "iss": "http://localhost:49670",
    "nbf": 1551051594,
    "exp": 1551055194,
    "aud": [
      "http://localhost:49670/resources",
      "api1"
    ],
    "client_id": "spa",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551047838,
    "idp": "local",
    "amr": "pwd",
    "Role": [
      "Administrator",
      "Overridden"
    ],
    "Avion": "[\"Pariz\", \"Zagreb\"]",
    "CanRead": "yes",
    "CanWrite": "yes",
    "CanDelete": "yes"
  }
}
2019-02-25 00:40:16.118 +01:00 [DBG] Introspection request validation successful.
2019-02-25 00:40:16.131 +01:00 [DBG] Creating introspection response for active token.
2019-02-25 00:40:16.145 +01:00 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "api1",
  "IsActive": true,
  "Token": "****5fdd",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr",
    "Role",
    "Avion",
    "CanRead",
    "CanWrite",
    "CanDelete"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "ActivityId": "0HLKQM58MJGDU:00000001",
  "TimeStamp": "2019-02-24T23:40:16Z",
  "ProcessId": 5496,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-02-25 00:40:16.146 +01:00 [INF] Success token introspection. Token active: true, for API name: api1
2019-03-03 21:16:05.823 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-03 21:16:05.886 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-03-03 21:16:05.890 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-03-03 21:16:05.891 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-03-03 21:16:05.891 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-03-03 21:16:05.892 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-03-03 21:18:19.954 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-03-03 21:18:19.966 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:18:19.966 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:18:20.113 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-03 21:18:20.309 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-03 21:18:20.309 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-03 21:18:20.314 +01:00 [DBG] Start discovery request
2019-03-03 21:18:20.523 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-03-03 21:18:20.523 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:18:20.523 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:18:20.524 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-03 21:18:20.525 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-03 21:18:20.525 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-03 21:18:20.530 +01:00 [DBG] Start key discovery request
2019-03-03 21:18:43.945 +01:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-03 21:18:49.661 +01:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-03 21:18:53.558 +01:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-03-03 21:18:55.799 +01:00 [DBG] Augmenting SignInContext
2019-03-03 21:18:55.802 +01:00 [DBG] Adding idp claim with value: local
2019-03-03 21:18:55.802 +01:00 [DBG] Adding amr claim with value: pwd
2019-03-03 21:18:55.802 +01:00 [DBG] Adding auth_time claim with value: 1551644335
2019-03-03 21:18:55.850 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-03 21:18:55.900 +01:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "admin",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "admin",
  "Endpoint": "UI",
  "ActivityId": "0HLL02LGBL13P:00000008",
  "TimeStamp": "2019-03-03T20:18:55Z",
  "ProcessId": 5164,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-03-03 21:18:55.936 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:18:55.937 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:18:59.911 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:18:59.911 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:19:01.230 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:19:01.231 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:19:02.326 +01:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-03-03 21:19:02.327 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:19:02.327 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:19:02.366 +01:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-03-03 21:19:02.367 +01:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-03-03 21:19:02.368 +01:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-03-03 21:19:02.375 +01:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "Administrator",
  "ActivityId": "0HLL02LGBL13P:0000000D",
  "TimeStamp": "2019-03-03T20:19:02Z",
  "ProcessId": 5164,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-03-03 21:19:04.464 +01:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-03 21:19:08.049 +01:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-03 21:19:13.762 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-03 21:19:13.767 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-03 21:19:13.767 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-03 21:19:13.772 +01:00 [DBG] Start authorize request
2019-03-03 21:19:13.781 +01:00 [DBG] No user present in authorize request
2019-03-03 21:19:13.787 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:19:13.807 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:19:13.867 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:19:13.886 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "Pt7gcmC6hVF58WlfSIhiJK2ZAGPPP7FmF5fJMYUf",
  "Nonce": "Pt7gcmC6hVF58WlfSIhiJK2ZAGPPP7FmF5fJMYUf",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "Pt7gcmC6hVF58WlfSIhiJK2ZAGPPP7FmF5fJMYUf",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "Pt7gcmC6hVF58WlfSIhiJK2ZAGPPP7FmF5fJMYUf"
  }
}
2019-03-03 21:19:13.897 +01:00 [INF] Showing login: User is not authenticated
2019-03-03 21:19:13.915 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:19:13.915 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:19:13.916 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:19:13.919 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:19:18.236 +01:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-03-03 21:19:18.275 +01:00 [DBG] Augmenting SignInContext
2019-03-03 21:19:18.275 +01:00 [DBG] Adding idp claim with value: local
2019-03-03 21:19:18.275 +01:00 [DBG] Adding amr claim with value: pwd
2019-03-03 21:19:18.275 +01:00 [DBG] Adding auth_time claim with value: 1551644358
2019-03-03 21:19:18.276 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-03 21:19:18.277 +01:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "admin",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "admin",
  "Endpoint": "UI",
  "ActivityId": "0HLL02LGBL13P:00000017",
  "TimeStamp": "2019-03-03T20:19:18Z",
  "ProcessId": 5164,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-03-03 21:19:18.282 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:19:18.282 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:19:18.282 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-03 21:19:18.283 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-03 21:19:18.283 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-03 21:19:18.289 +01:00 [DBG] Start authorize callback request
2019-03-03 21:19:18.295 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-03-03 21:19:18.295 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:19:18.295 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:19:18.295 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:19:18.295 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "Pt7gcmC6hVF58WlfSIhiJK2ZAGPPP7FmF5fJMYUf",
  "Nonce": "Pt7gcmC6hVF58WlfSIhiJK2ZAGPPP7FmF5fJMYUf",
  "SessionId": "4382bc22782d0d9b89eac27ac5324cec",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "Pt7gcmC6hVF58WlfSIhiJK2ZAGPPP7FmF5fJMYUf",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "Pt7gcmC6hVF58WlfSIhiJK2ZAGPPP7FmF5fJMYUf"
  }
}
2019-03-03 21:19:18.355 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-03-03 21:19:18.355 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-03-03 21:19:18.355 +01:00 [INF] Showing consent: User has not yet consented
2019-03-03 21:19:18.361 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:19:18.361 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:19:18.371 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:19:18.371 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:19:18.372 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:19:18.372 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:19:20.950 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-03-03 21:19:20.950 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:19:20.951 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:19:20.989 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:19:20.989 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:19:20.990 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:19:21.024 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:19:21.024 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:19:21.024 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-03 21:19:21.024 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-03 21:19:21.024 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-03 21:19:21.025 +01:00 [DBG] Start authorize callback request
2019-03-03 21:19:21.070 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-03-03 21:19:21.070 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:19:21.070 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:19:21.070 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:19:21.071 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "Pt7gcmC6hVF58WlfSIhiJK2ZAGPPP7FmF5fJMYUf",
  "Nonce": "Pt7gcmC6hVF58WlfSIhiJK2ZAGPPP7FmF5fJMYUf",
  "SessionId": "4382bc22782d0d9b89eac27ac5324cec",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "Pt7gcmC6hVF58WlfSIhiJK2ZAGPPP7FmF5fJMYUf",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "Pt7gcmC6hVF58WlfSIhiJK2ZAGPPP7FmF5fJMYUf"
  }
}
2019-03-03 21:19:21.075 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-03-03 21:19:21.076 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-03-03 21:19:21.090 +01:00 [INF] User consented to scopes: ["openid","profile","api1"]
2019-03-03 21:19:21.107 +01:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-03-03 21:19:21.121 +01:00 [DBG] Creating Implicit Flow response.
2019-03-03 21:19:21.137 +01:00 [DBG] Getting claims for access token for client: spa
2019-03-03 21:19:21.138 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-03-03 21:19:21.196 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-03-03 21:19:21.795 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****Webg"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****3063"
    }
  ],
  "ActivityId": "0HLL02LGBL13P:0000001C",
  "TimeStamp": "2019-03-03T20:19:21Z",
  "ProcessId": 5164,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-03-03 21:19:21.803 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "Pt7gcmC6hVF58WlfSIhiJK2ZAGPPP7FmF5fJMYUf",
  "Scope": "openid profile api1"
}
2019-03-03 21:19:21.830 +01:00 [DBG] Augmenting SignInContext
2019-03-03 21:19:21.831 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-03 21:19:22.948 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-03-03 21:19:22.948 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:19:22.948 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:19:22.948 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-03 21:19:22.948 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-03 21:19:22.948 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-03 21:19:22.949 +01:00 [DBG] Start discovery request
2019-03-03 21:19:23.078 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-03-03 21:19:23.079 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:19:23.079 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:19:23.079 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-03 21:19:23.079 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-03 21:19:23.079 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-03 21:19:23.080 +01:00 [DBG] Start key discovery request
2019-03-03 21:19:25.912 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-03 21:19:25.912 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-03 21:19:25.912 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-03 21:19:25.912 +01:00 [DBG] Start discovery request
2019-03-03 21:19:25.950 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-03 21:19:25.951 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-03 21:19:25.951 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-03 21:19:25.951 +01:00 [DBG] Start key discovery request
2019-03-03 21:19:26.055 +01:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-03-03 21:19:26.058 +01:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-03-03 21:19:26.058 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-03-03 21:19:26.068 +01:00 [DBG] Starting introspection request.
2019-03-03 21:19:26.081 +01:00 [DBG] Start parsing Basic Authentication secret
2019-03-03 21:19:26.085 +01:00 [DBG] Start parsing for secret in post body
2019-03-03 21:19:26.086 +01:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-03 21:19:26.086 +01:00 [DBG] Secret id found: api1
2019-03-03 21:19:26.098 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-03 21:19:26.098 +01:00 [DBG] API resource validation success
2019-03-03 21:19:26.105 +01:00 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "api1",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLL02LGBL13S:00000001",
  "TimeStamp": "2019-03-03T20:19:26Z",
  "ProcessId": 5164,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-03-03 21:19:26.108 +01:00 [DBG] Introspection request validation started.
2019-03-03 21:19:26.153 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:19:26.159 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:19:26.162 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-03 21:19:26.167 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "498f6deddee6944206301c03deaf99d34d2c3512f4a864fb5614eb90216e3063",
  "Claims": {
    "iss": "http://localhost:49670",
    "nbf": 1551644361,
    "exp": 1551647961,
    "aud": [
      "http://localhost:49670/resources",
      "api1"
    ],
    "client_id": "spa",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551644358,
    "idp": "local",
    "amr": "pwd",
    "Role": [
      "Administrator",
      "Overridden"
    ],
    "Avion": "[\"Pariz\", \"Zagreb\"]",
    "CanRead": "yes",
    "CanWrite": "yes",
    "CanDelete": "yes"
  }
}
2019-03-03 21:19:26.168 +01:00 [DBG] Introspection request validation successful.
2019-03-03 21:19:26.178 +01:00 [DBG] Creating introspection response for active token.
2019-03-03 21:19:26.191 +01:00 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "api1",
  "IsActive": true,
  "Token": "****3063",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr",
    "Role",
    "Avion",
    "CanRead",
    "CanWrite",
    "CanDelete"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "ActivityId": "0HLL02LGBL13S:00000001",
  "TimeStamp": "2019-03-03T20:19:26Z",
  "ProcessId": 5164,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-03-03 21:19:26.191 +01:00 [INF] Success token introspection. Token active: true, for API name: api1
2019-03-03 21:20:20.154 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-03-03 21:20:20.154 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:20:20.154 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:20:20.154 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-03 21:20:20.154 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-03 21:20:20.154 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-03 21:20:20.154 +01:00 [DBG] Start discovery request
2019-03-03 21:20:20.221 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-03-03 21:20:20.222 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:20:20.222 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:20:20.222 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-03 21:20:20.222 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-03 21:20:20.222 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-03 21:20:20.222 +01:00 [DBG] Start key discovery request
2019-03-03 21:20:20.236 +01:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-03-03 21:20:20.237 +01:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-03-03 21:20:20.237 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-03-03 21:20:20.237 +01:00 [DBG] Starting introspection request.
2019-03-03 21:20:20.237 +01:00 [DBG] Start parsing Basic Authentication secret
2019-03-03 21:20:20.237 +01:00 [DBG] Start parsing for secret in post body
2019-03-03 21:20:20.237 +01:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-03 21:20:20.238 +01:00 [DBG] Secret id found: api1
2019-03-03 21:20:20.238 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-03 21:20:20.239 +01:00 [DBG] API resource validation success
2019-03-03 21:20:20.240 +01:00 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "api1",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLL02LGBL13S:00000002",
  "TimeStamp": "2019-03-03T20:20:20Z",
  "ProcessId": 5164,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-03-03 21:20:20.241 +01:00 [DBG] Introspection request validation started.
2019-03-03 21:20:20.270 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:20:20.270 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:20:20.273 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-03 21:20:20.273 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "498f6deddee6944206301c03deaf99d34d2c3512f4a864fb5614eb90216e3063",
  "Claims": {
    "iss": "http://localhost:49670",
    "nbf": 1551644361,
    "exp": 1551647961,
    "aud": [
      "http://localhost:49670/resources",
      "api1"
    ],
    "client_id": "spa",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551644358,
    "idp": "local",
    "amr": "pwd",
    "Role": [
      "Administrator",
      "Overridden"
    ],
    "Avion": "[\"Pariz\", \"Zagreb\"]",
    "CanRead": "yes",
    "CanWrite": "yes",
    "CanDelete": "yes"
  }
}
2019-03-03 21:20:20.274 +01:00 [DBG] Introspection request validation successful.
2019-03-03 21:20:20.274 +01:00 [DBG] Creating introspection response for active token.
2019-03-03 21:20:20.274 +01:00 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "api1",
  "IsActive": true,
  "Token": "****3063",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr",
    "Role",
    "Avion",
    "CanRead",
    "CanWrite",
    "CanDelete"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "ActivityId": "0HLL02LGBL13S:00000002",
  "TimeStamp": "2019-03-03T20:20:20Z",
  "ProcessId": 5164,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-03-03 21:20:20.274 +01:00 [INF] Success token introspection. Token active: true, for API name: api1
2019-03-03 21:20:41.310 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-03-03 21:20:41.310 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:20:41.310 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:20:41.310 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-03 21:20:41.311 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-03 21:20:41.311 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-03 21:20:41.311 +01:00 [DBG] Start discovery request
2019-03-03 21:20:41.394 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-03-03 21:20:41.394 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:20:41.395 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:20:41.395 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-03 21:20:41.395 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-03 21:20:41.395 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-03 21:20:41.395 +01:00 [DBG] Start key discovery request
2019-03-03 21:20:43.832 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:20:43.832 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:20:43.832 +01:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-03-03 21:20:43.833 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-03-03 21:20:43.833 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-03-03 21:20:43.840 +01:00 [DBG] Processing signout request for 39d569af-9766-4a41-a93a-fea76779f9f4
2019-03-03 21:20:43.849 +01:00 [DBG] Start end session request validation
2019-03-03 21:20:43.856 +01:00 [DBG] Start identity token validation
2019-03-03 21:20:43.879 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:20:43.879 +01:00 [DBG] Client found: spa / SPA Client
2019-03-03 21:20:43.936 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-03 21:20:43.936 +01:00 [DBG] Token validation success
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1551644361,
    "exp": 1551644661,
    "iss": "http://localhost:49670",
    "aud": "spa",
    "nonce": "Pt7gcmC6hVF58WlfSIhiJK2ZAGPPP7FmF5fJMYUf",
    "iat": 1551644361,
    "at_hash": "V2E75eWVAe6-5HnZHv4iTQ",
    "sid": "4382bc22782d0d9b89eac27ac5324cec",
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551644358,
    "idp": "local",
    "Role": [
      "Administrator",
      "Overridden"
    ],
    "Avion": "[\"Pariz\", \"Zagreb\"]",
    "CanRead": "yes",
    "CanWrite": "yes",
    "CanDelete": "yes",
    "amr": "pwd"
  }
}
2019-03-03 21:20:43.944 +01:00 [INF] End session request validation failure: Invalid post logout URI
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjQzZmNkNmY1ZmI2MDgwMmYzMjA2OTNjZGY1M2JmYjc3IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NTE2NDQzNjEsImV4cCI6MTU1MTY0NDY2MSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo0OTY3MCIsImF1ZCI6InNwYSIsIm5vbmNlIjoiUHQ3Z2NtQzZoVkY1OFdsZlNJaGlKSzJaQUdQUFA3Rm1GNWZKTVlVZiIsImlhdCI6MTU1MTY0NDM2MSwiYXRfaGFzaCI6IlYyRTc1ZVdWQWU2LTVIblpIdjRpVFEiLCJzaWQiOiI0MzgyYmMyMjc4MmQwZDliODllYWMyN2FjNTMyNGNlYyIsInN1YiI6IjM5ZDU2OWFmLTk3NjYtNGE0MS1hOTNhLWZlYTc2Nzc5ZjlmNCIsImF1dGhfdGltZSI6MTU1MTY0NDM1OCwiaWRwIjoibG9jYWwiLCJSb2xlIjpbIkFkbWluaXN0cmF0b3IiLCJPdmVycmlkZGVuIl0sIkF2aW9uIjoiW1wiUGFyaXpcIiwgXCJaYWdyZWJcIl0iLCJDYW5SZWFkIjoieWVzIiwiQ2FuV3JpdGUiOiJ5ZXMiLCJDYW5EZWxldGUiOiJ5ZXMiLCJhbXIiOlsicHdkIl19.miCXumVadR5mt3LUWW93TstrEvGdAYeJKLgp0xqdLQRPsF_LLi24s3TOA6lB9fnofhoxhP2HPtrEuB0OfJ2eTpDZ3Ot76N2uMHRNQRHL5qLM1d0sipMXl70WLFSHflUWTi_FDXsnOVY73Obrih55rwvpzrP0d_M1OeY8lWWU8Li7b0zPAR2TtBsQPaISRZ87HTJb1L83ojkHwBcxXPqjKlLUhDgk9ou_Way3ZzLa-dIkk7Gto5jI8POsb3ZD47-luk3rC6q-3goQupIF_IZPWVAiG1vRKN81Qgsy2Yy5dPSdFJkXaY5FUNbvEsQJYfNBDXlgA9B83mjarVTY2hWebg",
    "post_logout_redirect_uri": "http://localhost:4200/home"
  }
}
2019-03-03 21:20:43.945 +01:00 [ERR] Error processing end session request Invalid request
2019-03-03 21:20:43.955 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:20:43.955 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:20:44.936 +01:00 [DBG] CORS request made for path: /account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-03-03 21:20:44.937 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:20:44.937 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:20:44.938 +01:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-03-03 21:20:44.938 +01:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-03-03 21:20:44.938 +01:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-03-03 21:20:44.938 +01:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "Administrator",
  "ActivityId": "0HLL02LGBL13P:00000020",
  "TimeStamp": "2019-03-03T20:20:44Z",
  "ProcessId": 5164,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-03-03 21:20:44.981 +01:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-03-03 21:20:44.985 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-03-03 21:20:44.985 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-03-03 21:20:44.991 +01:00 [DBG] Processing signout callback request
2019-03-03 21:20:45.008 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:20:45.008 +01:00 [DBG] No client front-channel logout URLs
2019-03-03 21:20:45.008 +01:00 [DBG] No client back-channel logout URLs
2019-03-03 21:20:45.008 +01:00 [INF] Successful signout callback.
2019-03-03 21:20:45.008 +01:00 [DBG] No client front-channel iframe urls
2019-03-03 21:20:45.008 +01:00 [DBG] No client back-channel iframe urls
2019-03-03 21:20:47.838 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-03-03 21:20:47.839 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:20:47.839 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:20:47.839 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-03 21:20:47.839 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-03 21:20:47.839 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-03 21:20:47.839 +01:00 [DBG] Start discovery request
2019-03-03 21:20:47.927 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-03-03 21:20:47.927 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:20:47.927 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:20:47.927 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-03 21:20:47.928 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-03 21:20:47.928 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-03 21:20:47.928 +01:00 [DBG] Start key discovery request
2019-03-03 21:20:48.527 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-03 21:20:48.528 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-03 21:20:48.528 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-03 21:20:48.528 +01:00 [DBG] Start authorize request
2019-03-03 21:20:48.528 +01:00 [DBG] No user present in authorize request
2019-03-03 21:20:48.528 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:20:48.528 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:20:48.528 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:20:48.529 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "OHQktA8SzxgRyabkAKmFwrT8T4ELFPnbAjwVfkJj",
  "Nonce": "OHQktA8SzxgRyabkAKmFwrT8T4ELFPnbAjwVfkJj",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "OHQktA8SzxgRyabkAKmFwrT8T4ELFPnbAjwVfkJj",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "OHQktA8SzxgRyabkAKmFwrT8T4ELFPnbAjwVfkJj"
  }
}
2019-03-03 21:20:48.529 +01:00 [INF] Showing login: User is not authenticated
2019-03-03 21:20:48.536 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:20:48.536 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:20:48.537 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:20:48.537 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:20:51.268 +01:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-03-03 21:20:51.299 +01:00 [DBG] Augmenting SignInContext
2019-03-03 21:20:51.299 +01:00 [DBG] Adding idp claim with value: local
2019-03-03 21:20:51.299 +01:00 [DBG] Adding amr claim with value: pwd
2019-03-03 21:20:51.299 +01:00 [DBG] Adding auth_time claim with value: 1551644451
2019-03-03 21:20:51.300 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-03 21:20:51.301 +01:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "admin",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "DisplayName": "admin",
  "Endpoint": "UI",
  "ActivityId": "0HLL02LGBL13P:00000024",
  "TimeStamp": "2019-03-03T20:20:51Z",
  "ProcessId": 5164,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-03-03 21:20:51.307 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:20:51.307 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:20:51.307 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-03 21:20:51.307 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-03 21:20:51.307 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-03 21:20:51.307 +01:00 [DBG] Start authorize callback request
2019-03-03 21:20:51.307 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-03-03 21:20:51.307 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:20:51.307 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:20:51.308 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:20:51.308 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "OHQktA8SzxgRyabkAKmFwrT8T4ELFPnbAjwVfkJj",
  "Nonce": "OHQktA8SzxgRyabkAKmFwrT8T4ELFPnbAjwVfkJj",
  "SessionId": "254d2ba0c57bf631c806dce32d889640",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "OHQktA8SzxgRyabkAKmFwrT8T4ELFPnbAjwVfkJj",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "OHQktA8SzxgRyabkAKmFwrT8T4ELFPnbAjwVfkJj"
  }
}
2019-03-03 21:20:51.310 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-03-03 21:20:51.311 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-03-03 21:20:51.311 +01:00 [INF] Showing consent: User has not yet consented
2019-03-03 21:20:51.316 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:20:51.316 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:20:51.316 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:20:51.316 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:20:51.317 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:20:51.317 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:20:52.810 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-03-03 21:20:52.811 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:20:52.811 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:20:52.812 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:20:52.812 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:20:52.813 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:20:52.820 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:20:52.820 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:20:52.820 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-03 21:20:52.820 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-03 21:20:52.820 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-03 21:20:52.820 +01:00 [DBG] Start authorize callback request
2019-03-03 21:20:52.820 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-03-03 21:20:52.820 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:20:52.820 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:20:52.821 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:20:52.821 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "OHQktA8SzxgRyabkAKmFwrT8T4ELFPnbAjwVfkJj",
  "Nonce": "OHQktA8SzxgRyabkAKmFwrT8T4ELFPnbAjwVfkJj",
  "SessionId": "254d2ba0c57bf631c806dce32d889640",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "OHQktA8SzxgRyabkAKmFwrT8T4ELFPnbAjwVfkJj",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "OHQktA8SzxgRyabkAKmFwrT8T4ELFPnbAjwVfkJj"
  }
}
2019-03-03 21:20:52.823 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-03-03 21:20:52.823 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-03-03 21:20:52.824 +01:00 [INF] User consented to scopes: ["openid","profile","api1"]
2019-03-03 21:20:52.824 +01:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-03-03 21:20:52.824 +01:00 [DBG] Creating Implicit Flow response.
2019-03-03 21:20:52.824 +01:00 [DBG] Getting claims for access token for client: spa
2019-03-03 21:20:52.824 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-03-03 21:20:52.837 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-03-03 21:20:52.845 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****k-ZQ"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****11e5"
    }
  ],
  "ActivityId": "0HLL02LGBL13P:00000028",
  "TimeStamp": "2019-03-03T20:20:52Z",
  "ProcessId": 5164,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-03-03 21:20:52.845 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "OHQktA8SzxgRyabkAKmFwrT8T4ELFPnbAjwVfkJj",
  "Scope": "openid profile api1"
}
2019-03-03 21:20:52.845 +01:00 [DBG] Augmenting SignInContext
2019-03-03 21:20:52.846 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-03 21:20:53.667 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-03-03 21:20:53.667 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:20:53.667 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:20:53.668 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-03 21:20:53.668 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-03 21:20:53.668 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-03 21:20:53.668 +01:00 [DBG] Start discovery request
2019-03-03 21:20:53.743 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-03-03 21:20:53.743 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:20:53.743 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:20:53.743 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-03 21:20:53.744 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-03 21:20:53.744 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-03 21:20:53.744 +01:00 [DBG] Start key discovery request
2019-03-03 21:20:55.162 +01:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-03-03 21:20:55.163 +01:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-03-03 21:20:55.163 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-03-03 21:20:55.163 +01:00 [DBG] Starting introspection request.
2019-03-03 21:20:55.163 +01:00 [DBG] Start parsing Basic Authentication secret
2019-03-03 21:20:55.163 +01:00 [DBG] Start parsing for secret in post body
2019-03-03 21:20:55.163 +01:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-03 21:20:55.164 +01:00 [DBG] Secret id found: api1
2019-03-03 21:20:55.164 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-03 21:20:55.164 +01:00 [DBG] API resource validation success
2019-03-03 21:20:55.164 +01:00 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "api1",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLL02LGBL13S:00000003",
  "TimeStamp": "2019-03-03T20:20:55Z",
  "ProcessId": 5164,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-03-03 21:20:55.164 +01:00 [DBG] Introspection request validation started.
2019-03-03 21:20:55.182 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:20:55.182 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:20:55.186 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-03 21:20:55.186 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "9fdab47d0b1f3bea4b6734c06d06a88cd719e8e477332bc7d080c0af546511e5",
  "Claims": {
    "iss": "http://localhost:49670",
    "nbf": 1551644452,
    "exp": 1551648052,
    "aud": [
      "http://localhost:49670/resources",
      "api1"
    ],
    "client_id": "spa",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551644451,
    "idp": "local",
    "amr": "pwd",
    "Role": [
      "Administrator",
      "Overridden"
    ],
    "Avion": "[\"Pariz\", \"Zagreb\"]",
    "CanRead": "yes",
    "CanWrite": "yes",
    "CanDelete": "yes"
  }
}
2019-03-03 21:20:55.186 +01:00 [DBG] Introspection request validation successful.
2019-03-03 21:20:55.186 +01:00 [DBG] Creating introspection response for active token.
2019-03-03 21:20:55.186 +01:00 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "api1",
  "IsActive": true,
  "Token": "****11e5",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr",
    "Role",
    "Avion",
    "CanRead",
    "CanWrite",
    "CanDelete"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "ActivityId": "0HLL02LGBL13S:00000003",
  "TimeStamp": "2019-03-03T20:20:55Z",
  "ProcessId": 5164,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-03-03 21:20:55.186 +01:00 [INF] Success token introspection. Token active: true, for API name: api1
2019-03-03 21:21:17.844 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-03 21:21:17.896 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-03-03 21:21:17.900 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-03-03 21:21:17.901 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-03-03 21:21:17.901 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-03-03 21:21:17.902 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-03-03 21:21:21.926 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-03-03 21:21:21.939 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:21:21.940 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:21:22.094 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-03 21:21:22.284 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-03 21:21:22.285 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-03 21:21:22.290 +01:00 [DBG] Start discovery request
2019-03-03 21:21:22.516 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-03-03 21:21:22.517 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:21:22.517 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:21:22.523 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-03 21:21:22.525 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-03 21:21:22.526 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-03 21:21:22.532 +01:00 [DBG] Start key discovery request
2019-03-03 21:21:22.807 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:21:22.809 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:21:22.811 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-03 21:21:22.817 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-03 21:21:22.817 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-03 21:21:22.821 +01:00 [DBG] Start authorize request
2019-03-03 21:21:22.848 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-03-03 21:21:22.854 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:21:22.871 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:21:22.929 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:21:22.952 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "3kc3evkG0vlv71uOSjYAZmk7bbvYLt6whjbUszyv",
  "Nonce": "3kc3evkG0vlv71uOSjYAZmk7bbvYLt6whjbUszyv",
  "SessionId": "254d2ba0c57bf631c806dce32d889640",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "3kc3evkG0vlv71uOSjYAZmk7bbvYLt6whjbUszyv",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "3kc3evkG0vlv71uOSjYAZmk7bbvYLt6whjbUszyv"
  }
}
2019-03-03 21:21:24.594 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-03-03 21:21:24.595 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-03-03 21:21:24.595 +01:00 [INF] Showing consent: User has not yet consented
2019-03-03 21:21:24.618 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:21:24.619 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:21:25.147 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:21:25.148 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:21:25.149 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:21:25.151 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:21:37.857 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-03-03 21:21:37.858 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:21:37.858 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:21:38.036 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:21:38.036 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:21:38.036 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:21:38.092 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:21:38.092 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:21:38.092 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-03 21:21:38.093 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-03 21:21:38.093 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-03 21:21:38.099 +01:00 [DBG] Start authorize callback request
2019-03-03 21:21:38.138 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-03-03 21:21:38.138 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:21:38.138 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:21:38.138 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:21:38.138 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "3kc3evkG0vlv71uOSjYAZmk7bbvYLt6whjbUszyv",
  "Nonce": "3kc3evkG0vlv71uOSjYAZmk7bbvYLt6whjbUszyv",
  "SessionId": "254d2ba0c57bf631c806dce32d889640",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "3kc3evkG0vlv71uOSjYAZmk7bbvYLt6whjbUszyv",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "3kc3evkG0vlv71uOSjYAZmk7bbvYLt6whjbUszyv"
  }
}
2019-03-03 21:21:38.152 +01:00 [DBG] user_consent grant with value: spa|39d569af-9766-4a41-a93a-fea76779f9f4 not found in store.
2019-03-03 21:21:38.152 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-03-03 21:21:38.164 +01:00 [INF] User consented to scopes: ["openid","profile","api1"]
2019-03-03 21:21:38.179 +01:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-03-03 21:21:38.192 +01:00 [DBG] Creating Implicit Flow response.
2019-03-03 21:21:38.206 +01:00 [DBG] Getting claims for access token for client: spa
2019-03-03 21:21:38.206 +01:00 [DBG] Getting claims for access token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-03-03 21:21:38.435 +01:00 [DBG] Getting claims for identity token for subject: 39d569af-9766-4a41-a93a-fea76779f9f4 and client: spa
2019-03-03 21:21:38.552 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****Xq9w"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****7b6b"
    }
  ],
  "ActivityId": "0HLL02N5JH0S2:00000004",
  "TimeStamp": "2019-03-03T20:21:38Z",
  "ProcessId": 2988,
  "LocalIpAddress": "127.0.0.1:49670",
  "RemoteIpAddress": "127.0.0.1"
}
2019-03-03 21:21:38.558 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "3kc3evkG0vlv71uOSjYAZmk7bbvYLt6whjbUszyv",
  "Scope": "openid profile api1"
}
2019-03-03 21:21:39.664 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-03-03 21:21:39.664 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:21:39.664 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:21:39.664 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-03 21:21:39.665 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-03 21:21:39.665 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-03 21:21:39.665 +01:00 [DBG] Start discovery request
2019-03-03 21:21:39.740 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-03-03 21:21:39.740 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:21:39.740 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:21:39.740 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-03 21:21:39.741 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-03 21:21:39.741 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-03 21:21:39.741 +01:00 [DBG] Start key discovery request
2019-03-03 21:21:41.049 +01:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-03-03 21:21:41.052 +01:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-03-03 21:21:41.052 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-03-03 21:21:41.063 +01:00 [DBG] Starting introspection request.
2019-03-03 21:21:41.077 +01:00 [DBG] Start parsing Basic Authentication secret
2019-03-03 21:21:41.081 +01:00 [DBG] Start parsing for secret in post body
2019-03-03 21:21:41.082 +01:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-03 21:21:41.082 +01:00 [DBG] Secret id found: api1
2019-03-03 21:21:41.094 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-03 21:21:41.094 +01:00 [DBG] API resource validation success
2019-03-03 21:21:41.101 +01:00 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "api1",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLL02N5JH0S4:00000001",
  "TimeStamp": "2019-03-03T20:21:41Z",
  "ProcessId": 2988,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-03-03 21:21:41.105 +01:00 [DBG] Introspection request validation started.
2019-03-03 21:21:41.149 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:21:41.155 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:21:41.158 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-03 21:21:41.163 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "3375022a304b9fe99dd795f813bd3d6ddf20e3c1016f728d7f244626dc5c7b6b",
  "Claims": {
    "iss": "http://localhost:49670",
    "nbf": 1551644498,
    "exp": 1551648098,
    "aud": [
      "http://localhost:49670/resources",
      "api1"
    ],
    "client_id": "spa",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "sub": "39d569af-9766-4a41-a93a-fea76779f9f4",
    "auth_time": 1551644451,
    "idp": "local",
    "amr": "pwd",
    "Role": [
      "Administrator",
      "Overridden"
    ],
    "Avion": "[\"Pariz\", \"Zagreb\"]",
    "CanRead": "yes",
    "CanWrite": "yes",
    "CanDelete": "no"
  }
}
2019-03-03 21:21:41.164 +01:00 [DBG] Introspection request validation successful.
2019-03-03 21:21:41.175 +01:00 [DBG] Creating introspection response for active token.
2019-03-03 21:21:41.186 +01:00 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "api1",
  "IsActive": true,
  "Token": "****7b6b",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr",
    "Role",
    "Avion",
    "CanRead",
    "CanWrite",
    "CanDelete"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "ActivityId": "0HLL02N5JH0S4:00000001",
  "TimeStamp": "2019-03-03T20:21:41Z",
  "ProcessId": 2988,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-03-03 21:21:41.187 +01:00 [INF] Success token introspection. Token active: true, for API name: api1
2019-03-03 21:40:46.912 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-03 21:40:46.968 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-03-03 21:40:46.975 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-03-03 21:40:46.978 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-03-03 21:40:46.982 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-03-03 21:40:46.986 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-03-03 21:41:37.954 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-03 21:41:38.010 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-03-03 21:41:38.015 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-03-03 21:41:38.016 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-03-03 21:41:38.016 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-03-03 21:41:38.017 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-03-03 21:41:45.441 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-03-03 21:41:45.454 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:41:45.454 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:41:45.626 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-03 21:41:45.824 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-03 21:41:45.824 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-03 21:41:45.829 +01:00 [DBG] Start discovery request
2019-03-03 21:41:46.046 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-03-03 21:41:46.046 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:41:46.046 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:41:46.048 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-03 21:41:46.051 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-03 21:41:46.051 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-03 21:41:46.057 +01:00 [DBG] Start key discovery request
2019-03-03 21:41:53.988 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:41:53.991 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:41:53.992 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-03 21:41:54.000 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-03 21:41:54.000 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-03 21:41:54.005 +01:00 [DBG] Start authorize request
2019-03-03 21:41:54.028 +01:00 [DBG] User in authorize request: 39d569af-9766-4a41-a93a-fea76779f9f4
2019-03-03 21:41:54.033 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:41:54.050 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:41:54.102 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:41:54.122 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "39d569af-9766-4a41-a93a-fea76779f9f4",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "N8VslqxBVmblKlBMzaBVdwmW6kYwOkwmcnTi99w2",
  "Nonce": "N8VslqxBVmblKlBMzaBVdwmW6kYwOkwmcnTi99w2",
  "SessionId": "254d2ba0c57bf631c806dce32d889640",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "N8VslqxBVmblKlBMzaBVdwmW6kYwOkwmcnTi99w2",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "N8VslqxBVmblKlBMzaBVdwmW6kYwOkwmcnTi99w2"
  }
}
2019-03-03 21:41:55.702 +01:00 [INF] Showing login: User is not active
2019-03-03 21:41:55.725 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:41:55.725 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:41:56.216 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:41:56.218 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:41:56.219 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:41:56.223 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:42:36.476 +01:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-03-03 21:42:36.477 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:42:36.477 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:42:37.184 +01:00 [DBG] Augmenting SignInContext
2019-03-03 21:42:37.187 +01:00 [DBG] Adding idp claim with value: local
2019-03-03 21:42:37.187 +01:00 [DBG] Adding amr claim with value: pwd
2019-03-03 21:42:37.187 +01:00 [DBG] Adding auth_time claim with value: 1551645757
2019-03-03 21:42:37.245 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-03 21:42:37.294 +01:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "admin",
  "SubjectId": "c569db1d-6a57-4136-b3a2-ae35f98880b8",
  "DisplayName": "admin",
  "Endpoint": "UI",
  "ActivityId": "0HLL032J79OU2:00000003",
  "TimeStamp": "2019-03-03T20:42:37Z",
  "ProcessId": 3300,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-03-03 21:42:37.309 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:42:37.309 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:42:37.309 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-03 21:42:37.310 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-03 21:42:37.310 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-03 21:42:37.317 +01:00 [DBG] Start authorize callback request
2019-03-03 21:42:37.322 +01:00 [DBG] User in authorize request: c569db1d-6a57-4136-b3a2-ae35f98880b8
2019-03-03 21:42:37.322 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:42:37.322 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:42:37.323 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:42:37.323 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "c569db1d-6a57-4136-b3a2-ae35f98880b8",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "N8VslqxBVmblKlBMzaBVdwmW6kYwOkwmcnTi99w2",
  "Nonce": "N8VslqxBVmblKlBMzaBVdwmW6kYwOkwmcnTi99w2",
  "SessionId": "4bd20998f5716f4b1b39556d684bc4e7",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "N8VslqxBVmblKlBMzaBVdwmW6kYwOkwmcnTi99w2",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "N8VslqxBVmblKlBMzaBVdwmW6kYwOkwmcnTi99w2"
  }
}
2019-03-03 21:42:37.355 +01:00 [DBG] user_consent grant with value: spa|c569db1d-6a57-4136-b3a2-ae35f98880b8 not found in store.
2019-03-03 21:42:37.356 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-03-03 21:42:37.356 +01:00 [INF] Showing consent: User has not yet consented
2019-03-03 21:42:37.362 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:42:37.362 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:42:37.407 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:42:37.407 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:42:37.407 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:42:37.408 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:42:40.573 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-03-03 21:42:40.573 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:42:40.574 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:42:40.611 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:42:40.611 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:42:40.611 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:42:40.642 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:42:40.642 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:42:40.642 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-03 21:42:40.643 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-03 21:42:40.643 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-03 21:42:40.643 +01:00 [DBG] Start authorize callback request
2019-03-03 21:42:40.686 +01:00 [DBG] User in authorize request: c569db1d-6a57-4136-b3a2-ae35f98880b8
2019-03-03 21:42:40.686 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:42:40.686 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:42:40.687 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:42:40.687 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "c569db1d-6a57-4136-b3a2-ae35f98880b8",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "N8VslqxBVmblKlBMzaBVdwmW6kYwOkwmcnTi99w2",
  "Nonce": "N8VslqxBVmblKlBMzaBVdwmW6kYwOkwmcnTi99w2",
  "SessionId": "4bd20998f5716f4b1b39556d684bc4e7",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "N8VslqxBVmblKlBMzaBVdwmW6kYwOkwmcnTi99w2",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "N8VslqxBVmblKlBMzaBVdwmW6kYwOkwmcnTi99w2"
  }
}
2019-03-03 21:42:40.691 +01:00 [DBG] user_consent grant with value: spa|c569db1d-6a57-4136-b3a2-ae35f98880b8 not found in store.
2019-03-03 21:42:40.692 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-03-03 21:42:40.706 +01:00 [INF] User consented to scopes: ["openid","profile","api1"]
2019-03-03 21:42:40.723 +01:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: c569db1d-6a57-4136-b3a2-ae35f98880b8
2019-03-03 21:42:40.737 +01:00 [DBG] Creating Implicit Flow response.
2019-03-03 21:42:40.753 +01:00 [DBG] Getting claims for access token for client: spa
2019-03-03 21:42:40.754 +01:00 [DBG] Getting claims for access token for subject: c569db1d-6a57-4136-b3a2-ae35f98880b8
2019-03-03 21:42:40.815 +01:00 [DBG] Getting claims for identity token for subject: c569db1d-6a57-4136-b3a2-ae35f98880b8 and client: spa
2019-03-03 21:42:40.914 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "c569db1d-6a57-4136-b3a2-ae35f98880b8",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****583A"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****4977"
    }
  ],
  "ActivityId": "0HLL032J79OU2:00000007",
  "TimeStamp": "2019-03-03T20:42:40Z",
  "ProcessId": 3300,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-03-03 21:42:40.920 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "c569db1d-6a57-4136-b3a2-ae35f98880b8",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "N8VslqxBVmblKlBMzaBVdwmW6kYwOkwmcnTi99w2",
  "Scope": "openid profile api1"
}
2019-03-03 21:42:40.946 +01:00 [DBG] Augmenting SignInContext
2019-03-03 21:42:40.946 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-03 21:42:42.054 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-03-03 21:42:42.054 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:42:42.054 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:42:42.055 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-03 21:42:42.055 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-03 21:42:42.055 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-03 21:42:42.055 +01:00 [DBG] Start discovery request
2019-03-03 21:42:42.138 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-03-03 21:42:42.138 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:42:42.138 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:42:42.139 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-03 21:42:42.139 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-03 21:42:42.139 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-03 21:42:42.139 +01:00 [DBG] Start key discovery request
2019-03-03 21:42:44.032 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-03 21:42:44.033 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-03 21:42:44.033 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-03 21:42:44.033 +01:00 [DBG] Start discovery request
2019-03-03 21:42:44.071 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-03 21:42:44.071 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-03 21:42:44.071 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-03 21:42:44.072 +01:00 [DBG] Start key discovery request
2019-03-03 21:42:44.173 +01:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-03-03 21:42:44.176 +01:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-03-03 21:42:44.176 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-03-03 21:42:44.186 +01:00 [DBG] Starting introspection request.
2019-03-03 21:42:44.199 +01:00 [DBG] Start parsing Basic Authentication secret
2019-03-03 21:42:44.204 +01:00 [DBG] Start parsing for secret in post body
2019-03-03 21:42:44.204 +01:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-03 21:42:44.204 +01:00 [DBG] Secret id found: api1
2019-03-03 21:42:44.216 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-03 21:42:44.216 +01:00 [DBG] API resource validation success
2019-03-03 21:42:44.223 +01:00 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "api1",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLL032J79OU4:00000001",
  "TimeStamp": "2019-03-03T20:42:44Z",
  "ProcessId": 3300,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-03-03 21:42:44.227 +01:00 [DBG] Introspection request validation started.
2019-03-03 21:42:44.272 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:42:44.278 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:42:44.281 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-03 21:42:44.286 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "a513920b30847be3621845ff45e1f52e26a378610a7959919428d28b470e4977",
  "Claims": {
    "iss": "http://localhost:49670",
    "nbf": 1551645760,
    "exp": 1551649360,
    "aud": [
      "http://localhost:49670/resources",
      "api1"
    ],
    "client_id": "spa",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "sub": "c569db1d-6a57-4136-b3a2-ae35f98880b8",
    "auth_time": 1551645757,
    "idp": "local",
    "amr": "pwd",
    "Role": [
      "Administrator",
      "Overridden"
    ],
    "Avion": "[\"Pariz\", \"Zagreb\"]",
    "CanRead": "yes",
    "CanWrite": "yes"
  }
}
2019-03-03 21:42:44.287 +01:00 [DBG] Introspection request validation successful.
2019-03-03 21:42:44.297 +01:00 [DBG] Creating introspection response for active token.
2019-03-03 21:42:44.310 +01:00 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "api1",
  "IsActive": true,
  "Token": "****4977",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr",
    "Role",
    "Avion",
    "CanRead",
    "CanWrite"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "ActivityId": "0HLL032J79OU4:00000001",
  "TimeStamp": "2019-03-03T20:42:44Z",
  "ProcessId": 3300,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-03-03 21:42:44.310 +01:00 [INF] Success token introspection. Token active: true, for API name: api1
2019-03-03 21:56:31.241 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-03 21:56:31.312 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-03-03 21:56:31.317 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-03-03 21:56:31.317 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-03-03 21:56:31.318 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-03-03 21:56:31.318 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-03-03 21:56:32.136 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-03-03 21:56:32.147 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:56:32.147 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:56:32.292 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-03 21:56:32.469 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-03 21:56:32.469 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-03 21:56:32.474 +01:00 [DBG] Start discovery request
2019-03-03 21:56:32.690 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-03-03 21:56:32.690 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:56:32.690 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:56:32.692 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-03 21:56:32.700 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-03 21:56:32.700 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-03 21:56:32.705 +01:00 [DBG] Start key discovery request
2019-03-03 21:56:36.128 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-03-03 21:56:36.128 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:56:36.128 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:56:36.128 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-03 21:56:36.129 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-03 21:56:36.129 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-03 21:56:36.129 +01:00 [DBG] Start discovery request
2019-03-03 21:56:36.213 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-03-03 21:56:36.213 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:56:36.213 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:56:36.214 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-03 21:56:36.214 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-03 21:56:36.214 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-03 21:56:36.214 +01:00 [DBG] Start key discovery request
2019-03-03 21:56:38.087 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:56:38.089 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:56:38.090 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-03 21:56:38.096 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-03 21:56:38.096 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-03 21:56:38.101 +01:00 [DBG] Start authorize request
2019-03-03 21:56:38.124 +01:00 [DBG] User in authorize request: c569db1d-6a57-4136-b3a2-ae35f98880b8
2019-03-03 21:56:38.131 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:56:38.148 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:56:38.205 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:56:38.226 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "c569db1d-6a57-4136-b3a2-ae35f98880b8",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "KQDhzUeWX0KQGZ2GfHNlK9IjhOAsZe6zOUVe3xKn",
  "Nonce": "KQDhzUeWX0KQGZ2GfHNlK9IjhOAsZe6zOUVe3xKn",
  "SessionId": "4bd20998f5716f4b1b39556d684bc4e7",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "KQDhzUeWX0KQGZ2GfHNlK9IjhOAsZe6zOUVe3xKn",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "KQDhzUeWX0KQGZ2GfHNlK9IjhOAsZe6zOUVe3xKn"
  }
}
2019-03-03 21:56:39.855 +01:00 [DBG] user_consent grant with value: spa|c569db1d-6a57-4136-b3a2-ae35f98880b8 not found in store.
2019-03-03 21:56:39.855 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-03-03 21:56:39.855 +01:00 [INF] Showing consent: User has not yet consented
2019-03-03 21:56:39.878 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:56:39.878 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:56:40.403 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:56:40.405 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:56:40.405 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:56:40.407 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:56:51.669 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:56:51.670 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:56:52.800 +01:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-03-03 21:56:52.801 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:56:52.801 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 21:56:53.008 +01:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-03-03 21:56:53.010 +01:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-03-03 21:56:53.011 +01:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-03-03 21:56:53.053 +01:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "c569db1d-6a57-4136-b3a2-ae35f98880b8",
  "DisplayName": "Administrator",
  "ActivityId": "0HLL03ARFR44H:00000004",
  "TimeStamp": "2019-03-03T20:56:53Z",
  "ProcessId": 7076,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-03-03 21:56:53.326 +01:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-03-03 21:56:53.332 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-03-03 21:56:53.332 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-03-03 21:56:53.338 +01:00 [DBG] Processing signout callback request
2019-03-03 21:56:53.385 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:56:53.385 +01:00 [DBG] No client front-channel logout URLs
2019-03-03 21:56:53.386 +01:00 [DBG] No client back-channel logout URLs
2019-03-03 21:56:53.386 +01:00 [INF] Successful signout callback.
2019-03-03 21:56:53.386 +01:00 [DBG] No client front-channel iframe urls
2019-03-03 21:56:53.386 +01:00 [DBG] No client back-channel iframe urls
2019-03-03 21:56:56.825 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-03-03 21:56:56.825 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:56:56.825 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:56:56.825 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-03 21:56:56.826 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-03 21:56:56.826 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-03 21:56:56.826 +01:00 [DBG] Start discovery request
2019-03-03 21:56:56.904 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-03-03 21:56:56.904 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 21:56:56.904 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 21:56:56.904 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-03 21:56:56.905 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-03 21:56:56.905 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-03 21:56:56.905 +01:00 [DBG] Start key discovery request
2019-03-03 21:56:57.912 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-03 21:56:57.913 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-03 21:56:57.913 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-03 21:56:57.913 +01:00 [DBG] Start authorize request
2019-03-03 21:56:57.915 +01:00 [DBG] No user present in authorize request
2019-03-03 21:56:57.915 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:56:57.917 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:56:57.917 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:56:57.917 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "qySZkLY8cV7zim56u4FFGyixzJO4Os5V0EJYwwgL",
  "Nonce": "qySZkLY8cV7zim56u4FFGyixzJO4Os5V0EJYwwgL",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "qySZkLY8cV7zim56u4FFGyixzJO4Os5V0EJYwwgL",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "qySZkLY8cV7zim56u4FFGyixzJO4Os5V0EJYwwgL"
  }
}
2019-03-03 21:56:57.918 +01:00 [INF] Showing login: User is not authenticated
2019-03-03 21:56:57.939 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 21:56:57.939 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 21:56:57.939 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 21:56:57.942 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 22:01:12.267 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 22:01:12.267 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 22:01:12.267 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 22:01:12.267 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 22:01:53.590 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-03-03 22:01:53.590 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 22:01:53.590 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 22:01:53.591 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-03 22:01:53.591 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-03 22:01:53.591 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-03 22:01:53.591 +01:00 [DBG] Start discovery request
2019-03-03 22:01:53.676 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-03-03 22:01:53.676 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 22:01:53.676 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 22:01:53.676 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-03 22:01:53.676 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-03 22:01:53.677 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-03 22:01:53.677 +01:00 [DBG] Start key discovery request
2019-03-03 22:01:54.540 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-03 22:01:54.540 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-03 22:01:54.540 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-03 22:01:54.540 +01:00 [DBG] Start authorize request
2019-03-03 22:01:54.540 +01:00 [DBG] No user present in authorize request
2019-03-03 22:01:54.540 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 22:01:54.540 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 22:01:54.541 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 22:01:54.541 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "nxWeSUjbREBoCeEsFYGZec8WrBsITfVUCtZs4eRR",
  "Nonce": "nxWeSUjbREBoCeEsFYGZec8WrBsITfVUCtZs4eRR",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "nxWeSUjbREBoCeEsFYGZec8WrBsITfVUCtZs4eRR",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "nxWeSUjbREBoCeEsFYGZec8WrBsITfVUCtZs4eRR"
  }
}
2019-03-03 22:01:54.541 +01:00 [INF] Showing login: User is not authenticated
2019-03-03 22:01:54.547 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 22:01:54.547 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 22:01:54.547 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 22:01:54.547 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 22:01:57.857 +01:00 [ERR] An unhandled exception has occurred while executing the request
System.ArgumentNullException: Value cannot be null.
Parameter name: user
   at Microsoft.AspNetCore.Identity.UserClaimsPrincipalFactory`1.CreateAsync(TUser user)
   at IdentityServer4.AspNetIdentity.UserClaimsFactory`1.CreateAsync(TUser user) in C:\local\identity\server4\AspNetIdentity\src\IdentityServer4.AspNetIdentity\UserClaimsFactory.cs:line 28
   at Microsoft.AspNetCore.Identity.SignInManager`1.CreateUserPrincipalAsync(TUser user)
   at Microsoft.AspNetCore.Identity.SignInManager`1.SignInAsync(TUser user, AuthenticationProperties authenticationProperties, String authenticationMethod)
   at IdentityServer4.Quickstart.UI.AccountController.LoginTest(String returnUrl) in E:\identityserver4-ang6-oauth2-mssql-implicit\AuthServer\Quickstart\Account\AccountController.cs:line 56
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-03-03 22:02:42.664 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-03-03 22:02:42.714 +01:00 [DBG] Using Identity.Application as default scheme for authentication
2019-03-03 22:02:42.718 +01:00 [DBG] Using Identity.External as default scheme for sign-in
2019-03-03 22:02:42.719 +01:00 [DBG] Using Identity.External as default scheme for sign-out
2019-03-03 22:02:42.719 +01:00 [DBG] Using Identity.Application as default scheme for challenge
2019-03-03 22:02:42.720 +01:00 [DBG] Using Identity.Application as default scheme for forbid
2019-03-03 22:02:44.693 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-03-03 22:02:44.705 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 22:02:44.705 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 22:02:44.862 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-03 22:02:45.065 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-03 22:02:45.066 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-03 22:02:45.070 +01:00 [DBG] Start discovery request
2019-03-03 22:02:45.292 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-03-03 22:02:45.292 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 22:02:45.292 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 22:02:45.293 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-03 22:02:45.294 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-03 22:02:45.294 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-03 22:02:45.300 +01:00 [DBG] Start key discovery request
2019-03-03 22:02:46.200 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-03-03 22:02:46.207 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-03-03 22:02:46.207 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-03-03 22:02:46.212 +01:00 [DBG] Start authorize request
2019-03-03 22:02:46.234 +01:00 [DBG] No user present in authorize request
2019-03-03 22:02:46.241 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 22:02:46.262 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 22:02:46.319 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 22:02:46.341 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "DqECWFFktlU03Bci0faLCm2WtWY6uz4FBCQWq4PO",
  "Nonce": "DqECWFFktlU03Bci0faLCm2WtWY6uz4FBCQWq4PO",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "DqECWFFktlU03Bci0faLCm2WtWY6uz4FBCQWq4PO",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "DqECWFFktlU03Bci0faLCm2WtWY6uz4FBCQWq4PO"
  }
}
2019-03-03 22:02:46.351 +01:00 [INF] Showing login: User is not authenticated
2019-03-03 22:02:46.867 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 22:02:46.868 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 22:02:46.869 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 22:02:46.873 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 22:03:00.690 +01:00 [DBG] Augmenting SignInContext
2019-03-03 22:03:00.692 +01:00 [DBG] Adding idp claim with value: local
2019-03-03 22:03:00.692 +01:00 [DBG] Adding amr claim with value: pwd
2019-03-03 22:03:00.693 +01:00 [DBG] Adding auth_time claim with value: 1551646980
2019-03-03 22:03:00.759 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-03 22:03:00.804 +01:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "admin",
  "SubjectId": "c569db1d-6a57-4136-b3a2-ae35f98880b8",
  "DisplayName": "admin",
  "Endpoint": "UI",
  "ActivityId": "0HLL03EAGEVVT:00000003",
  "TimeStamp": "2019-03-03T21:03:00Z",
  "ProcessId": 5704,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-03-03 22:03:00.840 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 22:03:00.841 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 22:03:00.842 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-03 22:03:00.842 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-03 22:03:00.843 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-03 22:03:00.851 +01:00 [DBG] Start authorize callback request
2019-03-03 22:03:00.856 +01:00 [DBG] User in authorize request: c569db1d-6a57-4136-b3a2-ae35f98880b8
2019-03-03 22:03:00.857 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 22:03:00.857 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 22:03:00.857 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 22:03:00.857 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "c569db1d-6a57-4136-b3a2-ae35f98880b8",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "DqECWFFktlU03Bci0faLCm2WtWY6uz4FBCQWq4PO",
  "Nonce": "DqECWFFktlU03Bci0faLCm2WtWY6uz4FBCQWq4PO",
  "SessionId": "c63870407bed7c2ea4c10662280f37ab",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "DqECWFFktlU03Bci0faLCm2WtWY6uz4FBCQWq4PO",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "DqECWFFktlU03Bci0faLCm2WtWY6uz4FBCQWq4PO"
  }
}
2019-03-03 22:03:00.929 +01:00 [DBG] user_consent grant with value: spa|c569db1d-6a57-4136-b3a2-ae35f98880b8 not found in store.
2019-03-03 22:03:00.929 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-03-03 22:03:00.929 +01:00 [INF] Showing consent: User has not yet consented
2019-03-03 22:03:00.936 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 22:03:00.936 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 22:03:00.986 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 22:03:00.987 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 22:03:00.987 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 22:03:00.987 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 22:03:40.478 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-03-03 22:03:40.479 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 22:03:40.479 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 22:03:40.651 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 22:03:40.651 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 22:03:40.651 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 22:03:40.685 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 22:03:40.685 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 22:03:40.686 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-03-03 22:03:40.686 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-03-03 22:03:40.686 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-03-03 22:03:40.686 +01:00 [DBG] Start authorize callback request
2019-03-03 22:03:40.731 +01:00 [DBG] User in authorize request: c569db1d-6a57-4136-b3a2-ae35f98880b8
2019-03-03 22:03:40.731 +01:00 [DBG] Start authorize request protocol validation
2019-03-03 22:03:40.731 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 22:03:40.731 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-03-03 22:03:40.731 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "AllowedRedirectUris": [
    "http://localhost:4200/index.html",
    "http://localhost:4200/callback.html",
    "http://localhost:4200/silent.html",
    "http://localhost:4200/popup.html",
    "http://localhost:4200/home"
  ],
  "SubjectId": "c569db1d-6a57-4136-b3a2-ae35f98880b8",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile api1",
  "State": "DqECWFFktlU03Bci0faLCm2WtWY6uz4FBCQWq4PO",
  "Nonce": "DqECWFFktlU03Bci0faLCm2WtWY6uz4FBCQWq4PO",
  "SessionId": "c63870407bed7c2ea4c10662280f37ab",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "spa",
    "state": "DqECWFFktlU03Bci0faLCm2WtWY6uz4FBCQWq4PO",
    "redirect_uri": "http://localhost:4200/home",
    "scope": "openid profile api1",
    "nonce": "DqECWFFktlU03Bci0faLCm2WtWY6uz4FBCQWq4PO"
  }
}
2019-03-03 22:03:40.743 +01:00 [DBG] user_consent grant with value: spa|c569db1d-6a57-4136-b3a2-ae35f98880b8 not found in store.
2019-03-03 22:03:40.743 +01:00 [DBG] Found no prior consent from consent store, consent is required
2019-03-03 22:03:40.756 +01:00 [INF] User consented to scopes: ["openid","profile","api1"]
2019-03-03 22:03:40.772 +01:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: c569db1d-6a57-4136-b3a2-ae35f98880b8
2019-03-03 22:03:40.787 +01:00 [DBG] Creating Implicit Flow response.
2019-03-03 22:03:40.801 +01:00 [DBG] Getting claims for access token for client: spa
2019-03-03 22:03:40.802 +01:00 [DBG] Getting claims for access token for subject: c569db1d-6a57-4136-b3a2-ae35f98880b8
2019-03-03 22:03:40.858 +01:00 [DBG] Getting claims for identity token for subject: c569db1d-6a57-4136-b3a2-ae35f98880b8 and client: spa
2019-03-03 22:03:40.952 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "spa",
  "ClientName": "SPA Client",
  "RedirectUri": "http://localhost:4200/home",
  "Endpoint": "Authorize",
  "SubjectId": "c569db1d-6a57-4136-b3a2-ae35f98880b8",
  "Scopes": "openid profile api1",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****526w"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****d6df"
    }
  ],
  "ActivityId": "0HLL03EAGEVVT:00000007",
  "TimeStamp": "2019-03-03T21:03:40Z",
  "ProcessId": 5704,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-03-03 22:03:40.957 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "c569db1d-6a57-4136-b3a2-ae35f98880b8",
  "ClientId": "spa",
  "RedirectUri": "http://localhost:4200/home",
  "State": "DqECWFFktlU03Bci0faLCm2WtWY6uz4FBCQWq4PO",
  "Scope": "openid profile api1"
}
2019-03-03 22:03:40.983 +01:00 [DBG] Augmenting SignInContext
2019-03-03 22:03:40.987 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-03-03 22:03:42.131 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-03-03 22:03:42.131 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 22:03:42.131 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 22:03:42.132 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-03-03 22:03:42.132 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-03-03 22:03:42.132 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-03-03 22:03:42.132 +01:00 [DBG] Start discovery request
2019-03-03 22:03:42.217 +01:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-03-03 22:03:42.217 +01:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-03-03 22:03:42.217 +01:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-03-03 22:03:42.217 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-03-03 22:03:42.218 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-03-03 22:03:42.218 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-03-03 22:03:42.218 +01:00 [DBG] Start key discovery request
2019-03-03 22:03:43.950 +01:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-03-03 22:03:43.954 +01:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-03-03 22:03:43.955 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-03-03 22:03:43.966 +01:00 [DBG] Starting introspection request.
2019-03-03 22:03:43.980 +01:00 [DBG] Start parsing Basic Authentication secret
2019-03-03 22:03:43.984 +01:00 [DBG] Start parsing for secret in post body
2019-03-03 22:03:43.985 +01:00 [DBG] Parser found secret: PostBodySecretParser
2019-03-03 22:03:43.986 +01:00 [DBG] Secret id found: api1
2019-03-03 22:03:43.999 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-03-03 22:03:43.999 +01:00 [DBG] API resource validation success
2019-03-03 22:03:44.006 +01:00 [INF] {
  "Name": "API Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1020,
  "ApiName": "api1",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLL03EAGEVVU:00000001",
  "TimeStamp": "2019-03-03T21:03:43Z",
  "ProcessId": 5704,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-03-03 22:03:44.010 +01:00 [DBG] Introspection request validation started.
2019-03-03 22:03:44.060 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 22:03:44.066 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 22:03:44.069 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-03-03 22:03:44.075 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "4b533a702d9288c9bfd948da0b7d9c8624563af79d0f44328c3c8e3ca269d6df",
  "Claims": {
    "iss": "http://localhost:49670",
    "nbf": 1551647020,
    "exp": 1551650620,
    "aud": [
      "http://localhost:49670/resources",
      "api1"
    ],
    "client_id": "spa",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "sub": "c569db1d-6a57-4136-b3a2-ae35f98880b8",
    "auth_time": 1551646980,
    "idp": "local",
    "amr": "pwd",
    "Role": [
      "Administrator",
      "Overridden"
    ],
    "Avion": "[\"Pariz\", \"Zagreb\"]",
    "CanRead": "yes",
    "CanWrite": "yes"
  }
}
2019-03-03 22:03:44.075 +01:00 [DBG] Introspection request validation successful.
2019-03-03 22:03:44.087 +01:00 [DBG] Creating introspection response for active token.
2019-03-03 22:03:44.099 +01:00 [INF] {
  "Name": "Token Introspection Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2020,
  "ApiName": "api1",
  "IsActive": true,
  "Token": "****d6df",
  "ClaimTypes": [
    "iss",
    "nbf",
    "exp",
    "aud",
    "client_id",
    "scope",
    "sub",
    "auth_time",
    "idp",
    "amr",
    "Role",
    "Avion",
    "CanRead",
    "CanWrite"
  ],
  "TokenScopes": [
    "openid",
    "profile",
    "api1"
  ],
  "ActivityId": "0HLL03EAGEVVU:00000001",
  "TimeStamp": "2019-03-03T21:03:44Z",
  "ProcessId": 5704,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-03-03 22:03:44.100 +01:00 [INF] Success token introspection. Token active: true, for API name: api1
2019-03-03 22:05:57.415 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 22:05:57.415 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 22:06:00.189 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 22:06:00.189 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 22:06:00.235 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 22:06:04.217 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 22:06:04.217 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 22:06:05.551 +01:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-03-03 22:06:05.552 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 22:06:05.552 +01:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2019-03-03 22:06:05.592 +01:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-03-03 22:06:05.593 +01:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-03-03 22:06:05.594 +01:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2019-03-03 22:06:05.601 +01:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "c569db1d-6a57-4136-b3a2-ae35f98880b8",
  "DisplayName": "Administrator",
  "ActivityId": "0HLL03EAGEVVV:00000004",
  "TimeStamp": "2019-03-03T21:06:05Z",
  "ProcessId": 5704,
  "LocalIpAddress": "::1:49670",
  "RemoteIpAddress": "::1"
}
2019-03-03 22:06:05.798 +01:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-03-03 22:06:05.801 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-03-03 22:06:05.801 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-03-03 22:06:05.808 +01:00 [DBG] Processing signout callback request
2019-03-03 22:06:05.824 +01:00 [DBG] client configuration validation for client spa succeeded.
2019-03-03 22:06:05.824 +01:00 [DBG] No client front-channel logout URLs
2019-03-03 22:06:05.824 +01:00 [DBG] No client back-channel logout URLs
2019-03-03 22:06:05.824 +01:00 [INF] Successful signout callback.
2019-03-03 22:06:05.824 +01:00 [DBG] No client front-channel iframe urls
2019-03-03 22:06:05.824 +01:00 [DBG] No client back-channel iframe urls
2019-03-03 22:06:08.545 +01:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-03-03 22:08:56.127 +01:00 [INF] AuthenticationScheme: Google was challenged.
